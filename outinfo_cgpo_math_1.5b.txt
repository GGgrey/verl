+ export RAY_TMPDIR=/workspace/tmp/
+ RAY_TMPDIR=/workspace/tmp/
+ export WANDB_API_KEY=37f371d2968f35d69749ee52089583eb8e1f0cab
+ WANDB_API_KEY=37f371d2968f35d69749ee52089583eb8e1f0cab
+ export WANDB_DIR=/workspace/verl_exp/
+ WANDB_DIR=/workspace/verl_exp/
+ export ACCELERATE_LOG_LEVEL=info
+ ACCELERATE_LOG_LEVEL=info
+ export HYDRA_FULL_ERROR=1
+ HYDRA_FULL_ERROR=1
+ export CUDA_VISIBLE_DEVICES=2,3,4,5
+ CUDA_VISIBLE_DEVICES=2,3,4,5
+ project_name=CGPO
+ exp_name=CGPO-Qwen2.5-1.5B
+ adv_estimator=cgpo
+ use_kl_in_reward=False
+ use_kl_loss=True
+ kl_loss_coef=0.005
+ max_prompt_length=1024
+ max_response_length=4096
+ train_prompt_bsz=128
+ n_resp_per_prompt=8
+ train_prompt_mini_bsz=128
+ filter_overlong_prompts=True
+ loss_agg_mode=token-mean
+ RAY_ADDRESS=http://localhost:8265
+ WORKING_DIR=/workspace/verl
+ RUNTIME_ENV=/workspace/verl/verl/trainer/runtime_env.yaml
+ NNODES=1
+ RAY_DATA_HOME=/workspace/verl_exp
+ MODEL_PATH=/models/Qwen/Qwen2.5-1.5B
+ CKPTS_DIR=/workspace/verl_exp/ckpts/CGPO/CGPO-Qwen2.5-1.5B
+ TRAIN_FILE=/workspace/verl_exp/data/math/train.parquet
+ TEST_FILE=/workspace/verl_exp/data/math/test.parquet
+ temperature=1.0
+ top_p=1.0
+ top_k=-1
+ val_top_p=0.7
+ offload=True
+ tee cgpo_qwen2.5_1.5b.log
+ PYTHONUNBUFFERED=1
+ python3 -m verl.trainer.main_ppo data.train_files=/workspace/verl_exp/data/math/train.parquet data.val_files=/workspace/verl_exp/data/math/test.parquet data.train_batch_size=128 data.max_prompt_length=1024 data.max_response_length=4096 data.filter_overlong_prompts=True data.truncation=error algorithm.adv_estimator=cgpo algorithm.use_kl_in_reward=False actor_rollout_ref.model.path=/models/Qwen/Qwen2.5-1.5B actor_rollout_ref.actor.loss_agg_mode=token-mean actor_rollout_ref.model.use_fused_kernels=False actor_rollout_ref.actor.optim.lr=3e-6 actor_rollout_ref.actor.optim.warmup_style=cosine actor_rollout_ref.actor.optim.lr_warmup_steps_ratio=0.1 actor_rollout_ref.model.use_remove_padding=True actor_rollout_ref.actor.ppo_mini_batch_size=128 actor_rollout_ref.actor.ppo_micro_batch_size_per_gpu=4 actor_rollout_ref.actor.use_kl_loss=True actor_rollout_ref.actor.kl_loss_coef=0.005 actor_rollout_ref.actor.kl_loss_type=low_var_kl actor_rollout_ref.actor.entropy_coeff=0 actor_rollout_ref.model.enable_gradient_checkpointing=True actor_rollout_ref.actor.fsdp_config.param_offload=False actor_rollout_ref.actor.fsdp_config.optimizer_offload=False actor_rollout_ref.rollout.log_prob_micro_batch_size_per_gpu=4 actor_rollout_ref.rollout.name=vllm actor_rollout_ref.rollout.gpu_memory_utilization=0.55 actor_rollout_ref.rollout.n=8 actor_rollout_ref.rollout.calculate_confs=True actor_rollout_ref.ref.log_prob_micro_batch_size_per_gpu=4 actor_rollout_ref.ref.fsdp_config.param_offload=True trainer.critic_warmup=0 trainer.val_before_train=False trainer.n_gpus_per_node=4 trainer.nnodes=1 'trainer.logger=[console]' trainer.project_name=CGPO trainer.experiment_name=CGPO-Qwen2.5-1.5B trainer.save_freq=30 trainer.test_freq=10 trainer.default_local_dir=/workspace/verl_exp/ckpts/CGPO/CGPO-Qwen2.5-1.5B trainer.resume_mode=auto trainer.total_epochs=1
/workspace/anaconda3/envs/verl_rl/lib/python3.12/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]
ray init kwargs: {'num_cpus': None, 'runtime_env': {'env_vars': {'TOKENIZERS_PARALLELISM': 'true', 'NCCL_DEBUG': 'WARN', 'VLLM_LOGGING_LEVEL': 'WARN', 'VLLM_ALLOW_RUNTIME_LORA_UPDATING': 'true', 'VLLM_ALLREDUCE_USE_SYMM_MEM': '0', 'CUDA_DEVICE_MAX_CONNECTIONS': '1', 'NCCL_CUMEM_ENABLE': '0', 'RAY_DEBUG': '1'}, 'working_dir': None}}
2025-12-27 20:28:22,210	WARNING utils.py:458 -- Detecting docker specified CPUs. In previous versions of Ray, CPU detection in containers was incorrect. Please ensure that Ray has enough CPUs allocated. As a temporary workaround to revert to the prior behavior, set `RAY_USE_MULTIPROCESSING_CPU_COUNT=1` as an env var before starting Ray. Set the env var: `RAY_DISABLE_DOCKER_CPU_WARNING=1` to mute this warning.
2025-12-27 20:28:22,388	INFO worker.py:1998 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
/workspace/anaconda3/envs/verl_rl/lib/python3.12/site-packages/ray/_private/worker.py:2046: FutureWarning: Tip: In future versions of Ray, Ray will no longer override accelerator visible devices env var if num_gpus=0 or num_gpus=None (default). To enable this behavior and turn off this error message, set RAY_ACCEL_ENV_VAR_OVERRIDE_ON_ZERO=0
  warnings.warn(
[36m(pid=82921)[0m /workspace/anaconda3/envs/verl_rl/lib/python3.12/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
[36m(pid=82921)[0m   import pynvml  # type: ignore[import]
[36m(TaskRunner pid=82921)[0m TaskRunner hostname: 12b604b22a03, PID: 82921
[36m(TaskRunner pid=82921)[0m {'actor_rollout_ref': {'actor': {'_target_': 'verl.workers.config.FSDPActorConfig',
[36m(TaskRunner pid=82921)[0m                                  'checkpoint': {'_target_': 'verl.trainer.config.CheckpointConfig',
[36m(TaskRunner pid=82921)[0m                                                 'async_save': False,
[36m(TaskRunner pid=82921)[0m                                                 'load_contents': ['model',
[36m(TaskRunner pid=82921)[0m                                                                   'optimizer',
[36m(TaskRunner pid=82921)[0m                                                                   'extra'],
[36m(TaskRunner pid=82921)[0m                                                 'save_contents': ['model',
[36m(TaskRunner pid=82921)[0m                                                                   'optimizer',
[36m(TaskRunner pid=82921)[0m                                                                   'extra']},
[36m(TaskRunner pid=82921)[0m                                  'clip_ratio': 0.2,
[36m(TaskRunner pid=82921)[0m                                  'clip_ratio_c': 3.0,
[36m(TaskRunner pid=82921)[0m                                  'clip_ratio_high': 0.2,
[36m(TaskRunner pid=82921)[0m                                  'clip_ratio_low': 0.2,
[36m(TaskRunner pid=82921)[0m                                  'entropy_checkpointing': False,
[36m(TaskRunner pid=82921)[0m                                  'entropy_coeff': 0,
[36m(TaskRunner pid=82921)[0m                                  'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=82921)[0m                                  'freeze_vision_tower': False,
[36m(TaskRunner pid=82921)[0m                                  'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=82921)[0m                                                  'dtype': 'bfloat16',
[36m(TaskRunner pid=82921)[0m                                                  'entropy_checkpointing': False,
[36m(TaskRunner pid=82921)[0m                                                  'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=82921)[0m                                                  'forward_only': False,
[36m(TaskRunner pid=82921)[0m                                                  'forward_prefetch': False,
[36m(TaskRunner pid=82921)[0m                                                  'fsdp_size': -1,
[36m(TaskRunner pid=82921)[0m                                                  'model_dtype': 'fp32',
[36m(TaskRunner pid=82921)[0m                                                  'offload_policy': False,
[36m(TaskRunner pid=82921)[0m                                                  'optimizer_offload': False,
[36m(TaskRunner pid=82921)[0m                                                  'param_offload': False,
[36m(TaskRunner pid=82921)[0m                                                  'reshard_after_forward': True,
[36m(TaskRunner pid=82921)[0m                                                  'strategy': 'fsdp',
[36m(TaskRunner pid=82921)[0m                                                  'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=82921)[0m                                                  'use_orig_params': False,
[36m(TaskRunner pid=82921)[0m                                                  'use_torch_compile': True,
[36m(TaskRunner pid=82921)[0m                                                  'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=82921)[0m                                  'grad_clip': 1.0,
[36m(TaskRunner pid=82921)[0m                                  'kl_loss_coef': 0.005,
[36m(TaskRunner pid=82921)[0m                                  'kl_loss_type': 'low_var_kl',
[36m(TaskRunner pid=82921)[0m                                  'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=82921)[0m                                  'optim': {'_target_': 'verl.workers.config.FSDPOptimizerConfig',
[36m(TaskRunner pid=82921)[0m                                            'betas': [0.9, 0.999],
[36m(TaskRunner pid=82921)[0m                                            'clip_grad': 1.0,
[36m(TaskRunner pid=82921)[0m                                            'lr': 3e-06,
[36m(TaskRunner pid=82921)[0m                                            'lr_scheduler_type': 'constant',
[36m(TaskRunner pid=82921)[0m                                            'lr_warmup_steps': -1,
[36m(TaskRunner pid=82921)[0m                                            'lr_warmup_steps_ratio': 0.1,
[36m(TaskRunner pid=82921)[0m                                            'min_lr_ratio': 0.0,
[36m(TaskRunner pid=82921)[0m                                            'num_cycles': 0.5,
[36m(TaskRunner pid=82921)[0m                                            'optimizer': 'AdamW',
[36m(TaskRunner pid=82921)[0m                                            'optimizer_impl': 'torch.optim',
[36m(TaskRunner pid=82921)[0m                                            'override_optimizer_config': None,
[36m(TaskRunner pid=82921)[0m                                            'total_training_steps': -1,
[36m(TaskRunner pid=82921)[0m                                            'warmup_style': 'cosine',
[36m(TaskRunner pid=82921)[0m                                            'weight_decay': 0.01},
[36m(TaskRunner pid=82921)[0m                                  'policy_loss': {'_target_': 'verl.workers.config.PolicyLossConfig',
[36m(TaskRunner pid=82921)[0m                                                  'clip_cov_lb': 1.0,
[36m(TaskRunner pid=82921)[0m                                                  'clip_cov_ratio': 0.0002,
[36m(TaskRunner pid=82921)[0m                                                  'clip_cov_ub': 5.0,
[36m(TaskRunner pid=82921)[0m                                                  'kl_cov_ratio': 0.0002,
[36m(TaskRunner pid=82921)[0m                                                  'loss_mode': 'vanilla',
[36m(TaskRunner pid=82921)[0m                                                  'ppo_kl_coef': 0.1},
[36m(TaskRunner pid=82921)[0m                                  'ppo_epochs': 1,
[36m(TaskRunner pid=82921)[0m                                  'ppo_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=82921)[0m                                  'ppo_micro_batch_size': None,
[36m(TaskRunner pid=82921)[0m                                  'ppo_micro_batch_size_per_gpu': 4,
[36m(TaskRunner pid=82921)[0m                                  'ppo_mini_batch_size': 128,
[36m(TaskRunner pid=82921)[0m                                  'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=82921)[0m                                               'all_ranks': False,
[36m(TaskRunner pid=82921)[0m                                               'enable': False,
[36m(TaskRunner pid=82921)[0m                                               'ranks': [],
[36m(TaskRunner pid=82921)[0m                                               'save_path': 'outputs/profile',
[36m(TaskRunner pid=82921)[0m                                               'tool': None,
[36m(TaskRunner pid=82921)[0m                                               'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=82921)[0m                                                                       'analysis': True,
[36m(TaskRunner pid=82921)[0m                                                                       'contents': [],
[36m(TaskRunner pid=82921)[0m                                                                       'discrete': False,
[36m(TaskRunner pid=82921)[0m                                                                       'level': 'level1'},
[36m(TaskRunner pid=82921)[0m                                                               'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=82921)[0m                                                                        'discrete': False},
[36m(TaskRunner pid=82921)[0m                                                               'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=82921)[0m                                                                         'step_end': None,
[36m(TaskRunner pid=82921)[0m                                                                         'step_start': 0},
[36m(TaskRunner pid=82921)[0m                                                               'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=82921)[0m                                                                                'stack_depth': 32,
[36m(TaskRunner pid=82921)[0m                                                                                'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=82921)[0m                                  'shuffle': False,
[36m(TaskRunner pid=82921)[0m                                  'strategy': 'fsdp',
[36m(TaskRunner pid=82921)[0m                                  'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=82921)[0m                                  'use_dynamic_bsz': False,
[36m(TaskRunner pid=82921)[0m                                  'use_fused_kernels': False,
[36m(TaskRunner pid=82921)[0m                                  'use_kl_loss': True,
[36m(TaskRunner pid=82921)[0m                                  'use_remove_padding': True,
[36m(TaskRunner pid=82921)[0m                                  'use_torch_compile': True},
[36m(TaskRunner pid=82921)[0m                        'hybrid_engine': True,
[36m(TaskRunner pid=82921)[0m                        'model': {'_target_': 'verl.workers.config.HFModelConfig',
[36m(TaskRunner pid=82921)[0m                                  'custom_chat_template': None,
[36m(TaskRunner pid=82921)[0m                                  'enable_activation_offload': False,
[36m(TaskRunner pid=82921)[0m                                  'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=82921)[0m                                  'exclude_modules': None,
[36m(TaskRunner pid=82921)[0m                                  'external_lib': None,
[36m(TaskRunner pid=82921)[0m                                  'fused_kernel_options': {'impl_backend': 'torch'},
[36m(TaskRunner pid=82921)[0m                                  'hf_config_path': None,
[36m(TaskRunner pid=82921)[0m                                  'lora_adapter_path': None,
[36m(TaskRunner pid=82921)[0m                                  'lora_alpha': 16,
[36m(TaskRunner pid=82921)[0m                                  'lora_rank': 0,
[36m(TaskRunner pid=82921)[0m                                  'override_config': {},
[36m(TaskRunner pid=82921)[0m                                  'path': '/models/Qwen/Qwen2.5-1.5B',
[36m(TaskRunner pid=82921)[0m                                  'target_modules': 'all-linear',
[36m(TaskRunner pid=82921)[0m                                  'tokenizer_path': None,
[36m(TaskRunner pid=82921)[0m                                  'trust_remote_code': False,
[36m(TaskRunner pid=82921)[0m                                  'use_fused_kernels': False,
[36m(TaskRunner pid=82921)[0m                                  'use_liger': False,
[36m(TaskRunner pid=82921)[0m                                  'use_remove_padding': True,
[36m(TaskRunner pid=82921)[0m                                  'use_shm': False},
[36m(TaskRunner pid=82921)[0m                        'nccl_timeout': 600,
[36m(TaskRunner pid=82921)[0m                        'ref': {'entropy_checkpointing': False,
[36m(TaskRunner pid=82921)[0m                                'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=82921)[0m                                'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=82921)[0m                                                'dtype': 'bfloat16',
[36m(TaskRunner pid=82921)[0m                                                'entropy_checkpointing': False,
[36m(TaskRunner pid=82921)[0m                                                'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=82921)[0m                                                'forward_only': False,
[36m(TaskRunner pid=82921)[0m                                                'forward_prefetch': False,
[36m(TaskRunner pid=82921)[0m                                                'fsdp_size': -1,
[36m(TaskRunner pid=82921)[0m                                                'model_dtype': 'fp32',
[36m(TaskRunner pid=82921)[0m                                                'offload_policy': False,
[36m(TaskRunner pid=82921)[0m                                                'optimizer_offload': False,
[36m(TaskRunner pid=82921)[0m                                                'param_offload': True,
[36m(TaskRunner pid=82921)[0m                                                'reshard_after_forward': True,
[36m(TaskRunner pid=82921)[0m                                                'strategy': 'fsdp',
[36m(TaskRunner pid=82921)[0m                                                'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=82921)[0m                                                'use_orig_params': False,
[36m(TaskRunner pid=82921)[0m                                                'use_torch_compile': True,
[36m(TaskRunner pid=82921)[0m                                                'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=82921)[0m                                'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=82921)[0m                                'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=82921)[0m                                'log_prob_micro_batch_size_per_gpu': 4,
[36m(TaskRunner pid=82921)[0m                                'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=82921)[0m                                'model': None,
[36m(TaskRunner pid=82921)[0m                                'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=82921)[0m                                             'all_ranks': False,
[36m(TaskRunner pid=82921)[0m                                             'enable': False,
[36m(TaskRunner pid=82921)[0m                                             'ranks': [],
[36m(TaskRunner pid=82921)[0m                                             'save_path': 'outputs/profile',
[36m(TaskRunner pid=82921)[0m                                             'tool': None,
[36m(TaskRunner pid=82921)[0m                                             'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=82921)[0m                                                                     'analysis': True,
[36m(TaskRunner pid=82921)[0m                                                                     'contents': [],
[36m(TaskRunner pid=82921)[0m                                                                     'discrete': False,
[36m(TaskRunner pid=82921)[0m                                                                     'level': 'level1'},
[36m(TaskRunner pid=82921)[0m                                                             'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=82921)[0m                                                                      'discrete': False},
[36m(TaskRunner pid=82921)[0m                                                             'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=82921)[0m                                                                       'step_end': None,
[36m(TaskRunner pid=82921)[0m                                                                       'step_start': 0},
[36m(TaskRunner pid=82921)[0m                                                             'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=82921)[0m                                                                              'stack_depth': 32,
[36m(TaskRunner pid=82921)[0m                                                                              'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=82921)[0m                                'strategy': 'fsdp',
[36m(TaskRunner pid=82921)[0m                                'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=82921)[0m                                'use_torch_compile': True},
[36m(TaskRunner pid=82921)[0m                        'rollout': {'_target_': 'verl.workers.config.RolloutConfig',
[36m(TaskRunner pid=82921)[0m                                    'agent': {'_target_': 'verl.workers.config.AgentLoopConfig',
[36m(TaskRunner pid=82921)[0m                                              'agent_loop_config_path': None,
[36m(TaskRunner pid=82921)[0m                                              'custom_async_server': {'_target_': 'verl.workers.config.CustomAsyncServerConfig',
[36m(TaskRunner pid=82921)[0m                                                                      'name': None,
[36m(TaskRunner pid=82921)[0m                                                                      'path': None},
[36m(TaskRunner pid=82921)[0m                                              'default_agent_loop': 'single_turn_agent',
[36m(TaskRunner pid=82921)[0m                                              'num_workers': 8},
[36m(TaskRunner pid=82921)[0m                                    'calculate_confs': True,
[36m(TaskRunner pid=82921)[0m                                    'calculate_log_probs': False,
[36m(TaskRunner pid=82921)[0m                                    'cudagraph_capture_sizes': None,
[36m(TaskRunner pid=82921)[0m                                    'data_parallel_size': 1,
[36m(TaskRunner pid=82921)[0m                                    'disable_log_stats': True,
[36m(TaskRunner pid=82921)[0m                                    'do_sample': True,
[36m(TaskRunner pid=82921)[0m                                    'dtype': 'bfloat16',
[36m(TaskRunner pid=82921)[0m                                    'enable_chunked_prefill': True,
[36m(TaskRunner pid=82921)[0m                                    'enable_prefix_caching': True,
[36m(TaskRunner pid=82921)[0m                                    'enforce_eager': False,
[36m(TaskRunner pid=82921)[0m                                    'engine_kwargs': {'sglang': {}, 'vllm': {}},
[36m(TaskRunner pid=82921)[0m                                    'expert_parallel_size': 1,
[36m(TaskRunner pid=82921)[0m                                    'free_cache_engine': True,
[36m(TaskRunner pid=82921)[0m                                    'gpu_memory_utilization': 0.55,
[36m(TaskRunner pid=82921)[0m                                    'ignore_eos': False,
[36m(TaskRunner pid=82921)[0m                                    'layered_summon': False,
[36m(TaskRunner pid=82921)[0m                                    'load_format': 'dummy',
[36m(TaskRunner pid=82921)[0m                                    'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=82921)[0m                                    'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=82921)[0m                                    'log_prob_micro_batch_size_per_gpu': 4,
[36m(TaskRunner pid=82921)[0m                                    'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=82921)[0m                                    'max_model_len': None,
[36m(TaskRunner pid=82921)[0m                                    'max_num_batched_tokens': 8192,
[36m(TaskRunner pid=82921)[0m                                    'max_num_seqs': 1024,
[36m(TaskRunner pid=82921)[0m                                    'mode': 'sync',
[36m(TaskRunner pid=82921)[0m                                    'multi_stage_wake_up': False,
[36m(TaskRunner pid=82921)[0m                                    'multi_turn': {'_target_': 'verl.workers.config.MultiTurnConfig',
[36m(TaskRunner pid=82921)[0m                                                   'enable': False,
[36m(TaskRunner pid=82921)[0m                                                   'format': 'hermes',
[36m(TaskRunner pid=82921)[0m                                                   'interaction_config_path': None,
[36m(TaskRunner pid=82921)[0m                                                   'max_assistant_turns': None,
[36m(TaskRunner pid=82921)[0m                                                   'max_parallel_calls': 1,
[36m(TaskRunner pid=82921)[0m                                                   'max_tool_response_length': 256,
[36m(TaskRunner pid=82921)[0m                                                   'max_user_turns': None,
[36m(TaskRunner pid=82921)[0m                                                   'num_repeat_rollouts': None,
[36m(TaskRunner pid=82921)[0m                                                   'tokenization_sanity_check_mode': 'strict',
[36m(TaskRunner pid=82921)[0m                                                   'tool_config_path': None,
[36m(TaskRunner pid=82921)[0m                                                   'tool_response_truncate_side': 'middle',
[36m(TaskRunner pid=82921)[0m                                                   'use_inference_chat_template': False},
[36m(TaskRunner pid=82921)[0m                                    'n': 8,
[36m(TaskRunner pid=82921)[0m                                    'name': 'vllm',
[36m(TaskRunner pid=82921)[0m                                    'over_sample_rate': 0,
[36m(TaskRunner pid=82921)[0m                                    'pipeline_model_parallel_size': 1,
[36m(TaskRunner pid=82921)[0m                                    'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=82921)[0m                                                 'all_ranks': False,
[36m(TaskRunner pid=82921)[0m                                                 'enable': False,
[36m(TaskRunner pid=82921)[0m                                                 'ranks': [],
[36m(TaskRunner pid=82921)[0m                                                 'save_path': 'outputs/profile',
[36m(TaskRunner pid=82921)[0m                                                 'tool': None,
[36m(TaskRunner pid=82921)[0m                                                 'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=82921)[0m                                                                         'analysis': True,
[36m(TaskRunner pid=82921)[0m                                                                         'contents': [],
[36m(TaskRunner pid=82921)[0m                                                                         'discrete': False,
[36m(TaskRunner pid=82921)[0m                                                                         'level': 'level1'},
[36m(TaskRunner pid=82921)[0m                                                                 'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=82921)[0m                                                                          'discrete': False},
[36m(TaskRunner pid=82921)[0m                                                                 'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=82921)[0m                                                                           'step_end': None,
[36m(TaskRunner pid=82921)[0m                                                                           'step_start': 0},
[36m(TaskRunner pid=82921)[0m                                                                 'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=82921)[0m                                                                                  'stack_depth': 32,
[36m(TaskRunner pid=82921)[0m                                                                                  'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=82921)[0m                                    'prometheus': {'_target_': 'verl.workers.config.PrometheusConfig',
[36m(TaskRunner pid=82921)[0m                                                   'enable': False,
[36m(TaskRunner pid=82921)[0m                                                   'file': '/tmp/ray/session_latest/metrics/prometheus/prometheus.yml',
[36m(TaskRunner pid=82921)[0m                                                   'port': 9090,
[36m(TaskRunner pid=82921)[0m                                                   'served_model_name': '/models/Qwen/Qwen2.5-1.5B'},
[36m(TaskRunner pid=82921)[0m                                    'prompt_length': 1024,
[36m(TaskRunner pid=82921)[0m                                    'response_length': 4096,
[36m(TaskRunner pid=82921)[0m                                    'skip_dump_dir': '/tmp/rollout_dump',
[36m(TaskRunner pid=82921)[0m                                    'skip_rollout': False,
[36m(TaskRunner pid=82921)[0m                                    'skip_tokenizer_init': True,
[36m(TaskRunner pid=82921)[0m                                    'temperature': 1.0,
[36m(TaskRunner pid=82921)[0m                                    'tensor_model_parallel_size': 2,
[36m(TaskRunner pid=82921)[0m                                    'top_k': -1,
[36m(TaskRunner pid=82921)[0m                                    'top_p': 1,
[36m(TaskRunner pid=82921)[0m                                    'trace': {'_target_': 'verl.workers.config.TraceConfig',
[36m(TaskRunner pid=82921)[0m                                              'backend': None,
[36m(TaskRunner pid=82921)[0m                                              'token2text': False},
[36m(TaskRunner pid=82921)[0m                                    'update_weights_bucket_megabytes': 512,
[36m(TaskRunner pid=82921)[0m                                    'val_kwargs': {'_target_': 'verl.workers.config.SamplingConfig',
[36m(TaskRunner pid=82921)[0m                                                   'do_sample': False,
[36m(TaskRunner pid=82921)[0m                                                   'n': 1,
[36m(TaskRunner pid=82921)[0m                                                   'temperature': 0,
[36m(TaskRunner pid=82921)[0m                                                   'top_k': -1,
[36m(TaskRunner pid=82921)[0m                                                   'top_p': 1.0}}},
[36m(TaskRunner pid=82921)[0m  'algorithm': {'_target_': 'verl.trainer.config.AlgoConfig',
[36m(TaskRunner pid=82921)[0m                'adv_estimator': 'cgpo',
[36m(TaskRunner pid=82921)[0m                'gamma': 1.0,
[36m(TaskRunner pid=82921)[0m                'kl_ctrl': {'_target_': 'verl.trainer.config.KLControlConfig',
[36m(TaskRunner pid=82921)[0m                            'horizon': 10000,
[36m(TaskRunner pid=82921)[0m                            'kl_coef': 0.001,
[36m(TaskRunner pid=82921)[0m                            'target_kl': 0.1,
[36m(TaskRunner pid=82921)[0m                            'type': 'fixed'},
[36m(TaskRunner pid=82921)[0m                'kl_penalty': 'kl',
[36m(TaskRunner pid=82921)[0m                'lam': 1.0,
[36m(TaskRunner pid=82921)[0m                'metric_weights': {'mean_logprob': 1.0,
[36m(TaskRunner pid=82921)[0m                                   'min_logprob': 1.0,
[36m(TaskRunner pid=82921)[0m                                   'tail_mean_logprob': 2.0},
[36m(TaskRunner pid=82921)[0m                'norm_adv_by_std_in_grpo': True,
[36m(TaskRunner pid=82921)[0m                'pf_ppo': {'reweight_method': 'pow', 'weight_pow': 2.0},
[36m(TaskRunner pid=82921)[0m                'rollout_correction': {'bypass_mode': False,
[36m(TaskRunner pid=82921)[0m                                       'rollout_is': None,
[36m(TaskRunner pid=82921)[0m                                       'rollout_is_batch_normalize': False,
[36m(TaskRunner pid=82921)[0m                                       'rollout_is_threshold': 2.0,
[36m(TaskRunner pid=82921)[0m                                       'rollout_rs': None,
[36m(TaskRunner pid=82921)[0m                                       'rollout_rs_threshold': None,
[36m(TaskRunner pid=82921)[0m                                       'rollout_rs_threshold_lower': None,
[36m(TaskRunner pid=82921)[0m                                       'rollout_token_veto_threshold': None,
[36m(TaskRunner pid=82921)[0m                                       'use_policy_gradient': False},
[36m(TaskRunner pid=82921)[0m                'rrf_k': 1.0,
[36m(TaskRunner pid=82921)[0m                'tail_frac': 0.1,
[36m(TaskRunner pid=82921)[0m                'use_kl_in_reward': False,
[36m(TaskRunner pid=82921)[0m                'use_pf_ppo': False},
[36m(TaskRunner pid=82921)[0m  'critic': {'_target_': 'verl.workers.config.FSDPCriticConfig',
[36m(TaskRunner pid=82921)[0m             'checkpoint': {'_target_': 'verl.trainer.config.CheckpointConfig',
[36m(TaskRunner pid=82921)[0m                            'async_save': False,
[36m(TaskRunner pid=82921)[0m                            'load_contents': ['model', 'optimizer', 'extra'],
[36m(TaskRunner pid=82921)[0m                            'save_contents': ['model', 'optimizer', 'extra']},
[36m(TaskRunner pid=82921)[0m             'cliprange_value': 0.5,
[36m(TaskRunner pid=82921)[0m             'enable': None,
[36m(TaskRunner pid=82921)[0m             'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=82921)[0m             'forward_micro_batch_size': None,
[36m(TaskRunner pid=82921)[0m             'forward_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=82921)[0m             'grad_clip': 1.0,
[36m(TaskRunner pid=82921)[0m             'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=82921)[0m             'model': {'_target_': 'verl.workers.config.FSDPCriticModelCfg',
[36m(TaskRunner pid=82921)[0m                       'enable_activation_offload': False,
[36m(TaskRunner pid=82921)[0m                       'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=82921)[0m                       'external_lib': None,
[36m(TaskRunner pid=82921)[0m                       'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=82921)[0m                                       'dtype': 'bfloat16',
[36m(TaskRunner pid=82921)[0m                                       'entropy_checkpointing': False,
[36m(TaskRunner pid=82921)[0m                                       'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=82921)[0m                                       'forward_only': False,
[36m(TaskRunner pid=82921)[0m                                       'forward_prefetch': False,
[36m(TaskRunner pid=82921)[0m                                       'fsdp_size': -1,
[36m(TaskRunner pid=82921)[0m                                       'model_dtype': 'fp32',
[36m(TaskRunner pid=82921)[0m                                       'offload_policy': False,
[36m(TaskRunner pid=82921)[0m                                       'optimizer_offload': False,
[36m(TaskRunner pid=82921)[0m                                       'param_offload': False,
[36m(TaskRunner pid=82921)[0m                                       'reshard_after_forward': True,
[36m(TaskRunner pid=82921)[0m                                       'strategy': 'fsdp',
[36m(TaskRunner pid=82921)[0m                                       'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=82921)[0m                                       'use_orig_params': False,
[36m(TaskRunner pid=82921)[0m                                       'use_torch_compile': True,
[36m(TaskRunner pid=82921)[0m                                       'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=82921)[0m                       'lora_alpha': 16,
[36m(TaskRunner pid=82921)[0m                       'lora_rank': 0,
[36m(TaskRunner pid=82921)[0m                       'override_config': {},
[36m(TaskRunner pid=82921)[0m                       'path': '~/models/deepseek-llm-7b-chat',
[36m(TaskRunner pid=82921)[0m                       'target_modules': 'all-linear',
[36m(TaskRunner pid=82921)[0m                       'tokenizer_path': '/models/Qwen/Qwen2.5-1.5B',
[36m(TaskRunner pid=82921)[0m                       'trust_remote_code': False,
[36m(TaskRunner pid=82921)[0m                       'use_remove_padding': False,
[36m(TaskRunner pid=82921)[0m                       'use_shm': False},
[36m(TaskRunner pid=82921)[0m             'optim': {'_target_': 'verl.workers.config.FSDPOptimizerConfig',
[36m(TaskRunner pid=82921)[0m                       'betas': [0.9, 0.999],
[36m(TaskRunner pid=82921)[0m                       'clip_grad': 1.0,
[36m(TaskRunner pid=82921)[0m                       'lr': 1e-05,
[36m(TaskRunner pid=82921)[0m                       'lr_scheduler_type': 'constant',
[36m(TaskRunner pid=82921)[0m                       'lr_warmup_steps': -1,
[36m(TaskRunner pid=82921)[0m                       'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=82921)[0m                       'min_lr_ratio': 0.0,
[36m(TaskRunner pid=82921)[0m                       'num_cycles': 0.5,
[36m(TaskRunner pid=82921)[0m                       'optimizer': 'AdamW',
[36m(TaskRunner pid=82921)[0m                       'optimizer_impl': 'torch.optim',
[36m(TaskRunner pid=82921)[0m                       'override_optimizer_config': None,
[36m(TaskRunner pid=82921)[0m                       'total_training_steps': -1,
[36m(TaskRunner pid=82921)[0m                       'warmup_style': None,
[36m(TaskRunner pid=82921)[0m                       'weight_decay': 0.01},
[36m(TaskRunner pid=82921)[0m             'ppo_epochs': 1,
[36m(TaskRunner pid=82921)[0m             'ppo_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=82921)[0m             'ppo_micro_batch_size': None,
[36m(TaskRunner pid=82921)[0m             'ppo_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=82921)[0m             'ppo_mini_batch_size': 128,
[36m(TaskRunner pid=82921)[0m             'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=82921)[0m                          'all_ranks': False,
[36m(TaskRunner pid=82921)[0m                          'enable': False,
[36m(TaskRunner pid=82921)[0m                          'ranks': [],
[36m(TaskRunner pid=82921)[0m                          'save_path': 'outputs/profile',
[36m(TaskRunner pid=82921)[0m                          'tool': None,
[36m(TaskRunner pid=82921)[0m                          'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=82921)[0m                                                  'analysis': True,
[36m(TaskRunner pid=82921)[0m                                                  'contents': [],
[36m(TaskRunner pid=82921)[0m                                                  'discrete': False,
[36m(TaskRunner pid=82921)[0m                                                  'level': 'level1'},
[36m(TaskRunner pid=82921)[0m                                          'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=82921)[0m                                                   'discrete': False},
[36m(TaskRunner pid=82921)[0m                                          'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=82921)[0m                                                    'step_end': None,
[36m(TaskRunner pid=82921)[0m                                                    'step_start': 0},
[36m(TaskRunner pid=82921)[0m                                          'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=82921)[0m                                                           'stack_depth': 32,
[36m(TaskRunner pid=82921)[0m                                                           'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=82921)[0m             'rollout_n': 8,
[36m(TaskRunner pid=82921)[0m             'shuffle': False,
[36m(TaskRunner pid=82921)[0m             'strategy': 'fsdp',
[36m(TaskRunner pid=82921)[0m             'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=82921)[0m             'use_dynamic_bsz': False},
[36m(TaskRunner pid=82921)[0m  'custom_reward_function': {'name': 'compute_score', 'path': None},
[36m(TaskRunner pid=82921)[0m  'data': {'apply_chat_template_kwargs': {},
[36m(TaskRunner pid=82921)[0m           'custom_cls': {'name': None, 'path': None},
[36m(TaskRunner pid=82921)[0m           'datagen': {'name': None, 'path': None},
[36m(TaskRunner pid=82921)[0m           'dataloader_num_workers': 8,
[36m(TaskRunner pid=82921)[0m           'filter_overlong_prompts': True,
[36m(TaskRunner pid=82921)[0m           'filter_overlong_prompts_workers': 1,
[36m(TaskRunner pid=82921)[0m           'image_key': 'images',
[36m(TaskRunner pid=82921)[0m           'image_patch_size': 14,
[36m(TaskRunner pid=82921)[0m           'max_prompt_length': 1024,
[36m(TaskRunner pid=82921)[0m           'max_response_length': 4096,
[36m(TaskRunner pid=82921)[0m           'prompt_key': 'prompt',
[36m(TaskRunner pid=82921)[0m           'return_full_prompt': False,
[36m(TaskRunner pid=82921)[0m           'return_multi_modal_inputs': True,
[36m(TaskRunner pid=82921)[0m           'return_raw_chat': False,
[36m(TaskRunner pid=82921)[0m           'return_raw_input_ids': False,
[36m(TaskRunner pid=82921)[0m           'reward_fn_key': 'data_source',
[36m(TaskRunner pid=82921)[0m           'sampler': {'class_name': None, 'class_path': None},
[36m(TaskRunner pid=82921)[0m           'seed': None,
[36m(TaskRunner pid=82921)[0m           'shuffle': True,
[36m(TaskRunner pid=82921)[0m           'tokenizer': None,
[36m(TaskRunner pid=82921)[0m           'tool_config_path': None,
[36m(TaskRunner pid=82921)[0m           'train_batch_size': 128,
[36m(TaskRunner pid=82921)[0m           'train_files': '/workspace/verl_exp/data/math/train.parquet',
[36m(TaskRunner pid=82921)[0m           'train_max_samples': -1,
[36m(TaskRunner pid=82921)[0m           'truncation': 'error',
[36m(TaskRunner pid=82921)[0m           'trust_remote_code': False,
[36m(TaskRunner pid=82921)[0m           'use_shm': False,
[36m(TaskRunner pid=82921)[0m           'val_batch_size': None,
[36m(TaskRunner pid=82921)[0m           'val_files': '/workspace/verl_exp/data/math/test.parquet',
[36m(TaskRunner pid=82921)[0m           'val_max_samples': -1,
[36m(TaskRunner pid=82921)[0m           'validation_shuffle': False,
[36m(TaskRunner pid=82921)[0m           'video_key': 'videos'},
[36m(TaskRunner pid=82921)[0m  'global_profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=82921)[0m                      'global_tool_config': {'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=82921)[0m                                                      'controller_nsight_options': {'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=82921)[0m                                                                                    'cuda-memory-usage': 'true',
[36m(TaskRunner pid=82921)[0m                                                                                    'trace': 'cuda,nvtx,cublas,ucx'},
[36m(TaskRunner pid=82921)[0m                                                      'discrete': False,
[36m(TaskRunner pid=82921)[0m                                                      'worker_nsight_options': {'capture-range': 'cudaProfilerApi',
[36m(TaskRunner pid=82921)[0m                                                                                'capture-range-end': None,
[36m(TaskRunner pid=82921)[0m                                                                                'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=82921)[0m                                                                                'cuda-memory-usage': 'true',
[36m(TaskRunner pid=82921)[0m                                                                                'kill': 'none',
[36m(TaskRunner pid=82921)[0m                                                                                'trace': 'cuda,nvtx,cublas,ucx'}},
[36m(TaskRunner pid=82921)[0m                                             'torch_memory': {'context': 'all',
[36m(TaskRunner pid=82921)[0m                                                              'kw_args': {},
[36m(TaskRunner pid=82921)[0m                                                              'stack_depth': 32,
[36m(TaskRunner pid=82921)[0m                                                              'stacks': 'all',
[36m(TaskRunner pid=82921)[0m                                                              'trace_alloc_max_entries': 100000}},
[36m(TaskRunner pid=82921)[0m                      'profile_continuous_steps': False,
[36m(TaskRunner pid=82921)[0m                      'save_path': 'outputs/profile',
[36m(TaskRunner pid=82921)[0m                      'steps': None,
[36m(TaskRunner pid=82921)[0m                      'tool': None},
[36m(TaskRunner pid=82921)[0m  'ray_kwargs': {'ray_init': {'num_cpus': None}, 'timeline_json_file': None},
[36m(TaskRunner pid=82921)[0m  'reward_model': {'enable': False,
[36m(TaskRunner pid=82921)[0m                   'enable_resource_pool': False,
[36m(TaskRunner pid=82921)[0m                   'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=82921)[0m                   'launch_reward_fn_async': False,
[36m(TaskRunner pid=82921)[0m                   'max_length': None,
[36m(TaskRunner pid=82921)[0m                   'micro_batch_size': None,
[36m(TaskRunner pid=82921)[0m                   'micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=82921)[0m                   'model': {'external_lib': None,
[36m(TaskRunner pid=82921)[0m                             'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=82921)[0m                                             'forward_prefetch': False,
[36m(TaskRunner pid=82921)[0m                                             'fsdp_size': -1,
[36m(TaskRunner pid=82921)[0m                                             'param_offload': False,
[36m(TaskRunner pid=82921)[0m                                             'reshard_after_forward': True,
[36m(TaskRunner pid=82921)[0m                                             'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=82921)[0m                             'input_tokenizer': '/models/Qwen/Qwen2.5-1.5B',
[36m(TaskRunner pid=82921)[0m                             'path': '~/models/FsfairX-LLaMA3-RM-v0.1',
[36m(TaskRunner pid=82921)[0m                             'trust_remote_code': False,
[36m(TaskRunner pid=82921)[0m                             'use_fused_kernels': False,
[36m(TaskRunner pid=82921)[0m                             'use_remove_padding': False,
[36m(TaskRunner pid=82921)[0m                             'use_shm': False},
[36m(TaskRunner pid=82921)[0m                   'n_gpus_per_node': 0,
[36m(TaskRunner pid=82921)[0m                   'nnodes': 0,
[36m(TaskRunner pid=82921)[0m                   'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=82921)[0m                                'all_ranks': False,
[36m(TaskRunner pid=82921)[0m                                'enable': False,
[36m(TaskRunner pid=82921)[0m                                'ranks': [],
[36m(TaskRunner pid=82921)[0m                                'save_path': 'outputs/profile',
[36m(TaskRunner pid=82921)[0m                                'tool': None,
[36m(TaskRunner pid=82921)[0m                                'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=82921)[0m                                                        'analysis': True,
[36m(TaskRunner pid=82921)[0m                                                        'contents': [],
[36m(TaskRunner pid=82921)[0m                                                        'discrete': False,
[36m(TaskRunner pid=82921)[0m                                                        'level': 'level1'},
[36m(TaskRunner pid=82921)[0m                                                'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=82921)[0m                                                         'discrete': False},
[36m(TaskRunner pid=82921)[0m                                                'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=82921)[0m                                                          'step_end': None,
[36m(TaskRunner pid=82921)[0m                                                          'step_start': 0},
[36m(TaskRunner pid=82921)[0m                                                'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=82921)[0m                                                                 'stack_depth': 32,
[36m(TaskRunner pid=82921)[0m                                                                 'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=82921)[0m                   'reward_manager': 'naive',
[36m(TaskRunner pid=82921)[0m                   'sandbox_fusion': {'max_concurrent': 64,
[36m(TaskRunner pid=82921)[0m                                      'memory_limit_mb': 1024,
[36m(TaskRunner pid=82921)[0m                                      'url': None},
[36m(TaskRunner pid=82921)[0m                   'strategy': 'fsdp',
[36m(TaskRunner pid=82921)[0m                   'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=82921)[0m                   'use_dynamic_bsz': False},
[36m(TaskRunner pid=82921)[0m  'trainer': {'balance_batch': True,
[36m(TaskRunner pid=82921)[0m              'critic_warmup': 0,
[36m(TaskRunner pid=82921)[0m              'default_hdfs_dir': None,
[36m(TaskRunner pid=82921)[0m              'default_local_dir': '/workspace/verl_exp/ckpts/CGPO/CGPO-Qwen2.5-1.5B',
[36m(TaskRunner pid=82921)[0m              'del_local_ckpt_after_load': False,
[36m(TaskRunner pid=82921)[0m              'device': 'cuda',
[36m(TaskRunner pid=82921)[0m              'esi_redundant_time': 0,
[36m(TaskRunner pid=82921)[0m              'experiment_name': 'CGPO-Qwen2.5-1.5B',
[36m(TaskRunner pid=82921)[0m              'log_val_generations': 0,
[36m(TaskRunner pid=82921)[0m              'logger': ['console'],
[36m(TaskRunner pid=82921)[0m              'max_actor_ckpt_to_keep': None,
[36m(TaskRunner pid=82921)[0m              'max_critic_ckpt_to_keep': None,
[36m(TaskRunner pid=82921)[0m              'n_gpus_per_node': 4,
[36m(TaskRunner pid=82921)[0m              'nnodes': 1,
[36m(TaskRunner pid=82921)[0m              'project_name': 'CGPO',
[36m(TaskRunner pid=82921)[0m              'ray_wait_register_center_timeout': 300,
[36m(TaskRunner pid=82921)[0m              'resume_from_path': None,
[36m(TaskRunner pid=82921)[0m              'resume_mode': 'auto',
[36m(TaskRunner pid=82921)[0m              'rollout_data_dir': None,
[36m(TaskRunner pid=82921)[0m              'save_freq': 30,
[36m(TaskRunner pid=82921)[0m              'test_freq': 10,
[36m(TaskRunner pid=82921)[0m              'total_epochs': 1,
[36m(TaskRunner pid=82921)[0m              'total_training_steps': None,
[36m(TaskRunner pid=82921)[0m              'use_legacy_worker_impl': 'auto',
[36m(TaskRunner pid=82921)[0m              'val_before_train': False,
[36m(TaskRunner pid=82921)[0m              'val_only': False,
[36m(TaskRunner pid=82921)[0m              'validation_data_dir': None},
[36m(TaskRunner pid=82921)[0m  'transfer_queue': {'enable': False}}
[36m(TaskRunner pid=82921)[0m /workspace/verl/verl/trainer/main_ppo.py:274: UserWarning: Disabled critic as algorithm.adv_estimator != gae. If it is not intended, please set critic.enable=True
[36m(TaskRunner pid=82921)[0m   use_critic=need_critic(config),
[36m(TaskRunner pid=82921)[0m [validate_config] All configuration checks passed successfully!
[36m(TaskRunner pid=82921)[0m /workspace/verl/verl/utils/profiler/config.py:49: UserWarning: Torch profiler tool config is not fully supported now.
[36m(TaskRunner pid=82921)[0m   warnings.warn("Torch profiler tool config is not fully supported now.", stacklevel=1)
[36m(TaskRunner pid=82921)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=82921)[0m dataset len: 7500
[36m(TaskRunner pid=82921)[0m Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=82921)[0m WARNING:2025-12-27 20:28:58,982:Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=82921)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1):   0%|          | 0/7500 [00:00<?, ? examples/s]
[36m(TaskRunner pid=82921)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1):  13%|█▎        | 1000/7500 [00:00<00:05, 1178.23 examples/s]
[36m(TaskRunner pid=82921)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1):  27%|██▋       | 2000/7500 [00:01<00:03, 1788.93 examples/s]
[36m(TaskRunner pid=82921)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1):  40%|████      | 3000/7500 [00:01<00:02, 2032.37 examples/s]
[36m(TaskRunner pid=82921)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1):  53%|█████▎    | 4000/7500 [00:01<00:01, 2235.12 examples/s]
[36m(TaskRunner pid=82921)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1):  67%|██████▋   | 5000/7500 [00:02<00:01, 2359.45 examples/s]
[36m(TaskRunner pid=82921)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1):  80%|████████  | 6000/7500 [00:02<00:00, 2455.08 examples/s]
[36m(TaskRunner pid=82921)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1):  93%|█████████▎| 7000/7500 [00:03<00:00, 2507.72 examples/s]
[36m(TaskRunner pid=82921)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1): 100%|██████████| 7500/7500 [00:03<00:00, 2501.81 examples/s]
[36m(TaskRunner pid=82921)[0m filter dataset len: 7492
[36m(TaskRunner pid=82921)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=82921)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1): 100%|██████████| 7500/7500 [00:03<00:00, 2177.93 examples/s]
[36m(TaskRunner pid=82921)[0m dataset len: 5000
[36m(TaskRunner pid=82921)[0m Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=82921)[0m WARNING:2025-12-27 20:29:31,783:Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=82921)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1):   0%|          | 0/5000 [00:00<?, ? examples/s]
[36m(TaskRunner pid=82921)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1):  20%|██        | 1000/5000 [00:00<00:03, 1044.99 examples/s]
[36m(TaskRunner pid=82921)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1):  40%|████      | 2000/5000 [00:01<00:01, 1784.04 examples/s]
[36m(TaskRunner pid=82921)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1):  60%|██████    | 3000/5000 [00:01<00:00, 2342.37 examples/s]
[36m(TaskRunner pid=82921)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1):  80%|████████  | 4000/5000 [00:01<00:00, 2743.49 examples/s]
[36m(TaskRunner pid=82921)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1): 100%|██████████| 5000/5000 [00:02<00:00, 3026.20 examples/s]
[36m(TaskRunner pid=82921)[0m filter dataset len: 4998
[36m(TaskRunner pid=82921)[0m Size of train dataloader: 58, Size of val dataloader: 1
[36m(TaskRunner pid=82921)[0m Total training steps: 58
[36m(TaskRunner pid=82921)[0m colocated worker base class <class 'verl.single_controller.base.worker.Worker'>
[36m(TaskRunner pid=82921)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1): 100%|██████████| 5000/5000 [00:02<00:00, 2320.70 examples/s]
[36m(TaskRunner pid=82921)[0m /workspace/verl/verl/trainer/ppo/ray_trainer.py:357: UserWarning: Disabled critic as algorithm.adv_estimator != gae. If it is not intended, please set critic.enable=True
[36m(TaskRunner pid=82921)[0m   self.use_critic = need_critic(self.config)
[36m(pid=84124)[0m /workspace/anaconda3/envs/verl_rl/lib/python3.12/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
[36m(pid=84124)[0m   import pynvml  # type: ignore[import]
[36m(WorkerDict pid=84124)[0m [Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[36m(WorkerDict pid=84123)[0m reference model: /models/Qwen/Qwen2.5-1.5B
[36m(WorkerDict pid=84124)[0m `torch_dtype` is deprecated! Use `dtype` instead!
[36m(pid=84126)[0m /workspace/anaconda3/envs/verl_rl/lib/python3.12/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.[32m [repeated 3x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(pid=84126)[0m   import pynvml  # type: ignore[import][32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=84126)[0m Flash Attention 2 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", dtype=torch.float16)`
[36m(WorkerDict pid=84126)[0m Flash Attention 2 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2Model is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", dtype=torch.float16)`
[36m(WorkerDict pid=84123)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=84123)[0m   "architectures": [
[36m(WorkerDict pid=84123)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=84123)[0m   ],
[36m(WorkerDict pid=84123)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=84123)[0m   "dtype": "bfloat16",
[36m(WorkerDict pid=84123)[0m   "eos_token_id": 151643,
[36m(WorkerDict pid=84123)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=84123)[0m   "hidden_size": 1536,
[36m(WorkerDict pid=84123)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=84123)[0m   "intermediate_size": 8960,
[36m(WorkerDict pid=84123)[0m   "layer_types": [
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention"
[36m(WorkerDict pid=84123)[0m   ],
[36m(WorkerDict pid=84123)[0m   "max_position_embeddings": 131072,
[36m(WorkerDict pid=84123)[0m   "max_window_layers": 28,
[36m(WorkerDict pid=84123)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=84123)[0m   "num_attention_heads": 12,
[36m(WorkerDict pid=84123)[0m   "num_hidden_layers": 28,
[36m(WorkerDict pid=84123)[0m   "num_key_value_heads": 2,
[36m(WorkerDict pid=84123)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=84123)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=84123)[0m   "rope_scaling": null,
[36m(WorkerDict pid=84123)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=84123)[0m   "sliding_window": null,
[36m(WorkerDict pid=84123)[0m   "tie_word_embeddings": true,
[36m(WorkerDict pid=84123)[0m   "transformers_version": "4.56.1",
[36m(WorkerDict pid=84123)[0m   "use_cache": true,
[36m(WorkerDict pid=84123)[0m   "use_mrope": false,
[36m(WorkerDict pid=84123)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=84123)[0m   "vocab_size": 151936
[36m(WorkerDict pid=84123)[0m }
[36m(WorkerDict pid=84123)[0m 
[36m(WorkerDict pid=84124)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention
[36m(WorkerDict pid=84124)[0m Skipping monkey patch for Qwen2ForCausalLM as use_fused_kernels is False or fused_kernels_backend is torch
[36m(WorkerDict pid=84123)[0m Qwen2ForCausalLM contains 1.54B parameters
[36m(WorkerDict pid=84123)[0m wrap_policy: functools.partial(<function _or_policy at 0x7ce34307a8e0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7ce34307a7a0>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=84125)[0m [Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=84123)[0m NCCL version 2.27.3+cuda12.9
[36m(WorkerDict pid=84123)[0m Ref use_remove_padding=True
[36m(WorkerDict pid=84123)[0m Ref use_fused_kernels=False
[36m(WorkerDict pid=84123)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=84123)[0m   "architectures": [
[36m(WorkerDict pid=84123)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=84123)[0m   ],
[36m(WorkerDict pid=84123)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=84123)[0m   "dtype": "bfloat16",
[36m(WorkerDict pid=84123)[0m   "eos_token_id": 151643,
[36m(WorkerDict pid=84123)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=84123)[0m   "hidden_size": 1536,
[36m(WorkerDict pid=84123)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=84123)[0m   "intermediate_size": 8960,
[36m(WorkerDict pid=84123)[0m   "layer_types": [
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention",
[36m(WorkerDict pid=84123)[0m     "full_attention"
[36m(WorkerDict pid=84123)[0m   ],
[36m(WorkerDict pid=84123)[0m   "max_position_embeddings": 131072,
[36m(WorkerDict pid=84123)[0m   "max_window_layers": 28,
[36m(WorkerDict pid=84123)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=84123)[0m   "num_attention_heads": 12,
[36m(WorkerDict pid=84123)[0m   "num_hidden_layers": 28,
[36m(WorkerDict pid=84123)[0m   "num_key_value_heads": 2,
[36m(WorkerDict pid=84123)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=84123)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=84123)[0m   "rope_scaling": null,
[36m(WorkerDict pid=84123)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=84123)[0m   "sliding_window": null,
[36m(WorkerDict pid=84123)[0m   "tie_word_embeddings": true,
[36m(WorkerDict pid=84123)[0m   "transformers_version": "4.56.1",
[36m(WorkerDict pid=84123)[0m   "use_cache": true,
[36m(WorkerDict pid=84123)[0m   "use_mrope": false,
[36m(WorkerDict pid=84123)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=84123)[0m   "vocab_size": 151936
[36m(WorkerDict pid=84123)[0m }
[36m(WorkerDict pid=84123)[0m 
[36m(WorkerDict pid=84123)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=84123)[0m Skipping monkey patch for Qwen2ForCausalLM as use_fused_kernels is False or fused_kernels_backend is torch[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=84123)[0m Qwen2ForCausalLM contains 1.54B parameters
[36m(WorkerDict pid=84123)[0m wrap_policy: functools.partial(<function _or_policy at 0x7ce34307a8e0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7ce34307a7a0>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=84124)[0m /workspace/verl/verl/utils/profiler/config.py:49: UserWarning: Torch profiler tool config is not fully supported now.
[36m(WorkerDict pid=84124)[0m   warnings.warn("Torch profiler tool config is not fully supported now.", stacklevel=1)
[36m(WorkerDict pid=84123)[0m `torch_dtype` is deprecated! Use `dtype` instead![32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=84123)[0m Flash Attention 2 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2Model is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", dtype=torch.float16)`[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=84123)[0m Total steps: 58, num_warmup_steps: 5
[36m(WorkerDict pid=84123)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=84123)[0m Actor use_fused_kernels=False
[36m(WorkerDict pid=84124)[0m [Gloo] Rank 0 is connected to 1 peer ranks. Expected number of connected peer ranks is : 1
[36m(WorkerDict pid=84123)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention[32m [repeated 4x across cluster][0m
[36m(WorkerDict pid=84123)[0m Skipping monkey patch for Qwen2ForCausalLM as use_fused_kernels is False or fused_kernels_backend is torch[32m [repeated 4x across cluster][0m
[36m(WorkerDict pid=84125)[0m NCCL version 2.27.3+cuda12.9
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/67 [00:00<?, ?it/s]
[36m(WorkerDict pid=84123)[0m /workspace/verl/verl/utils/profiler/config.py:49: UserWarning: Torch profiler tool config is not fully supported now.[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=84123)[0m   warnings.warn("Torch profiler tool config is not fully supported now.", stacklevel=1)[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=84123)[0m `torch_dtype` is deprecated! Use `dtype` instead![32m [repeated 4x across cluster][0m
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   3%|▎         | 2/67 [00:00<00:04, 15.37it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   6%|▌         | 4/67 [00:00<00:04, 14.98it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 6/67 [00:01<00:20,  2.93it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  13%|█▎        | 9/67 [00:01<00:11,  5.14it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|█▊        | 12/67 [00:01<00:07,  7.60it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  22%|██▏       | 15/67 [00:01<00:05, 10.14it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  27%|██▋       | 18/67 [00:02<00:03, 12.61it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  31%|███▏      | 21/67 [00:02<00:03, 14.83it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▌      | 24/67 [00:02<00:02, 16.71it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 27/67 [00:02<00:02, 18.28it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  45%|████▍     | 30/67 [00:02<00:01, 19.28it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  49%|████▉     | 33/67 [00:03<00:04,  7.67it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  52%|█████▏    | 35/67 [00:04<00:05,  6.02it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▌    | 37/67 [00:04<00:04,  7.23it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|█████▉    | 40/67 [00:04<00:02,  9.34it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▍   | 43/67 [00:04<00:02, 11.40it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 45/67 [00:04<00:01, 12.65it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  70%|███████   | 47/67 [00:04<00:01, 13.89it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▍  | 50/67 [00:04<00:01, 15.63it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  79%|███████▉  | 53/67 [00:05<00:00, 16.82it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  82%|████████▏ | 55/67 [00:05<00:00, 17.25it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  85%|████████▌ | 57/67 [00:06<00:01,  5.61it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  88%|████████▊ | 59/67 [00:06<00:01,  5.30it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  93%|█████████▎| 62/67 [00:06<00:00,  7.27it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  96%|█████████▌| 64/67 [00:06<00:00,  7.83it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  99%|█████████▊| 66/67 [00:07<00:00,  9.26it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 67/67 [00:07<00:00,  9.34it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/67 [00:00<?, ?it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (decode, FULL):   4%|▍         | 3/67 [00:00<00:02, 22.94it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (decode, FULL):   9%|▉         | 6/67 [00:00<00:02, 23.77it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (decode, FULL):  13%|█▎        | 9/67 [00:00<00:02, 23.98it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (decode, FULL):  18%|█▊        | 12/67 [00:00<00:02, 22.22it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (decode, FULL):  22%|██▏       | 15/67 [00:01<00:10,  5.16it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (decode, FULL):  27%|██▋       | 18/67 [00:02<00:07,  6.99it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (decode, FULL):  31%|███▏      | 21/67 [00:02<00:04,  9.20it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (decode, FULL):  36%|███▌      | 24/67 [00:02<00:03, 11.67it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (decode, FULL):  40%|████      | 27/67 [00:02<00:02, 14.31it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (decode, FULL):  45%|████▍     | 30/67 [00:02<00:02, 17.00it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (decode, FULL):  49%|████▉     | 33/67 [00:02<00:01, 19.30it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (decode, FULL):  54%|█████▎    | 36/67 [00:02<00:01, 21.35it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (decode, FULL):  58%|█████▊    | 39/67 [00:02<00:01, 23.02it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (decode, FULL):  63%|██████▎   | 42/67 [00:02<00:01, 24.23it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 45/67 [00:03<00:00, 24.01it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (decode, FULL):  72%|███████▏  | 48/67 [00:04<00:03,  6.10it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (decode, FULL):  78%|███████▊  | 52/67 [00:04<00:01,  8.63it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (decode, FULL):  82%|████████▏ | 55/67 [00:04<00:01, 10.78it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (decode, FULL):  87%|████████▋ | 58/67 [00:04<00:00, 13.19it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (decode, FULL):  93%|█████████▎| 62/67 [00:04<00:00, 16.43it/s]
[36m(WorkerDict pid=84123)[0m 
Capturing CUDA graphs (decode, FULL):  99%|█████████▊| 66/67 [00:04<00:00, 19.71it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 67/67 [00:04<00:00, 13.45it/s]
[36m(WorkerDict pid=84124)[0m /workspace/anaconda3/envs/verl_rl/lib/python3.12/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:678: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=84124)[0m   warnings.warn(
[36m(WorkerDict pid=84124)[0m kwargs: {'n': 1, 'logprobs': 0, 'max_tokens': 4096, 'repetition_penalty': 1.0, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}
[36m(WorkerDict pid=84125)[0m [Gloo] Rank 0 is connected to 1 peer ranks. Expected number of connected peer ranks is : 1[32m [repeated 35x across cluster][0m
[36m(TaskRunner pid=82921)[0m Checkpoint tracker file does not exist: /workspace/verl_exp/ckpts/CGPO/CGPO-Qwen2.5-1.5B/latest_checkpointed_iteration.txt
[36m(TaskRunner pid=82921)[0m Training from scratch
[36m(TaskRunner pid=82921)[0m 
Training Progress:   0%|          | 0/58 [00:00<?, ?it/s]
[36m(TaskRunner pid=82921)[0m step:1 - actor/entropy:3.4019949436187744 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.005325276658822986) - actor/grad_norm:np.float64(0.5855540633201599) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(49.12219858169556) - perf/max_memory_reserved_gb:np.float64(52.828125) - perf/cpu_memory_used_gb:np.float64(139.0093584060669) - actor/lr:np.float64(0.0) - training/global_step:1 - training/epoch:0 - critic/score/mean:0.03515625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.03515625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.4970932900905609 - critic/advantages/max:2.4804229736328125 - critic/advantages/min:-2.392930507659912 - critic/returns/mean:-0.4970932900905609 - critic/returns/max:2.4804229736328125 - critic/returns/min:-2.392930507659912 - response_length/mean:1496.513671875 - response_length/max:4096.0 - response_length/min:2.0 - response_length/clip_ratio:0.1767578125 - response_length_non_aborted/mean:1496.513671875 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:2.0 - response_length_non_aborted/clip_ratio:0.1767578125 - response/aborted_ratio:0.0 - prompt_length/mean:138.3515625 - prompt_length/max:706.0 - prompt_length/min:76.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00033802958205342293 - timing_s/generate_sequences:102.47947692871094 - timing_s/generation_timing/max:103.2144546508789 - timing_s/generation_timing/min:101.67772674560547 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:110.72057752218097 - timing_s/reward:0.5340042021125555 - timing_s/old_log_prob:30.122937457170337 - timing_s/ref:29.35595076205209 - timing_s/adv:0.3526596617884934 - timing_s/update_actor:99.02988251764327 - timing_s/step:270.4226121199317 - timing_s/stop_profile:6.628921255469322e-05 - timing_per_token_ms/update_actor:0.059154031545057155 - timing_per_token_ms/ref:0.01753534179043576 - timing_per_token_ms/adv:0.00021065601844361538 - timing_per_token_ms/gen:0.07225163793594551 - perf/total_num_tokens:1674102 - perf/time_per_step:270.4226121199317 - perf/throughput:1547.6719817142548
[36m(WorkerDict pid=84125)[0m kwargs: {'n': 1, 'logprobs': 0, 'max_tokens': 4096, 'repetition_penalty': 1.0, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}[32m [repeated 3x across cluster][0m
[36m(TaskRunner pid=82921)[0m 
Training Progress:   2%|▏         | 1/58 [04:30<4:17:14, 270.79s/it]
[36m(WorkerDict pid=84126)[0m /workspace/anaconda3/envs/verl_rl/lib/python3.12/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:678: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=84126)[0m   warnings.warn([32m [repeated 3x across cluster][0m
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m step:2 - actor/entropy:3.2311651706695557 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.005419649133685311) - actor/grad_norm:np.float64(0.6728844046592712) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(51.77236270904541) - perf/max_memory_reserved_gb:np.float64(55.560546875) - perf/cpu_memory_used_gb:np.float64(132.1031436920166) - actor/lr:np.float64(6.000000000000001e-07) - training/global_step:2 - training/epoch:0 - critic/score/mean:0.0361328125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.0361328125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.5141481161117554 - critic/advantages/max:2.3182785511016846 - critic/advantages/min:-2.5557806491851807 - critic/returns/mean:-0.5141481161117554 - critic/returns/max:2.3182785511016846 - critic/returns/min:-2.5557806491851807 - response_length/mean:1427.78515625 - response_length/max:4096.0 - response_length/min:2.0 - response_length/clip_ratio:0.1669921875 - response_length_non_aborted/mean:1427.78515625 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:2.0 - response_length_non_aborted/clip_ratio:0.1669921875 - response/aborted_ratio:0.0 - prompt_length/mean:142.546875 - prompt_length/max:631.0 - prompt_length/min:76.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.553778752684593e-05 - timing_s/generate_sequences:98.22057342529297 - timing_s/generation_timing/max:100.85971069335938 - timing_s/generation_timing/min:95.579345703125 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:109.90265294024721 - timing_s/reward:0.505557619035244 - timing_s/old_log_prob:28.95684924069792 - timing_s/ref:24.324631734751165 - timing_s/adv:0.28341931011527777 - timing_s/update_actor:93.78819836676121 - timing_s/step:258.0345720280893 - timing_s/stop_profile:4.727020859718323e-05 - timing_per_token_ms/update_actor:0.058325268570516044 - timing_per_token_ms/ref:0.015127070393870203 - timing_per_token_ms/adv:0.000176253597663759 - timing_per_token_ms/gen:0.07517013959848706 - perf/total_num_tokens:1608020 - perf/time_per_step:258.0345720280893 - perf/throughput:1557.950149239065
[36m(TaskRunner pid=82921)[0m 
Training Progress:   3%|▎         | 2/58 [08:48<4:05:47, 263.34s/it]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m step:3 - actor/entropy:3.346881151199341 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(1.0146521673526365e-05) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.005382733894947478) - actor/grad_norm:np.float64(0.6897052526473999) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(51.77236270904541) - perf/max_memory_reserved_gb:np.float64(55.560546875) - perf/cpu_memory_used_gb:np.float64(136.7433958053589) - actor/lr:np.float64(1.2000000000000002e-06) - training/global_step:3 - training/epoch:0 - critic/score/mean:0.0380859375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.0380859375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.5372666716575623 - critic/advantages/max:2.293560743331909 - critic/advantages/min:-2.4064180850982666 - critic/returns/mean:-0.5372666716575623 - critic/returns/max:2.293560743331909 - critic/returns/min:-2.4064180850982666 - response_length/mean:1450.4697265625 - response_length/max:4096.0 - response_length/min:2.0 - response_length/clip_ratio:0.1640625 - response_length_non_aborted/mean:1450.4697265625 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:2.0 - response_length_non_aborted/clip_ratio:0.1640625 - response/aborted_ratio:0.0 - prompt_length/mean:137.3359375 - prompt_length/max:640.0 - prompt_length/min:78.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.4733209758996964e-05 - timing_s/generate_sequences:101.36343383789062 - timing_s/generation_timing/max:102.47469329833984 - timing_s/generation_timing/min:100.24036407470703 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:112.17915736790746 - timing_s/reward:0.5259358971379697 - timing_s/old_log_prob:27.980017777998 - timing_s/ref:23.05813478026539 - timing_s/adv:0.2529191989451647 - timing_s/update_actor:96.98567748488858 - timing_s/step:261.26639937981963 - timing_s/stop_profile:4.131114110350609e-05 - timing_per_token_ms/update_actor:0.059649979725168924 - timing_per_token_ms/ref:0.014181653495768463 - timing_per_token_ms/adv:0.0001555551858833558 - timing_per_token_ms/gen:0.075527228428767 - perf/total_num_tokens:1625913 - perf/time_per_step:261.26639937981963 - perf/throughput:1555.7999458211104
[36m(TaskRunner pid=82921)[0m 
Training Progress:   5%|▌         | 3/58 [13:10<4:00:33, 262.43s/it]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m step:4 - actor/entropy:3.1744096279144287 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(1.0660033620268905e-05) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.005495320226657441) - actor/grad_norm:np.float64(0.41482681035995483) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(51.77236270904541) - perf/max_memory_reserved_gb:np.float64(55.5625) - perf/cpu_memory_used_gb:np.float64(126.74834442138672) - actor/lr:np.float64(1.8e-06) - training/global_step:4 - training/epoch:0 - critic/score/mean:0.03125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.03125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.49496638774871826 - critic/advantages/max:2.3106915950775146 - critic/advantages/min:-2.521483898162842 - critic/returns/mean:-0.49496638774871826 - critic/returns/max:2.3106915950775146 - critic/returns/min:-2.521483898162842 - response_length/mean:1465.97265625 - response_length/max:4096.0 - response_length/min:2.0 - response_length/clip_ratio:0.1767578125 - response_length_non_aborted/mean:1465.97265625 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:2.0 - response_length_non_aborted/clip_ratio:0.1767578125 - response/aborted_ratio:0.0 - prompt_length/mean:143.2890625 - prompt_length/max:851.0 - prompt_length/min:80.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.429269418120384e-05 - timing_s/generate_sequences:101.66265869140625 - timing_s/generation_timing/max:104.52965545654297 - timing_s/generation_timing/min:98.28312683105469 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:113.86192279169336 - timing_s/reward:0.5279110097326338 - timing_s/old_log_prob:29.394461730960757 - timing_s/ref:23.010025972034782 - timing_s/adv:0.275111828930676 - timing_s/update_actor:97.20913710119203 - timing_s/step:264.556882080622 - timing_s/stop_profile:3.986107185482979e-05 - timing_per_token_ms/update_actor:0.05899027911017525 - timing_per_token_ms/ref:0.013963377259585494 - timing_per_token_ms/adv:0.00016694854063191097 - timing_per_token_ms/gen:0.07584949385120092 - perf/total_num_tokens:1647884 - perf/time_per_step:264.556882080622 - perf/throughput:1557.2114275010788
[36m(TaskRunner pid=82921)[0m 
Training Progress:   7%|▋         | 4/58 [17:34<3:56:58, 263.30s/it]
[36m(TaskRunner pid=82921)[0m step:5 - actor/entropy:3.2389776706695557 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(1.1449232734328518e-05) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.00538629508230315) - actor/grad_norm:np.float64(0.6262962818145752) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(51.77236270904541) - perf/max_memory_reserved_gb:np.float64(55.5625) - perf/cpu_memory_used_gb:np.float64(135.23488235473633) - actor/lr:np.float64(2.4000000000000003e-06) - training/global_step:5 - training/epoch:0 - critic/score/mean:0.037109375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.037109375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.5146652460098267 - critic/advantages/max:2.2706117630004883 - critic/advantages/min:-2.5241401195526123 - critic/returns/mean:-0.5146652460098267 - critic/returns/max:2.2706117630004883 - critic/returns/min:-2.5241401195526123 - response_length/mean:1506.00390625 - response_length/max:4096.0 - response_length/min:2.0 - response_length/clip_ratio:0.17578125 - response_length_non_aborted/mean:1506.00390625 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:2.0 - response_length_non_aborted/clip_ratio:0.17578125 - response/aborted_ratio:0.0 - prompt_length/mean:134.0390625 - prompt_length/max:448.0 - prompt_length/min:76.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.7507154047489166e-05 - timing_s/generate_sequences:109.19110870361328 - timing_s/generation_timing/max:114.92517852783203 - timing_s/generation_timing/min:103.03594970703125 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:124.12085313070565 - timing_s/reward:0.42852557683363557 - timing_s/old_log_prob:30.326062845997512 - timing_s/ref:25.037342072930187 - timing_s/adv:0.259211135096848 - timing_s/update_actor:101.42152355099097 - timing_s/step:281.818808759097 - timing_s/stop_profile:3.595510497689247e-05 - timing_per_token_ms/update_actor:0.06039137905530234 - timing_per_token_ms/ref:0.01490846876209071 - timing_per_token_ms/adv:0.0001543470987903137 - timing_per_token_ms/gen:0.0804856947132867 - perf/total_num_tokens:1679404 - perf/time_per_step:281.818808759097 - perf/throughput:1489.7905567363853
[36m(TaskRunner pid=82921)[0m 
Training Progress:   9%|▊         | 5/58 [22:16<3:58:30, 270.01s/it]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m step:6 - actor/entropy:3.472443103790283 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(2.3327274184303803e-05) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.005530483632014693) - actor/grad_norm:np.float64(0.3516522943973541) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(51.89966630935669) - perf/max_memory_reserved_gb:np.float64(55.69921875) - perf/cpu_memory_used_gb:np.float64(134.9810028076172) - actor/lr:np.float64(3e-06) - training/global_step:6 - training/epoch:0 - critic/score/mean:0.0341796875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.0341796875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.5595545172691345 - critic/advantages/max:2.2753450870513916 - critic/advantages/min:-2.4812583923339844 - critic/returns/mean:-0.5595545172691345 - critic/returns/max:2.2753450870513916 - critic/returns/min:-2.4812583923339844 - response_length/mean:1630.01171875 - response_length/max:4096.0 - response_length/min:2.0 - response_length/clip_ratio:0.2021484375 - response_length_non_aborted/mean:1630.01171875 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:2.0 - response_length_non_aborted/clip_ratio:0.2021484375 - response/aborted_ratio:0.0 - prompt_length/mean:148.6484375 - prompt_length/max:566.0 - prompt_length/min:75.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.852911949157715e-05 - timing_s/generate_sequences:110.2294921875 - timing_s/generation_timing/max:112.06954193115234 - timing_s/generation_timing/min:108.69996643066406 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:120.86566472705454 - timing_s/reward:0.4433527928777039 - timing_s/old_log_prob:32.829942776821554 - timing_s/ref:25.27088324725628 - timing_s/adv:0.22212036699056625 - timing_s/update_actor:106.58628339320421 - timing_s/step:286.45361458463594 - timing_s/stop_profile:5.8677978813648224e-05 - timing_per_token_ms/update_actor:0.0585205481836553 - timing_per_token_ms/ref:0.013874824167186215 - timing_per_token_ms/adv:0.00012195383144273706 - timing_per_token_ms/gen:0.07241228658192074 - perf/total_num_tokens:1821348 - perf/time_per_step:286.45361458463594 - perf/throughput:1589.5662572114816
[36m(TaskRunner pid=82921)[0m 
Training Progress:  10%|█         | 6/58 [27:03<3:58:52, 275.62s/it]
[36m(TaskRunner pid=82921)[0m step:7 - actor/entropy:3.2134902477264404 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(3.809622483785802e-05) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.004865196181015108) - actor/grad_norm:np.float64(0.2141621857881546) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(51.93638753890991) - perf/max_memory_reserved_gb:np.float64(55.73828125) - perf/cpu_memory_used_gb:np.float64(140.00492191314697) - actor/lr:np.float64(3e-06) - training/global_step:7 - training/epoch:0 - critic/score/mean:0.076171875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.076171875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.4590194523334503 - critic/advantages/max:2.3408615589141846 - critic/advantages/min:-2.562781810760498 - critic/returns/mean:-0.4590194523334503 - critic/returns/max:2.3408615589141846 - critic/returns/min:-2.562781810760498 - response_length/mean:2006.6943359375 - response_length/max:4096.0 - response_length/min:4.0 - response_length/clip_ratio:0.2783203125 - response_length_non_aborted/mean:2006.6943359375 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:4.0 - response_length_non_aborted/clip_ratio:0.2783203125 - response/aborted_ratio:0.0 - prompt_length/mean:140.1171875 - prompt_length/max:504.0 - prompt_length/min:78.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.9892736822366714e-05 - timing_s/generate_sequences:138.63095092773438 - timing_s/generation_timing/max:140.97079467773438 - timing_s/generation_timing/min:135.77330017089844 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:149.80426944699138 - timing_s/reward:0.5399870756082237 - timing_s/old_log_prob:35.11883102077991 - timing_s/ref:28.052102393936366 - timing_s/adv:0.2537053031846881 - timing_s/update_actor:119.21683334605768 - timing_s/step:333.2384107080288 - timing_s/stop_profile:4.9311667680740356e-05 - timing_per_token_ms/update_actor:0.0542305123405021 - timing_per_token_ms/ref:0.012760613097610857 - timing_per_token_ms/adv:0.00011540793518034698 - timing_per_token_ms/gen:0.07290259869771414 - perf/total_num_tokens:2198335 - perf/time_per_step:333.2384107080288 - perf/throughput:1649.2208951312186
[36m(TaskRunner pid=82921)[0m 
Training Progress:  12%|█▏        | 7/58 [32:36<4:10:18, 294.48s/it]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m step:8 - actor/entropy:3.274496078491211 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(5.094664004801075e-05) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.004981635520948657) - actor/grad_norm:np.float64(0.16922318935394287) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(52.51537084579468) - perf/max_memory_reserved_gb:np.float64(56.326171875) - perf/cpu_memory_used_gb:np.float64(139.37928771972656) - actor/lr:np.float64(3e-06) - training/global_step:8 - training/epoch:0 - critic/score/mean:0.06640625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.06640625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.46673840284347534 - critic/advantages/max:2.3142895698547363 - critic/advantages/min:-2.5242648124694824 - critic/returns/mean:-0.46673840284347534 - critic/returns/max:2.3142895698547363 - critic/returns/min:-2.5242648124694824 - response_length/mean:2143.8828125 - response_length/max:4096.0 - response_length/min:5.0 - response_length/clip_ratio:0.2978515625 - response_length_non_aborted/mean:2143.8828125 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:5.0 - response_length_non_aborted/clip_ratio:0.2978515625 - response/aborted_ratio:0.0 - prompt_length/mean:145.3671875 - prompt_length/max:784.0 - prompt_length/min:75.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.6797020584344864e-05 - timing_s/generate_sequences:147.1640167236328 - timing_s/generation_timing/max:150.49932861328125 - timing_s/generation_timing/min:143.51296997070312 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:159.29951113509014 - timing_s/reward:0.7131113400682807 - timing_s/old_log_prob:38.44900079118088 - timing_s/ref:28.730782664380968 - timing_s/adv:0.2528376681730151 - timing_s/update_actor:126.92487939912826 - timing_s/step:354.68362409295514 - timing_s/stop_profile:3.3830758184194565e-05 - timing_per_token_ms/update_actor:0.054144404297569594 - timing_per_token_ms/ref:0.012256155922544299 - timing_per_token_ms/adv:0.00010785706468284813 - timing_per_token_ms/gen:0.0725627016252137 - perf/total_num_tokens:2344192 - perf/time_per_step:354.68362409295514 - perf/throughput:1652.3119766206323
[36m(TaskRunner pid=82921)[0m 
Training Progress:  14%|█▍        | 8/58 [38:31<4:21:23, 313.67s/it]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m step:9 - actor/entropy:3.1758716106414795 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(5.476487377364947e-05) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.004977935737748851) - actor/grad_norm:np.float64(0.13768841326236725) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(52.51537084579468) - perf/max_memory_reserved_gb:np.float64(56.326171875) - perf/cpu_memory_used_gb:np.float64(139.42363166809082) - actor/lr:np.float64(3e-06) - training/global_step:9 - training/epoch:0 - critic/score/mean:0.0693359375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.0693359375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.4719211161136627 - critic/advantages/max:2.386127233505249 - critic/advantages/min:-2.5343005657196045 - critic/returns/mean:-0.4719211161136627 - critic/returns/max:2.386127233505249 - critic/returns/min:-2.5343005657196045 - response_length/mean:2320.203125 - response_length/max:4096.0 - response_length/min:30.0 - response_length/clip_ratio:0.345703125 - response_length_non_aborted/mean:2320.203125 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:30.0 - response_length_non_aborted/clip_ratio:0.345703125 - response/aborted_ratio:0.0 - prompt_length/mean:136.515625 - prompt_length/max:495.0 - prompt_length/min:75.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.0002694232389330864 - timing_s/generate_sequences:159.78294372558594 - timing_s/generation_timing/max:171.5041046142578 - timing_s/generation_timing/min:148.2384490966797 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:179.2664762828499 - timing_s/reward:0.7783723101019859 - timing_s/old_log_prob:39.726804786827415 - timing_s/ref:30.147273721173406 - timing_s/adv:0.3323362497612834 - timing_s/update_actor:133.02948761172593 - timing_s/step:383.5105094462633 - timing_s/stop_profile:3.911508247256279e-05 - timing_per_token_ms/update_actor:0.05288013086391191 - timing_per_token_ms/ref:0.011983747424622132 - timing_per_token_ms/adv:0.00013210593150213198 - timing_per_token_ms/gen:0.0754524103336731 - perf/total_num_tokens:2515680 - perf/time_per_step:383.5105094462633 - perf/throughput:1639.9029088096554
[36m(TaskRunner pid=82921)[0m 
Training Progress:  16%|█▌        | 9/58 [44:55<4:34:01, 335.54s/it]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m test_gen_batch meta info: {'eos_token_id': 151643, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 10}
[36m(TaskRunner pid=82921)[0m validation generation end
[36m(TaskRunner pid=82921)[0m [prompt] system
[36m(TaskRunner pid=82921)[0m You are a helpful AI Assistant, designed to provide well-reasoned and detailed responses. You FIRST think about the reasoning process step by step and then provide the user with the answer. Please enclose your final answer in the box: \boxed{Your Answer}.
[36m(TaskRunner pid=82921)[0m user
[36m(TaskRunner pid=82921)[0m Bin $A$ has one white ball and four black balls.  Bin $B$ has three balls labeled $\$1$ and one ball labeled $\$7$.  Bin $W$ has five balls labeled $\$8$ and one ball labeled $\$500$.  A game is played as follows: a ball is randomly selected from bin $A$.  If it is black, then a ball is randomly selected from bin $B$; otherwise, if the original ball is white, then a ball is randomly selected from bin $W$.  You win the amount printed on the second ball selected.  What is your expected win?
[36m(TaskRunner pid=82921)[0m assistant
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m [response] To find the expected win, we need to consider the probabilities of each scenario and the corresponding winnings.
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 1. Probability of selecting a black ball from bin $A$: $\frac{4}{5}$
[36m(TaskRunner pid=82921)[0m 2. Probability of selecting a white ball from bin $A$: $\frac{1}{5}$
[36m(TaskRunner pid=82921)[0m 3. Probability of selecting a ball from bin $B$: $\frac{1}{5}$
[36m(TaskRunner pid=82921)[0m 4. Probability of selecting a ball from bin $W$: $\frac{4}{5}$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Now, we can calculate the expected win by multiplying the probability of each scenario by the corresponding winnings and summing them up:
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{5} \times \$7\right) + \left(\frac{1}{5} \times \$8\right) + \left(\frac{4}{5} \times \$500\right)$
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Expected win = $\left(\frac{4}{5} \times \$1\right) + \left(\frac{1}{
[36m(TaskRunner pid=82921)[0m [ground_truth] \$20
[36m(TaskRunner pid=82921)[0m [score] 0.0
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m step:10 - actor/entropy:2.972642421722412 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(7.38092679739566e-05) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.004261503674761968) - actor/grad_norm:np.float64(0.14000385999679565) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(52.51537084579468) - perf/max_memory_reserved_gb:np.float64(56.326171875) - perf/cpu_memory_used_gb:np.float64(136.3863124847412) - actor/lr:np.float64(3e-06) - val-core/DigitalLearningGmbH/MATH-lighteval/reward/mean@1:np.float64(0.29891956782713086) - training/global_step:10 - training/epoch:0 - critic/score/mean:0.1083984375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.1083984375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.4134760797023773 - critic/advantages/max:2.4427490234375 - critic/advantages/min:-2.441441774368286 - critic/returns/mean:-0.4134760797023773 - critic/returns/max:2.4427490234375 - critic/returns/min:-2.441441774368286 - response_length/mean:2367.373046875 - response_length/max:4096.0 - response_length/min:50.0 - response_length/clip_ratio:0.3701171875 - response_length_non_aborted/mean:2367.373046875 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:50.0 - response_length_non_aborted/clip_ratio:0.3701171875 - response/aborted_ratio:0.0 - prompt_length/mean:136.25 - prompt_length/max:502.0 - prompt_length/min:73.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.130298763513565e-05 - timing_s/generate_sequences:160.8154296875 - timing_s/generation_timing/max:162.03160095214844 - timing_s/generation_timing/min:159.5086212158203 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:170.72608007723466 - timing_s/reward:0.7549681672826409 - timing_s/old_log_prob:36.85830126516521 - timing_s/ref:30.950219434220344 - timing_s/adv:0.317505001090467 - timing_s/update_actor:131.27340346807614 - timing_s/step:371.10423636063933 - timing_s/testing:1256.1181939500384 - timing_s/stop_profile:4.081195220351219e-05 - timing_per_token_ms/update_actor:0.0512044667564101 - timing_per_token_ms/ref:0.012072433868971274 - timing_per_token_ms/adv:0.0001238459112342921 - timing_per_token_ms/gen:0.07042603099477955 - perf/total_num_tokens:2563710 - perf/time_per_step:371.10423636063933 - perf/throughput:1727.082143511685
[36m(TaskRunner pid=82921)[0m 
Training Progress:  17%|█▋        | 10/58 [1:12:02<9:47:29, 734.37s/it]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m step:11 - actor/entropy:2.641794443130493 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(8.70938799764076e-05) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.00408369467862002) - actor/grad_norm:np.float64(0.10877445340156555) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(52.697757720947266) - perf/max_memory_reserved_gb:np.float64(56.50390625) - perf/cpu_memory_used_gb:np.float64(151.18706130981445) - actor/lr:np.float64(3e-06) - training/global_step:11 - training/epoch:0 - critic/score/mean:0.1181640625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.1181640625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.34820571541786194 - critic/advantages/max:2.3134145736694336 - critic/advantages/min:-2.478266716003418 - critic/returns/mean:-0.34820571541786194 - critic/returns/max:2.3134145736694336 - critic/returns/min:-2.478266716003418 - response_length/mean:2784.1669921875 - response_length/max:4096.0 - response_length/min:103.0 - response_length/clip_ratio:0.4609375 - response_length_non_aborted/mean:2784.1669921875 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:103.0 - response_length_non_aborted/clip_ratio:0.4609375 - response/aborted_ratio:0.0 - prompt_length/mean:150.546875 - prompt_length/max:906.0 - prompt_length/min:75.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.466801717877388e-05 - timing_s/generate_sequences:192.5502166748047 - timing_s/generation_timing/max:201.1588134765625 - timing_s/generation_timing/min:184.47511291503906 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:208.15825989376754 - timing_s/reward:1.0887964963912964 - timing_s/old_log_prob:40.82371388701722 - timing_s/ref:35.56500137085095 - timing_s/adv:0.2970023318193853 - timing_s/update_actor:148.4922812958248 - timing_s/step:435.0886146891862 - timing_s/stop_profile:5.5546872317790985e-05 - timing_per_token_ms/update_actor:0.04941265145958743 - timing_per_token_ms/ref:0.011834696063404202 - timing_per_token_ms/adv:9.883121585046764e-05 - timing_per_token_ms/gen:0.07301270047663057 - perf/total_num_tokens:3005147 - perf/time_per_step:435.0886146891862 - perf/throughput:1726.7442186155479
[36m(TaskRunner pid=82921)[0m 
Training Progress:  19%|█▉        | 11/58 [1:19:17<8:23:31, 642.81s/it]
[36m(TaskRunner pid=82921)[0m step:12 - actor/entropy:2.550433874130249 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00010424902808381376) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.003575459235932499) - actor/grad_norm:np.float64(0.10721977055072784) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(52.697757720947266) - perf/max_memory_reserved_gb:np.float64(56.50390625) - perf/cpu_memory_used_gb:np.float64(169.98968887329102) - actor/lr:np.float64(3e-06) - training/global_step:12 - training/epoch:0 - critic/score/mean:0.1513671875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.1513671875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.32384392619132996 - critic/advantages/max:2.3613736629486084 - critic/advantages/min:-2.4199960231781006 - critic/returns/mean:-0.32384392619132996 - critic/returns/max:2.3613736629486084 - critic/returns/min:-2.4199960231781006 - response_length/mean:2911.080078125 - response_length/max:4096.0 - response_length/min:65.0 - response_length/clip_ratio:0.5126953125 - response_length_non_aborted/mean:2911.080078125 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:65.0 - response_length_non_aborted/clip_ratio:0.5126953125 - response/aborted_ratio:0.0 - prompt_length/mean:134.3515625 - prompt_length/max:466.0 - prompt_length/min:78.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.335997462272644e-05 - timing_s/generate_sequences:197.03273010253906 - timing_s/generation_timing/max:200.43899536132812 - timing_s/generation_timing/min:193.1053466796875 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:208.40959879616275 - timing_s/reward:0.8544406481087208 - timing_s/old_log_prob:41.99161887681112 - timing_s/ref:36.511909138876945 - timing_s/adv:0.31491367099806666 - timing_s/update_actor:151.8319430500269 - timing_s/step:440.1481203921139 - timing_s/stop_profile:4.3598003685474396e-05 - timing_per_token_ms/update_actor:0.048687148286921465 - timing_per_token_ms/ref:0.011708081308670243 - timing_per_token_ms/adv:0.0001009817057561456 - timing_per_token_ms/gen:0.06991391283041114 - perf/total_num_tokens:3118522 - perf/time_per_step:440.1481203921139 - perf/throughput:1771.2912173871198
[36m(TaskRunner pid=82921)[0m 
Training Progress:  21%|██        | 12/58 [1:26:37<7:25:34, 581.17s/it]
[36m(TaskRunner pid=82921)[0m step:13 - actor/entropy:2.5930206775665283 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00011307881199229541) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.004124557264840956) - actor/grad_norm:np.float64(0.10479853302240372) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(151.63024139404297) - actor/lr:np.float64(3e-06) - training/global_step:13 - training/epoch:0 - critic/score/mean:0.1220703125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.1220703125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.345367968082428 - critic/advantages/max:2.510741710662842 - critic/advantages/min:-2.4980013370513916 - critic/returns/mean:-0.345367968082428 - critic/returns/max:2.510741710662842 - critic/returns/min:-2.4980013370513916 - response_length/mean:2975.0576171875 - response_length/max:4096.0 - response_length/min:111.0 - response_length/clip_ratio:0.5224609375 - response_length_non_aborted/mean:2975.0576171875 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:111.0 - response_length_non_aborted/clip_ratio:0.5224609375 - response/aborted_ratio:0.0 - prompt_length/mean:155.9609375 - prompt_length/max:880.0 - prompt_length/min:77.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.1386036425828934e-05 - timing_s/generate_sequences:205.18408203125 - timing_s/generation_timing/max:206.21763610839844 - timing_s/generation_timing/min:204.42225646972656 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:214.58944847714156 - timing_s/reward:0.82048384193331 - timing_s/old_log_prob:44.02242783596739 - timing_s/ref:36.27212357427925 - timing_s/adv:0.25494637293741107 - timing_s/update_actor:156.92221986688673 - timing_s/step:453.0656459769234 - timing_s/stop_profile:6.631296128034592e-05 - timing_per_token_ms/update_actor:0.048943930756760255 - timing_per_token_ms/ref:0.011313250004531662 - timing_per_token_ms/adv:7.951759562361959e-05 - timing_per_token_ms/gen:0.07043897471692269 - perf/total_num_tokens:3206163 - perf/time_per_step:453.0656459769234 - perf/throughput:1769.1492548980991
[36m(TaskRunner pid=82921)[0m 
Training Progress:  22%|██▏       | 13/58 [1:34:10<6:46:47, 542.38s/it]
[36m(TaskRunner pid=82921)[0m step:14 - actor/entropy:2.442681074142456 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00011923516041179028) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.003802781200661798) - actor/grad_norm:np.float64(0.10561434924602509) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(153.06331825256348) - actor/lr:np.float64(3e-06) - training/global_step:14 - training/epoch:0 - critic/score/mean:0.15625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.15625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.31975850462913513 - critic/advantages/max:2.29964280128479 - critic/advantages/min:-2.564246654510498 - critic/returns/mean:-0.31975850462913513 - critic/returns/max:2.29964280128479 - critic/returns/min:-2.564246654510498 - response_length/mean:3017.8505859375 - response_length/max:4096.0 - response_length/min:15.0 - response_length/clip_ratio:0.5576171875 - response_length_non_aborted/mean:3017.8505859375 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:15.0 - response_length_non_aborted/clip_ratio:0.5576171875 - response/aborted_ratio:0.0 - prompt_length/mean:133.90625 - prompt_length/max:684.0 - prompt_length/min:76.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.313590660691261e-05 - timing_s/generate_sequences:211.9606475830078 - timing_s/generation_timing/max:213.8264617919922 - timing_s/generation_timing/min:209.7512969970703 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:222.951582566835 - timing_s/reward:0.7284881887026131 - timing_s/old_log_prob:42.67929468303919 - timing_s/ref:36.766525904182345 - timing_s/adv:0.31509684305638075 - timing_s/update_actor:157.22568613430485 - timing_s/step:460.83782760519534 - timing_s/stop_profile:0.0001319502480328083 - timing_per_token_ms/update_actor:0.048715912142968644 - timing_per_token_ms/ref:0.0113919989143525 - timing_per_token_ms/adv:9.76318214935249e-05 - timing_per_token_ms/gen:0.07214610155485475 - perf/total_num_tokens:3227399 - perf/time_per_step:460.83782760519534 - perf/throughput:1750.8322921165159
[36m(TaskRunner pid=82921)[0m 
Training Progress:  24%|██▍       | 14/58 [1:41:51<6:19:42, 517.79s/it]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m step:15 - actor/entropy:2.3701741695404053 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00012924804126157596) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.003972197463860461) - actor/grad_norm:np.float64(0.11741968989372253) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(147.40837478637695) - actor/lr:np.float64(3e-06) - training/global_step:15 - training/epoch:0 - critic/score/mean:0.14453125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.14453125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.36535143852233887 - critic/advantages/max:2.465406656265259 - critic/advantages/min:-2.5155670642852783 - critic/returns/mean:-0.36535143852233887 - critic/returns/max:2.465406656265259 - critic/returns/min:-2.5155670642852783 - response_length/mean:2856.5810546875 - response_length/max:4096.0 - response_length/min:152.0 - response_length/clip_ratio:0.498046875 - response_length_non_aborted/mean:2856.5810546875 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:152.0 - response_length_non_aborted/clip_ratio:0.498046875 - response/aborted_ratio:0.0 - prompt_length/mean:141.15625 - prompt_length/max:628.0 - prompt_length/min:76.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.9983075112104416e-05 - timing_s/generate_sequences:193.4158935546875 - timing_s/generation_timing/max:194.077392578125 - timing_s/generation_timing/min:192.59439086914062 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:202.7171721109189 - timing_s/reward:0.683149038348347 - timing_s/old_log_prob:40.782438897993416 - timing_s/ref:35.46066102711484 - timing_s/adv:0.2957624359987676 - timing_s/update_actor:150.26479948917404 - timing_s/step:430.37545946985483 - timing_s/stop_profile:4.528416320681572e-05 - timing_per_token_ms/update_actor:0.04895124333332596 - timing_per_token_ms/ref:0.011551896735628675 - timing_per_token_ms/adv:9.634950449240772e-05 - timing_per_token_ms/gen:0.06930172279365832 - perf/total_num_tokens:3069683 - perf/time_per_step:430.37545946985483 - perf/throughput:1783.1424471676994
[36m(TaskRunner pid=82921)[0m 
Training Progress:  26%|██▌       | 15/58 [1:49:02<5:52:12, 491.46s/it]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m step:16 - actor/entropy:2.2508039474487305 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00013344628546008153) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.0034855814685910147) - actor/grad_norm:np.float64(0.10813544690608978) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(152.72345542907715) - actor/lr:np.float64(3e-06) - training/global_step:16 - training/epoch:0 - critic/score/mean:0.1708984375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.1708984375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.30916929244995117 - critic/advantages/max:2.280435085296631 - critic/advantages/min:-2.5012407302856445 - critic/returns/mean:-0.30916929244995117 - critic/returns/max:2.280435085296631 - critic/returns/min:-2.5012407302856445 - response_length/mean:3027.388671875 - response_length/max:4096.0 - response_length/min:138.0 - response_length/clip_ratio:0.560546875 - response_length_non_aborted/mean:3027.388671875 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:138.0 - response_length_non_aborted/clip_ratio:0.560546875 - response/aborted_ratio:0.0 - prompt_length/mean:136.4453125 - prompt_length/max:409.0 - prompt_length/min:76.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.9602164179086685e-05 - timing_s/generate_sequences:214.39283752441406 - timing_s/generation_timing/max:217.0384063720703 - timing_s/generation_timing/min:212.13780212402344 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:225.68469191901386 - timing_s/reward:0.8623362220823765 - timing_s/old_log_prob:41.731003291904926 - timing_s/ref:36.041290937922895 - timing_s/adv:0.27702128514647484 - timing_s/update_actor:156.07351839123294 - timing_s/step:460.9097416601144 - timing_s/stop_profile:4.1346997022628784e-05 - timing_per_token_ms/update_actor:0.048174318265959006 - timing_per_token_ms/ref:0.011124658675324976 - timing_per_token_ms/adv:8.550657212480001e-05 - timing_per_token_ms/gen:0.07280043325776903 - perf/total_num_tokens:3239766 - perf/time_per_step:460.9097416601144 - perf/throughput:1757.267045566743
[36m(TaskRunner pid=82921)[0m 
Training Progress:  28%|██▊       | 16/58 [1:56:43<5:37:35, 482.28s/it]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m step:17 - actor/entropy:2.050977945327759 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00013911549262957124) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.0034144852741704312) - actor/grad_norm:np.float64(0.10326359421014786) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(147.61566352844238) - actor/lr:np.float64(3e-06) - training/global_step:17 - training/epoch:0 - critic/score/mean:0.1904296875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.1904296875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.3254774808883667 - critic/advantages/max:2.451826572418213 - critic/advantages/min:-2.5382938385009766 - critic/returns/mean:-0.3254774808883667 - critic/returns/max:2.451826572418213 - critic/returns/min:-2.5382938385009766 - response_length/mean:2771.8544921875 - response_length/max:4096.0 - response_length/min:139.0 - response_length/clip_ratio:0.486328125 - response_length_non_aborted/mean:2771.8544921875 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:139.0 - response_length_non_aborted/clip_ratio:0.486328125 - response/aborted_ratio:0.0 - prompt_length/mean:137.3671875 - prompt_length/max:573.0 - prompt_length/min:75.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.711319580674171e-05 - timing_s/generate_sequences:194.36180114746094 - timing_s/generation_timing/max:201.39256286621094 - timing_s/generation_timing/min:187.5004425048828 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:211.25037765409797 - timing_s/reward:0.8198384586721659 - timing_s/old_log_prob:42.426260804291815 - timing_s/ref:34.89007928222418 - timing_s/adv:0.3183754081837833 - timing_s/update_actor:146.8814788321033 - timing_s/step:436.8293300466612 - timing_s/stop_profile:4.40496951341629e-05 - timing_per_token_ms/update_actor:0.04930492068496605 - timing_per_token_ms/ref:0.011711841447815348 - timing_per_token_ms/adv:0.00010687170617670953 - timing_per_token_ms/gen:0.07442641650537084 - perf/total_num_tokens:2979043 - perf/time_per_step:436.8293300466612 - perf/throughput:1704.9238656214916
[36m(TaskRunner pid=82921)[0m 
Training Progress:  29%|██▉       | 17/58 [2:04:00<5:20:14, 468.64s/it]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m step:18 - actor/entropy:1.8987568616867065 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00015838947666679815) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.0031102369613336123) - actor/grad_norm:np.float64(0.11487360298633575) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(141.96957397460938) - actor/lr:np.float64(3e-06) - training/global_step:18 - training/epoch:0 - critic/score/mean:0.185546875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.185546875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.3314358592033386 - critic/advantages/max:2.4713497161865234 - critic/advantages/min:-2.551568031311035 - critic/returns/mean:-0.3314358592033386 - critic/returns/max:2.4713497161865234 - critic/returns/min:-2.551568031311035 - response_length/mean:2625.0771484375 - response_length/max:4096.0 - response_length/min:101.0 - response_length/clip_ratio:0.4501953125 - response_length_non_aborted/mean:2625.0771484375 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:101.0 - response_length_non_aborted/clip_ratio:0.4501953125 - response/aborted_ratio:0.0 - prompt_length/mean:147.3828125 - prompt_length/max:594.0 - prompt_length/min:74.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.277633994817734e-05 - timing_s/generate_sequences:185.19459533691406 - timing_s/generation_timing/max:192.8146209716797 - timing_s/generation_timing/min:177.5977325439453 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:200.5733037078753 - timing_s/reward:0.8200809899717569 - timing_s/old_log_prob:40.03111516078934 - timing_s/ref:33.497618352063 - timing_s/adv:0.29503406304866076 - timing_s/update_actor:143.32841082429513 - timing_s/step:418.7476119422354 - timing_s/stop_profile:0.00010359706357121468 - timing_per_token_ms/update_actor:0.050485544667079885 - timing_per_token_ms/ref:0.01179909480491645 - timing_per_token_ms/adv:0.00010392186226506623 - timing_per_token_ms/gen:0.07461585158318461 - perf/total_num_tokens:2838999 - perf/time_per_step:418.7476119422354 - perf/throughput:1694.934442033086
[36m(TaskRunner pid=82921)[0m 
Training Progress:  31%|███       | 18/58 [2:10:59<5:02:26, 453.67s/it]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m step:19 - actor/entropy:1.864453673362732 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00016354968238374568) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.002755106622458925) - actor/grad_norm:np.float64(0.11477873474359512) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(146.63911819458008) - actor/lr:np.float64(3e-06) - training/global_step:19 - training/epoch:0 - critic/score/mean:0.244140625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.244140625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.3134852945804596 - critic/advantages/max:2.465757131576538 - critic/advantages/min:-2.555967330932617 - critic/returns/mean:-0.3134852945804596 - critic/returns/max:2.465757131576538 - critic/returns/min:-2.555967330932617 - response_length/mean:2424.9814453125 - response_length/max:4096.0 - response_length/min:123.0 - response_length/clip_ratio:0.39453125 - response_length_non_aborted/mean:2424.9814453125 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:123.0 - response_length_non_aborted/clip_ratio:0.39453125 - response/aborted_ratio:0.0 - prompt_length/mean:138.15625 - prompt_length/max:761.0 - prompt_length/min:77.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.958322435617447e-05 - timing_s/generate_sequences:165.71652221679688 - timing_s/generation_timing/max:171.12677001953125 - timing_s/generation_timing/min:160.4362335205078 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:179.27949333610013 - timing_s/reward:0.7573319510556757 - timing_s/old_log_prob:38.37870338419452 - timing_s/ref:30.67748712701723 - timing_s/adv:0.23253118293359876 - timing_s/update_actor:134.80596499657258 - timing_s/step:384.34332347800955 - timing_s/stop_profile:3.823405131697655e-05 - timing_per_token_ms/update_actor:0.0513614428256126 - timing_per_token_ms/ref:0.011688206832300206 - timing_per_token_ms/adv:8.859501920200452e-05 - timing_per_token_ms/gen:0.0721975133250859 - perf/total_num_tokens:2624653 - perf/time_per_step:384.34332347800955 - perf/throughput:1707.2320759008653
[36m(TaskRunner pid=82921)[0m 
Training Progress:  33%|███▎      | 19/58 [2:17:23<4:41:21, 432.86s/it]
[36m(TaskRunner pid=82921)[0m test_gen_batch meta info: {'eos_token_id': 151643, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 20}
[36m(TaskRunner pid=82921)[0m validation generation end
[36m(TaskRunner pid=82921)[0m [prompt] system
[36m(TaskRunner pid=82921)[0m You are a helpful AI Assistant, designed to provide well-reasoned and detailed responses. You FIRST think about the reasoning process step by step and then provide the user with the answer. Please enclose your final answer in the box: \boxed{Your Answer}.
[36m(TaskRunner pid=82921)[0m user
[36m(TaskRunner pid=82921)[0m Bin $A$ has one white ball and four black balls.  Bin $B$ has three balls labeled $\$1$ and one ball labeled $\$7$.  Bin $W$ has five balls labeled $\$8$ and one ball labeled $\$500$.  A game is played as follows: a ball is randomly selected from bin $A$.  If it is black, then a ball is randomly selected from bin $B$; otherwise, if the original ball is white, then a ball is randomly selected from bin $W$.  You win the amount printed on the second ball selected.  What is your expected win?
[36m(TaskRunner pid=82921)[0m assistant
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m [response] To find the expected win, we need to consider the probabilities of each scenario and the corresponding winnings. Let's break it down step by step.
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 1. **Probability of selecting a black ball from bin A:**
[36m(TaskRunner pid=82921)[0m    - Bin A has 1 white ball and 4 black balls.
[36m(TaskRunner pid=82921)[0m    - Total balls in bin A: \(1 + 4 = 5\).
[36m(TaskRunner pid=82921)[0m    - Probability of selecting a black ball from bin A: \(\frac{4}{5}\).
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 2. **Probability of selecting a white ball from bin A:**
[36m(TaskRunner pid=82921)[0m    - Bin A has 1 white ball and 4 black balls.
[36m(TaskRunner pid=82921)[0m    - Total balls in bin A: \(1 + 4 = 5\).
[36m(TaskRunner pid=82921)[0m    - Probability of selecting a white ball from bin A: \(\frac{1}{5}\).
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 3. **Probability of selecting a ball from bin B:**
[36m(TaskRunner pid=82921)[0m    - If a black ball is selected from bin A, a ball is randomly selected from bin B.
[36m(TaskRunner pid=82921)[0m    - Bin B has 3 balls labeled \$1 and 1 ball labeled \$7.
[36m(TaskRunner pid=82921)[0m    - Total balls in bin B: \(3 + 1 = 4\).
[36m(TaskRunner pid=82921)[0m    - Probability of selecting a ball from bin B: \(\frac{4}{5}\).
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 4. **Probability of selecting a ball from bin W:**
[36m(TaskRunner pid=82921)[0m    - If a white ball is selected from bin A, a ball is randomly selected from bin W.
[36m(TaskRunner pid=82921)[0m    - Bin W has 5 balls labeled \$8 and 1 ball labeled \$500.
[36m(TaskRunner pid=82921)[0m    - Total balls in bin W: \(5 + 1 = 6\).
[36m(TaskRunner pid=82921)[0m    - Probability of selecting a ball from bin W: \(\frac{6}{5}\).
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Now, we calculate the expected win by considering the winnings from each scenario:
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m - If a black ball is selected from bin A, the winnings are \$1 from bin B.
[36m(TaskRunner pid=82921)[0m - If a white ball is selected from bin A, the winnings are \$8 from bin W.
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m The expected win \(E\) can be calculated as follows:
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m E = \left(\frac{4}{5} \times 1\right) + \left(\frac{1}{5} \times 8\right)
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Simplify the expression:
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m E = \frac{4}{5} + \frac{8}{5} = \frac{4 + 8}{5} = \frac{12}{5} = 2.4
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Therefore, the expected win is \(\boxed{2.4}\).
[36m(TaskRunner pid=82921)[0m [ground_truth] \$20
[36m(TaskRunner pid=82921)[0m [score] 0.0
[36m(TaskRunner pid=82921)[0m step:20 - actor/entropy:1.6300216913223267 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00017049673841995627) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.002571635778292336) - actor/grad_norm:np.float64(0.12080337852239609) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(144.13860321044922) - actor/lr:np.float64(3e-06) - val-core/DigitalLearningGmbH/MATH-lighteval/reward/mean@1:np.float64(0.46938775510204084) - training/global_step:20 - training/epoch:0 - critic/score/mean:0.275390625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.275390625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.3416500985622406 - critic/advantages/max:2.511204481124878 - critic/advantages/min:-2.538465976715088 - critic/returns/mean:-0.3416500985622406 - critic/returns/max:2.511204481124878 - critic/returns/min:-2.538465976715088 - response_length/mean:2098.197265625 - response_length/max:4096.0 - response_length/min:42.0 - response_length/clip_ratio:0.3115234375 - response_length_non_aborted/mean:2098.197265625 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:42.0 - response_length_non_aborted/clip_ratio:0.3115234375 - response/aborted_ratio:0.0 - prompt_length/mean:140.921875 - prompt_length/max:689.0 - prompt_length/min:74.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.8796028345823288e-05 - timing_s/generate_sequences:145.85394287109375 - timing_s/generation_timing/max:155.37725830078125 - timing_s/generation_timing/min:136.46414184570312 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:163.98447206104174 - timing_s/reward:0.6515271021053195 - timing_s/old_log_prob:34.890629494097084 - timing_s/ref:27.75735449884087 - timing_s/adv:0.296443372964859 - timing_s/update_actor:119.90121022099629 - timing_s/step:347.71242241514847 - timing_s/testing:497.0355359967798 - timing_s/stop_profile:4.787510260939598e-05 - timing_per_token_ms/update_actor:0.05229334316429377 - timing_per_token_ms/ref:0.012106006782295663 - timing_per_token_ms/adv:0.0001292898962625941 - timing_per_token_ms/gen:0.07632317924568884 - perf/total_num_tokens:2292858 - perf/time_per_step:347.71242241514847 - perf/throughput:1648.5304034252051
[36m(TaskRunner pid=82921)[0m 
Training Progress:  34%|███▍      | 20/58 [2:31:28<5:52:28, 556.55s/it]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m step:21 - actor/entropy:1.3811719417572021 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0001948291889561915) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.0023585195384079327) - actor/grad_norm:np.float64(0.13367442786693573) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(142.36113739013672) - actor/lr:np.float64(3e-06) - training/global_step:21 - training/epoch:0 - critic/score/mean:0.2900390625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.2900390625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.3970153033733368 - critic/advantages/max:2.5511505603790283 - critic/advantages/min:-2.5518031120300293 - critic/returns/mean:-0.3970153033733368 - critic/returns/max:2.5511505603790283 - critic/returns/min:-2.5518031120300293 - response_length/mean:1582.8447265625 - response_length/max:4096.0 - response_length/min:102.0 - response_length/clip_ratio:0.185546875 - response_length_non_aborted/mean:1582.8447265625 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:102.0 - response_length_non_aborted/clip_ratio:0.185546875 - response/aborted_ratio:0.0 - prompt_length/mean:142.296875 - prompt_length/max:905.0 - prompt_length/min:75.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.220101982355118e-05 - timing_s/generate_sequences:112.08057403564453 - timing_s/generation_timing/max:113.66867065429688 - timing_s/generation_timing/min:111.26908111572266 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:118.80958206532523 - timing_s/reward:0.45203160773962736 - timing_s/old_log_prob:29.67642751056701 - timing_s/ref:24.701939093880355 - timing_s/adv:0.28520012693479657 - timing_s/update_actor:101.06529872864485 - timing_s/step:275.24547653924674 - timing_s/stop_profile:4.342198371887207e-05 - timing_per_token_ms/update_actor:0.05721071284832532 - timing_per_token_ms/ref:0.013983192669238743 - timing_per_token_ms/adv:0.00016144515250661408 - timing_per_token_ms/gen:0.0733015567090041 - perf/total_num_tokens:1766545 - perf/time_per_step:275.24547653924674 - perf/throughput:1604.5177401381486
[36m(TaskRunner pid=82921)[0m 
Training Progress:  36%|███▌      | 21/58 [2:36:03<4:51:08, 472.13s/it]
[36m(TaskRunner pid=82921)[0m step:22 - actor/entropy:1.063940167427063 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0001973886534472058) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.0020753376232960363) - actor/grad_norm:np.float64(0.14046195149421692) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(147.4314136505127) - actor/lr:np.float64(3e-06) - training/global_step:22 - training/epoch:0 - critic/score/mean:0.3173828125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.3173828125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.3017663359642029 - critic/advantages/max:2.537097692489624 - critic/advantages/min:-2.573406219482422 - critic/returns/mean:-0.3017663359642029 - critic/returns/max:2.537097692489624 - critic/returns/min:-2.573406219482422 - response_length/mean:1340.361328125 - response_length/max:4096.0 - response_length/min:101.0 - response_length/clip_ratio:0.1279296875 - response_length_non_aborted/mean:1340.361328125 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:101.0 - response_length_non_aborted/clip_ratio:0.1279296875 - response/aborted_ratio:0.0 - prompt_length/mean:142.6171875 - prompt_length/max:928.0 - prompt_length/min:76.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.399497553706169e-05 - timing_s/generate_sequences:95.9185562133789 - timing_s/generation_timing/max:99.54281616210938 - timing_s/generation_timing/min:92.8499984741211 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:107.58225517114624 - timing_s/reward:0.38265191204845905 - timing_s/old_log_prob:27.23365759663284 - timing_s/ref:21.60649738367647 - timing_s/adv:0.2830849699676037 - timing_s/update_actor:90.68562643276528 - timing_s/step:247.9889566898346 - timing_s/stop_profile:3.138696774840355e-05 - timing_per_token_ms/update_actor:0.05971777819446274 - timing_per_token_ms/ref:0.014228186638532613 - timing_per_token_ms/adv:0.00018641548955109326 - timing_per_token_ms/gen:0.078382443495695 - perf/total_num_tokens:1518570 - perf/time_per_step:247.9889566898346 - perf/throughput:1530.8847017523747
[36m(TaskRunner pid=82921)[0m 
Training Progress:  38%|███▊      | 22/58 [2:40:11<4:02:55, 404.89s/it]
[36m(TaskRunner pid=82921)[0m step:23 - actor/entropy:0.8225546479225159 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0002127104686593384) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.0017172429522318566) - actor/grad_norm:np.float64(0.13411545753479004) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(145.74898147583008) - actor/lr:np.float64(3e-06) - training/global_step:23 - training/epoch:0 - critic/score/mean:0.3662109375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.3662109375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.38789594173431396 - critic/advantages/max:2.574089527130127 - critic/advantages/min:-2.5698354244232178 - critic/returns/mean:-0.38789594173431396 - critic/returns/max:2.574089527130127 - critic/returns/min:-2.5698354244232178 - response_length/mean:1128.1630859375 - response_length/max:4096.0 - response_length/min:125.0 - response_length/clip_ratio:0.0830078125 - response_length_non_aborted/mean:1128.1630859375 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:125.0 - response_length_non_aborted/clip_ratio:0.0830078125 - response/aborted_ratio:0.0 - prompt_length/mean:147.7578125 - prompt_length/max:509.0 - prompt_length/min:74.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.8732850700616837e-05 - timing_s/generate_sequences:82.90383911132812 - timing_s/generation_timing/max:84.1393051147461 - timing_s/generation_timing/min:81.30484771728516 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:92.58276705490425 - timing_s/reward:0.41844079829752445 - timing_s/old_log_prob:25.37716075917706 - timing_s/ref:21.21418504230678 - timing_s/adv:0.2683238610625267 - timing_s/update_actor:81.16156397201121 - timing_s/step:221.23363874992356 - timing_s/stop_profile:4.395982250571251e-05 - timing_per_token_ms/update_actor:0.06211932096533464 - timing_per_token_ms/ref:0.016236882400584428 - timing_per_token_ms/adv:0.00020536933041050061 - timing_per_token_ms/gen:0.08014165644936178 - perf/total_num_tokens:1306543 - perf/time_per_step:221.23363874992356 - perf/throughput:1476.4289546817972
[36m(TaskRunner pid=82921)[0m 
Training Progress:  40%|███▉      | 23/58 [2:43:52<3:24:02, 349.79s/it]
[36m(TaskRunner pid=82921)[0m step:24 - actor/entropy:0.5789312720298767 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0002446248614091928) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.001057946832912826) - actor/grad_norm:np.float64(0.15437637269496918) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(156.89337921142578) - actor/lr:np.float64(3e-06) - training/global_step:24 - training/epoch:0 - critic/score/mean:0.435546875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.435546875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.2661244571208954 - critic/advantages/max:2.5731728076934814 - critic/advantages/min:-2.5743000507354736 - critic/returns/mean:-0.2661244571208954 - critic/returns/max:2.5731728076934814 - critic/returns/min:-2.5743000507354736 - response_length/mean:885.859375 - response_length/max:4096.0 - response_length/min:42.0 - response_length/clip_ratio:0.0439453125 - response_length_non_aborted/mean:885.859375 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:42.0 - response_length_non_aborted/clip_ratio:0.0439453125 - response/aborted_ratio:0.0 - prompt_length/mean:134.6171875 - prompt_length/max:582.0 - prompt_length/min:77.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.993705078959465e-05 - timing_s/generate_sequences:63.163970947265625 - timing_s/generation_timing/max:64.7078628540039 - timing_s/generation_timing/min:61.55589294433594 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:72.97572729596868 - timing_s/reward:0.35413569724187255 - timing_s/old_log_prob:21.914082552772015 - timing_s/ref:17.98808265896514 - timing_s/adv:0.2581625650636852 - timing_s/update_actor:72.85159887373447 - timing_s/step:186.54805025691167 - timing_s/stop_profile:4.2696017771959305e-05 - timing_per_token_ms/update_actor:0.06971658354488795 - timing_per_token_ms/ref:0.01721400335605027 - timing_per_token_ms/adv:0.00024705308206919753 - timing_per_token_ms/gen:0.08044771066228137 - perf/total_num_tokens:1044968 - perf/time_per_step:186.54805025691167 - perf/throughput:1400.400591913026
[36m(TaskRunner pid=82921)[0m 
Training Progress:  41%|████▏     | 24/58 [2:46:59<2:50:27, 300.82s/it]
[36m(TaskRunner pid=82921)[0m step:25 - actor/entropy:0.42276376485824585 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00025260005472205194) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.0006156061839579507) - actor/grad_norm:np.float64(0.15103967487812042) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(166.6722412109375) - actor/lr:np.float64(3e-06) - training/global_step:25 - training/epoch:0 - critic/score/mean:0.482421875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.482421875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.23998793959617615 - critic/advantages/max:2.573291301727295 - critic/advantages/min:-2.5537664890289307 - critic/returns/mean:-0.23998793959617615 - critic/returns/max:2.573291301727295 - critic/returns/min:-2.5537664890289307 - response_length/mean:794.2451171875 - response_length/max:4096.0 - response_length/min:99.0 - response_length/clip_ratio:0.029296875 - response_length_non_aborted/mean:794.2451171875 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:99.0 - response_length_non_aborted/clip_ratio:0.029296875 - response/aborted_ratio:0.0 - prompt_length/mean:143.953125 - prompt_length/max:862.0 - prompt_length/min:75.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.45547765493393e-05 - timing_s/generate_sequences:57.24696350097656 - timing_s/generation_timing/max:58.463497161865234 - timing_s/generation_timing/min:55.809268951416016 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:66.14460615906864 - timing_s/reward:0.2553339791484177 - timing_s/old_log_prob:21.456247196998447 - timing_s/ref:18.181598426774144 - timing_s/adv:0.2829649345949292 - timing_s/update_actor:73.66925836028531 - timing_s/step:180.18394741835073 - timing_s/stop_profile:3.813300281763077e-05 - timing_per_token_ms/update_actor:0.07668169890163609 - timing_per_token_ms/ref:0.018925069793616363 - timing_per_token_ms/adv:0.00029453577241422195 - timing_per_token_ms/gen:0.08132796860111698 - perf/total_num_tokens:960715 - perf/time_per_step:180.18394741835073 - perf/throughput:1332.9641926555946
[36m(TaskRunner pid=82921)[0m 
Training Progress:  43%|████▎     | 25/58 [2:49:59<2:25:33, 264.65s/it]
[36m(TaskRunner pid=82921)[0m step:26 - actor/entropy:0.41860929131507874 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00022863984408161286) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.0010570999005068415) - actor/grad_norm:np.float64(0.14749835431575775) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(153.56695747375488) - actor/lr:np.float64(3e-06) - training/global_step:26 - training/epoch:0 - critic/score/mean:0.4501953125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4501953125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.2784962058067322 - critic/advantages/max:2.5718352794647217 - critic/advantages/min:-2.5740134716033936 - critic/returns/mean:-0.2784962058067322 - critic/returns/max:2.5718352794647217 - critic/returns/min:-2.5740134716033936 - response_length/mean:866.576171875 - response_length/max:4096.0 - response_length/min:96.0 - response_length/clip_ratio:0.033203125 - response_length_non_aborted/mean:866.576171875 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:96.0 - response_length_non_aborted/clip_ratio:0.033203125 - response/aborted_ratio:0.0 - prompt_length/mean:139.4765625 - prompt_length/max:766.0 - prompt_length/min:76.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.0001483634114265442 - timing_s/generate_sequences:65.86735534667969 - timing_s/generation_timing/max:68.07942199707031 - timing_s/generation_timing/min:63.592830657958984 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:77.44176302989945 - timing_s/reward:0.27010704204440117 - timing_s/old_log_prob:21.652320528868586 - timing_s/ref:18.878440744243562 - timing_s/adv:0.20629271073266864 - timing_s/update_actor:74.80569016095251 - timing_s/step:193.43864340428263 - timing_s/stop_profile:3.4085940569639206e-05 - timing_per_token_ms/update_actor:0.07261292505028404 - timing_per_token_ms/ref:0.018325060565292848 - timing_per_token_ms/adv:0.00020024569134541965 - timing_per_token_ms/gen:0.08727071452386417 - perf/total_num_tokens:1030198 - perf/time_per_step:193.43864340428263 - perf/throughput:1331.427348059545
[36m(TaskRunner pid=82921)[0m 
Training Progress:  45%|████▍     | 26/58 [2:53:13<2:09:46, 243.31s/it]
[36m(TaskRunner pid=82921)[0m step:27 - actor/entropy:0.30794668197631836 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00022962539779314284) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.0013850519606251055) - actor/grad_norm:np.float64(0.15244068205356598) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(145.89509201049805) - actor/lr:np.float64(3e-06) - training/global_step:27 - training/epoch:0 - critic/score/mean:0.40234375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.40234375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.267761766910553 - critic/advantages/max:2.5744240283966064 - critic/advantages/min:-2.5743558406829834 - critic/returns/mean:-0.267761766910553 - critic/returns/max:2.5744240283966064 - critic/returns/min:-2.5743558406829834 - response_length/mean:848.03125 - response_length/max:4096.0 - response_length/min:89.0 - response_length/clip_ratio:0.0263671875 - response_length_non_aborted/mean:848.03125 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:89.0 - response_length_non_aborted/clip_ratio:0.0263671875 - response/aborted_ratio:0.0 - prompt_length/mean:136.015625 - prompt_length/max:904.0 - prompt_length/min:76.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.7492176741361618e-05 - timing_s/generate_sequences:61.40519332885742 - timing_s/generation_timing/max:65.60549926757812 - timing_s/generation_timing/min:56.90545654296875 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:74.99112380295992 - timing_s/reward:0.3471638518385589 - timing_s/old_log_prob:22.337067818734795 - timing_s/ref:17.968444372992963 - timing_s/adv:0.2168302470818162 - timing_s/update_actor:71.47145092533901 - timing_s/step:187.5542905521579 - timing_s/stop_profile:4.292186349630356e-05 - timing_per_token_ms/update_actor:0.07092785980777225 - timing_per_token_ms/ref:0.01783178159881961 - timing_per_token_ms/adv:0.0002151810991380224 - timing_per_token_ms/gen:0.08635709985785081 - perf/total_num_tokens:1007664 - perf/time_per_step:187.5542905521579 - perf/throughput:1343.163087649778
[36m(TaskRunner pid=82921)[0m 
Training Progress:  47%|████▋     | 27/58 [2:56:20<1:57:04, 226.60s/it]
[36m(TaskRunner pid=82921)[0m step:28 - actor/entropy:0.31323766708374023 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0002424099811690894) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.0011156010216926138) - actor/grad_norm:np.float64(0.14168642461299896) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(144.46658515930176) - actor/lr:np.float64(3e-06) - training/global_step:28 - training/epoch:0 - critic/score/mean:0.4189453125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4189453125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.19689010083675385 - critic/advantages/max:2.5106635093688965 - critic/advantages/min:-2.573352336883545 - critic/returns/mean:-0.19689010083675385 - critic/returns/max:2.5106635093688965 - critic/returns/min:-2.573352336883545 - response_length/mean:833.8720703125 - response_length/max:4096.0 - response_length/min:59.0 - response_length/clip_ratio:0.02734375 - response_length_non_aborted/mean:833.8720703125 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:59.0 - response_length_non_aborted/clip_ratio:0.02734375 - response/aborted_ratio:0.0 - prompt_length/mean:145.0390625 - prompt_length/max:764.0 - prompt_length/min:77.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.157788887619972e-05 - timing_s/generate_sequences:61.5786018371582 - timing_s/generation_timing/max:63.78325271606445 - timing_s/generation_timing/min:59.39891052246094 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:71.5998633671552 - timing_s/reward:0.34074777318164706 - timing_s/old_log_prob:22.84946663910523 - timing_s/ref:17.362039220985025 - timing_s/adv:0.25870582833886147 - timing_s/update_actor:72.5623885160312 - timing_s/step:185.1995957819745 - timing_s/stop_profile:4.3044332414865494e-05 - timing_per_token_ms/update_actor:0.07238829466735622 - timing_per_token_ms/ref:0.017320383698190875 - timing_per_token_ms/adv:0.0002580851335925713 - timing_per_token_ms/gen:0.08385188095253482 - perf/total_num_tokens:1002405 - perf/time_per_step:185.1995957819745 - perf/throughput:1353.1414522903135
[36m(TaskRunner pid=82921)[0m 
Training Progress:  48%|████▊     | 28/58 [2:59:26<1:47:06, 214.21s/it]
[36m(TaskRunner pid=82921)[0m step:29 - actor/entropy:0.2994789481163025 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0002654316875236873) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.00038608747452784087) - actor/grad_norm:np.float64(0.1453941911458969) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(145.42541885375977) - actor/lr:np.float64(3e-06) - training/global_step:29 - training/epoch:0 - critic/score/mean:0.494140625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.494140625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.21883106231689453 - critic/advantages/max:2.572049617767334 - critic/advantages/min:-2.57373309135437 - critic/returns/mean:-0.21883106231689453 - critic/returns/max:2.572049617767334 - critic/returns/min:-2.57373309135437 - response_length/mean:731.8828125 - response_length/max:4096.0 - response_length/min:83.0 - response_length/clip_ratio:0.0185546875 - response_length_non_aborted/mean:731.8828125 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:83.0 - response_length_non_aborted/clip_ratio:0.0185546875 - response/aborted_ratio:0.0 - prompt_length/mean:123.9296875 - prompt_length/max:454.0 - prompt_length/min:77.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.107179120182991e-05 - timing_s/generate_sequences:54.16901397705078 - timing_s/generation_timing/max:54.850833892822266 - timing_s/generation_timing/min:53.67631530761719 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:62.361144815105945 - timing_s/reward:0.2312326217070222 - timing_s/old_log_prob:19.57613639300689 - timing_s/ref:16.647979994304478 - timing_s/adv:0.2559491638094187 - timing_s/update_actor:67.80752238677815 - timing_s/step:167.05040028691292 - timing_s/stop_profile:3.438210114836693e-05 - timing_per_token_ms/update_actor:0.07737475624723644 - timing_per_token_ms/ref:0.018996909910976956 - timing_per_token_ms/adv:0.00029206205247368484 - timing_per_token_ms/gen:0.08320943523113804 - perf/total_num_tokens:876352 - perf/time_per_step:167.05040028691292 - perf/throughput:1311.5083808462075
[36m(TaskRunner pid=82921)[0m 
Training Progress:  50%|█████     | 29/58 [3:02:13<1:36:42, 200.07s/it]
[36m(TaskRunner pid=82921)[0m test_gen_batch meta info: {'eos_token_id': 151643, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 30}
[36m(TaskRunner pid=82921)[0m validation generation end
[36m(TaskRunner pid=82921)[0m [prompt] system
[36m(TaskRunner pid=82921)[0m You are a helpful AI Assistant, designed to provide well-reasoned and detailed responses. You FIRST think about the reasoning process step by step and then provide the user with the answer. Please enclose your final answer in the box: \boxed{Your Answer}.
[36m(TaskRunner pid=82921)[0m user
[36m(TaskRunner pid=82921)[0m Bin $A$ has one white ball and four black balls.  Bin $B$ has three balls labeled $\$1$ and one ball labeled $\$7$.  Bin $W$ has five balls labeled $\$8$ and one ball labeled $\$500$.  A game is played as follows: a ball is randomly selected from bin $A$.  If it is black, then a ball is randomly selected from bin $B$; otherwise, if the original ball is white, then a ball is randomly selected from bin $W$.  You win the amount printed on the second ball selected.  What is your expected win?
[36m(TaskRunner pid=82921)[0m assistant
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m [response] To determine the expected win in this game, we need to consider the probabilities of each scenario and the corresponding winnings. Let's break it down step by step.
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m ### Step 1: Probability of selecting a black ball from bin \( A \)
[36m(TaskRunner pid=82921)[0m Bin \( A \) has 1 white ball and 4 black balls. Therefore, the probability of selecting a black ball from bin \( A \) is:
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m P(\text{Black from } A) = \frac{4}{5}
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m ### Step 2: Probability of selecting a white ball from bin \( A \)
[36m(TaskRunner pid=82921)[0m The probability of selecting a white ball from bin \( A \) is:
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m P(\text{White from } A) = \frac{1}{5}
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m ### Step 3: Probability of selecting a ball from bin \( B \) given a black ball from bin \( A \)
[36m(TaskRunner pid=82921)[0m If a black ball is selected from bin \( A \), a ball is randomly selected from bin \( B \). Bin \( B \) has 3 balls labeled \$1 and 1 ball labeled \$7. Therefore, the probability of selecting a ball from bin \( B \) is:
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m P(\text{Ball from } B \mid \text{Black from } A) = \frac{3}{4}
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m ### Step 4: Probability of selecting a ball from bin \( W \) given a white ball from bin \( A \)
[36m(TaskRunner pid=82921)[0m If a white ball is selected from bin \( A \), a ball is randomly selected from bin \( W \). Bin \( W \) has 5 balls labeled \$8 and 1 ball labeled \$500. Therefore, the probability of selecting a ball from bin \( W \) is:
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m P(\text{Ball from } W \mid \text{White from } A) = \frac{5}{6}
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m ### Step 5: Expected win calculation
[36m(TaskRunner pid=82921)[0m The expected win \( E \) can be calculated by considering the probabilities of each scenario and the corresponding winnings:
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m E = P(\text{Black from } A) \times P(\text{Ball from } B \mid \text{Black from } A) \times \text{Winnings from } B + P(\text{White from } A) \times P(\text{Ball from } W \mid \text{White from } A) \times \text{Winnings from } W
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Substituting the values we have:
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m E = \left( \frac{4}{5} \right) \times \left( \frac{3}{4} \right) \times 1 + \left( \frac{1}{5} \right) \times \left( \frac{5}{6} \right) \times 7
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m ### Step 6: Simplify the expression
[36m(TaskRunner pid=82921)[0m First, calculate the individual terms:
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m \left( \frac{4}{5} \right) \times \left( \frac{3}{4} \right) = \frac{12}{20} = \frac{3}{5}
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m \left( \frac{1}{5} \right) \times \left( \frac{5}{6} \right) = \frac{5}{30} = \frac{1}{6}
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Next, multiply these results by the winnings:
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m \frac{3}{5} \times 1 = \frac{3}{5}
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m \frac{1}{6} \times 7 = \frac{7}{6}
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Finally, add these results together:
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m E = \frac{3}{5} + \frac{7}{6}
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m To add these fractions, find a common denominator. The least common multiple of 5 and 6 is 30:
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m \frac{3}{5} = \frac{3 \times 6}{5 \times 6} = \frac{18}{30}
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m \frac{7}{6} = \frac{7 \times 5}{6 \times 5} = \frac{35}{30}
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Now add the fractions:
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m E = \frac{18}{30} + \frac{35}{30} = \frac{53}{30}
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Thus, the expected win is:
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m \boxed{\frac{53}{30}}
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m [ground_truth] \$20
[36m(TaskRunner pid=82921)[0m [score] 0.0
[36m(TaskRunner pid=82921)[0m local_global_step_folder: /workspace/verl_exp/ckpts/CGPO/CGPO-Qwen2.5-1.5B/global_step_30
[36m(WorkerDict pid=84123)[0m INFO:2025-12-27 23:40:55,060:[Rank 0] Saved model to /workspace/verl_exp/ckpts/CGPO/CGPO-Qwen2.5-1.5B/global_step_30/actor/model_world_size_4_rank_0.pt
[36m(WorkerDict pid=84123)[0m INFO:2025-12-27 23:41:41,609:[Rank 0] Saved optim to /workspace/verl_exp/ckpts/CGPO/CGPO-Qwen2.5-1.5B/global_step_30/actor/optim_world_size_4_rank_0.pt
[36m(WorkerDict pid=84123)[0m INFO:2025-12-27 23:41:41,611:[Rank 0] Saved extra_state to /workspace/verl_exp/ckpts/CGPO/CGPO-Qwen2.5-1.5B/global_step_30/actor/extra_state_world_size_4_rank_0.pt
[36m(WorkerDict pid=84124)[0m INFO:2025-12-27 23:40:55,529:[Rank 1] Saved model to /workspace/verl_exp/ckpts/CGPO/CGPO-Qwen2.5-1.5B/global_step_30/actor/model_world_size_4_rank_1.pt[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=84123)[0m INFO:2025-12-27 23:41:43,227:[Rank 0] Saved model config and tokenizer class to /workspace/verl_exp/ckpts/CGPO/CGPO-Qwen2.5-1.5B/global_step_30/actor/huggingface
[36m(TaskRunner pid=82921)[0m step:30 - actor/entropy:0.28513142466545105 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00023798748240722034) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.001049602209423739) - actor/grad_norm:np.float64(0.13345451653003693) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(133.95515823364258) - actor/lr:np.float64(3e-06) - val-core/DigitalLearningGmbH/MATH-lighteval/reward/mean@1:np.float64(0.5294117647058824) - training/global_step:30 - training/epoch:0 - critic/score/mean:0.41796875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.41796875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.23874816298484802 - critic/advantages/max:2.5732107162475586 - critic/advantages/min:-2.5742738246917725 - critic/returns/mean:-0.23874816298484802 - critic/returns/max:2.5732107162475586 - critic/returns/min:-2.5742738246917725 - response_length/mean:858.9697265625 - response_length/max:4096.0 - response_length/min:94.0 - response_length/clip_ratio:0.02734375 - response_length_non_aborted/mean:858.9697265625 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:94.0 - response_length_non_aborted/clip_ratio:0.02734375 - response/aborted_ratio:0.0 - prompt_length/mean:146.109375 - prompt_length/max:957.0 - prompt_length/min:74.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.435275569558144e-05 - timing_s/generate_sequences:60.51436996459961 - timing_s/generation_timing/max:62.67173385620117 - timing_s/generation_timing/min:58.323997497558594 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:70.25928238593042 - timing_s/reward:0.33530145697295666 - timing_s/old_log_prob:21.228474353905767 - timing_s/ref:17.94540339615196 - timing_s/adv:0.2571534947492182 - timing_s/update_actor:73.28948018280789 - timing_s/step:183.53221495077014 - timing_s/testing:299.8644200968556 - timing_s/save_checkpoint:55.05158631457016 - timing_s/stop_profile:5.540437996387482e-05 - timing_per_token_ms/update_actor:0.0712100747888973 - timing_per_token_ms/ref:0.01743624753197088 - timing_per_token_ms/adv:0.00024985740856180497 - timing_per_token_ms/gen:0.07987776324736144 - perf/total_num_tokens:1029201 - perf/time_per_step:183.53221495077014 - perf/throughput:1401.935077550375
[36m(TaskRunner pid=82921)[0m 
Training Progress:  52%|█████▏    | 30/58 [3:11:11<2:20:46, 301.66s/it]
[36m(TaskRunner pid=82921)[0m step:31 - actor/entropy:0.26544472575187683 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0002655473343651238) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.0007502681346007734) - actor/grad_norm:np.float64(0.14639605581760406) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(149.49664306640625) - actor/lr:np.float64(3e-06) - training/global_step:31 - training/epoch:0 - critic/score/mean:0.4658203125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4658203125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.22967375814914703 - critic/advantages/max:2.57004976272583 - critic/advantages/min:-2.571255683898926 - critic/returns/mean:-0.22967375814914703 - critic/returns/max:2.57004976272583 - critic/returns/min:-2.571255683898926 - response_length/mean:766.26953125 - response_length/max:4096.0 - response_length/min:91.0 - response_length/clip_ratio:0.0224609375 - response_length_non_aborted/mean:766.26953125 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:91.0 - response_length_non_aborted/clip_ratio:0.0224609375 - response/aborted_ratio:0.0 - prompt_length/mean:136.140625 - prompt_length/max:541.0 - prompt_length/min:77.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.301685839891434e-05 - timing_s/generate_sequences:59.90690612792969 - timing_s/generation_timing/max:61.8626594543457 - timing_s/generation_timing/min:57.71449279785156 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:69.62248496664688 - timing_s/reward:0.29427948500961065 - timing_s/old_log_prob:21.437954775057733 - timing_s/ref:17.14246739912778 - timing_s/adv:0.2801615707576275 - timing_s/update_actor:68.55362502299249 - timing_s/step:177.59159157704562 - timing_s/stop_profile:5.088699981570244e-05 - timing_per_token_ms/update_actor:0.07418677524055858 - timing_per_token_ms/ref:0.01855108866352669 - timing_per_token_ms/adv:0.00030318285099973974 - timing_per_token_ms/gen:0.08872949426075864 - perf/total_num_tokens:924068 - perf/time_per_step:177.59159157704562 - perf/throughput:1300.8329839747876
[36m(TaskRunner pid=82921)[0m 
Training Progress:  53%|█████▎    | 31/58 [3:14:10<1:59:04, 264.61s/it]
[36m(WorkerDict pid=84124)[0m INFO:2025-12-27 23:41:44,784:[Rank 1] Saved optim to /workspace/verl_exp/ckpts/CGPO/CGPO-Qwen2.5-1.5B/global_step_30/actor/optim_world_size_4_rank_1.pt[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=84124)[0m INFO:2025-12-27 23:41:44,786:[Rank 1] Saved extra_state to /workspace/verl_exp/ckpts/CGPO/CGPO-Qwen2.5-1.5B/global_step_30/actor/extra_state_world_size_4_rank_1.pt[32m [repeated 3x across cluster][0m
[36m(TaskRunner pid=82921)[0m step:32 - actor/entropy:0.24326683580875397 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00025784635005265955) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.0007030300764654385) - actor/grad_norm:np.float64(0.13753066956996918) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(141.9884548187256) - actor/lr:np.float64(3e-06) - training/global_step:32 - training/epoch:0 - critic/score/mean:0.47265625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.47265625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.1895260512828827 - critic/advantages/max:2.5429186820983887 - critic/advantages/min:-2.5708694458007812 - critic/returns/mean:-0.1895260512828827 - critic/returns/max:2.5429186820983887 - critic/returns/min:-2.5708694458007812 - response_length/mean:769.2216796875 - response_length/max:4096.0 - response_length/min:77.0 - response_length/clip_ratio:0.0166015625 - response_length_non_aborted/mean:769.2216796875 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:77.0 - response_length_non_aborted/clip_ratio:0.0166015625 - response/aborted_ratio:0.0 - prompt_length/mean:141.0078125 - prompt_length/max:866.0 - prompt_length/min:75.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.029801443219185e-05 - timing_s/generate_sequences:60.10550308227539 - timing_s/generation_timing/max:60.47264862060547 - timing_s/generation_timing/min:59.63541793823242 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:68.88075350690633 - timing_s/reward:0.24635619390755892 - timing_s/old_log_prob:21.56774762412533 - timing_s/ref:17.21089386101812 - timing_s/adv:0.2032666471786797 - timing_s/update_actor:68.20811472274363 - timing_s/step:176.499967077747 - timing_s/stop_profile:5.826307460665703e-05 - timing_per_token_ms/update_actor:0.07317878359868425 - timing_per_token_ms/ref:0.01846513838587895 - timing_per_token_ms/adv:0.0002180797115883161 - timing_per_token_ms/gen:0.08744730241341546 - perf/total_num_tokens:932075 - perf/time_per_step:176.499967077747 - perf/throughput:1320.2197930006237
[36m(TaskRunner pid=82921)[0m 
Training Progress:  55%|█████▌    | 32/58 [3:17:06<1:43:13, 238.20s/it]
[36m(TaskRunner pid=82921)[0m step:33 - actor/entropy:0.23594342172145844 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0002602992609439525) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.0007444233656102028) - actor/grad_norm:np.float64(0.14380939304828644) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(136.5311737060547) - actor/lr:np.float64(3e-06) - training/global_step:33 - training/epoch:0 - critic/score/mean:0.4482421875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4482421875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.1376965045928955 - critic/advantages/max:2.5720674991607666 - critic/advantages/min:-2.550915241241455 - critic/returns/mean:-0.1376965045928955 - critic/returns/max:2.5720674991607666 - critic/returns/min:-2.550915241241455 - response_length/mean:773.8916015625 - response_length/max:4096.0 - response_length/min:163.0 - response_length/clip_ratio:0.01171875 - response_length_non_aborted/mean:773.8916015625 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:163.0 - response_length_non_aborted/clip_ratio:0.01171875 - response/aborted_ratio:0.0 - prompt_length/mean:141.59375 - prompt_length/max:888.0 - prompt_length/min:78.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.007597014307976e-05 - timing_s/generate_sequences:57.193294525146484 - timing_s/generation_timing/max:59.28245544433594 - timing_s/generation_timing/min:55.128929138183594 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:68.42172795208171 - timing_s/reward:0.24068251298740506 - timing_s/old_log_prob:21.37533103302121 - timing_s/ref:18.38337734574452 - timing_s/adv:0.2778083998709917 - timing_s/update_actor:71.30903153307736 - timing_s/step:180.18662334186956 - timing_s/stop_profile:4.260474815964699e-05 - timing_per_token_ms/update_actor:0.07606645588339236 - timing_per_token_ms/ref:0.019609835273238688 - timing_per_token_ms/adv:0.0002963425521074478 - timing_per_token_ms/gen:0.08634037837895896 - perf/total_num_tokens:937457 - perf/time_per_step:180.18662334186956 - perf/throughput:1300.6750759480008
[36m(TaskRunner pid=82921)[0m 
Training Progress:  57%|█████▋    | 33/58 [3:20:06<1:32:00, 220.81s/it]
[36m(TaskRunner pid=82921)[0m step:34 - actor/entropy:0.23228825628757477 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0002474021898422052) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.0013171431138729872) - actor/grad_norm:np.float64(0.1426309049129486) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(143.90471935272217) - actor/lr:np.float64(3e-06) - training/global_step:34 - training/epoch:0 - critic/score/mean:0.3974609375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.3974609375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.24748003482818604 - critic/advantages/max:2.570937395095825 - critic/advantages/min:-2.5723860263824463 - critic/returns/mean:-0.24748003482818604 - critic/returns/max:2.570937395095825 - critic/returns/min:-2.5723860263824463 - response_length/mean:827.62109375 - response_length/max:4096.0 - response_length/min:107.0 - response_length/clip_ratio:0.0185546875 - response_length_non_aborted/mean:827.62109375 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:107.0 - response_length_non_aborted/clip_ratio:0.0185546875 - response/aborted_ratio:0.0 - prompt_length/mean:140.703125 - prompt_length/max:507.0 - prompt_length/min:78.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.019432425498962e-05 - timing_s/generate_sequences:58.28755569458008 - timing_s/generation_timing/max:60.154754638671875 - timing_s/generation_timing/min:56.9064826965332 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:68.60753075219691 - timing_s/reward:0.33843650203198195 - timing_s/old_log_prob:23.187174186110497 - timing_s/ref:17.615508466027677 - timing_s/adv:0.2037704298272729 - timing_s/update_actor:69.32692271983251 - timing_s/step:179.49638933083043 - timing_s/stop_profile:5.1223207265138626e-05 - timing_per_token_ms/update_actor:0.06991674034135216 - timing_per_token_ms/ref:0.017765377187985522 - timing_per_token_ms/adv:0.0002055040620951072 - timing_per_token_ms/gen:0.08095436698769169 - perf/total_num_tokens:991564 - perf/time_per_step:179.49638933083043 - perf/throughput:1381.0361362930328
[36m(TaskRunner pid=82921)[0m 
Training Progress:  59%|█████▊    | 34/58 [3:23:06<1:23:22, 208.45s/it]
[36m(TaskRunner pid=82921)[0m step:35 - actor/entropy:0.222276508808136 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00025969853349749883) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.000625227010299767) - actor/grad_norm:np.float64(0.1429150402545929) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(150.94035243988037) - actor/lr:np.float64(3e-06) - training/global_step:35 - training/epoch:0 - critic/score/mean:0.4873046875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4873046875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.16098016500473022 - critic/advantages/max:2.5300099849700928 - critic/advantages/min:-2.5702593326568604 - critic/returns/mean:-0.16098016500473022 - critic/returns/max:2.5300099849700928 - critic/returns/min:-2.5702593326568604 - response_length/mean:763.37109375 - response_length/max:4096.0 - response_length/min:130.0 - response_length/clip_ratio:0.0146484375 - response_length_non_aborted/mean:763.37109375 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:130.0 - response_length_non_aborted/clip_ratio:0.0146484375 - response/aborted_ratio:0.0 - prompt_length/mean:147.4296875 - prompt_length/max:612.0 - prompt_length/min:78.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.979735240340233e-05 - timing_s/generate_sequences:55.21821594238281 - timing_s/generation_timing/max:55.48497772216797 - timing_s/generation_timing/min:54.8808479309082 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:63.932921529281884 - timing_s/reward:0.31983482791110873 - timing_s/old_log_prob:19.496838157996535 - timing_s/ref:17.03394804522395 - timing_s/adv:0.2611514120362699 - timing_s/update_actor:70.13436962198466 - timing_s/step:171.4284027768299 - timing_s/stop_profile:8.333614096045494e-05 - timing_per_token_ms/update_actor:0.07519821759481983 - timing_per_token_ms/ref:0.018263834672039063 - timing_per_token_ms/adv:0.0002800070894390988 - timing_per_token_ms/gen:0.08178786725370335 - perf/total_num_tokens:932660 - perf/time_per_step:171.4284027768299 - perf/throughput:1360.1305047655403
[36m(TaskRunner pid=82921)[0m 
Training Progress:  60%|██████    | 35/58 [3:25:58<1:15:39, 197.36s/it]
[36m(TaskRunner pid=82921)[0m step:36 - actor/entropy:0.2671400010585785 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00025850463381971167) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.0004130252444038973) - actor/grad_norm:np.float64(0.14056049287319183) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(163.14092636108398) - actor/lr:np.float64(3e-06) - training/global_step:36 - training/epoch:0 - critic/score/mean:0.4833984375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4833984375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.1530338078737259 - critic/advantages/max:2.574681282043457 - critic/advantages/min:-2.5723330974578857 - critic/returns/mean:-0.1530338078737259 - critic/returns/max:2.574681282043457 - critic/returns/min:-2.5723330974578857 - response_length/mean:771.2119140625 - response_length/max:4096.0 - response_length/min:70.0 - response_length/clip_ratio:0.0146484375 - response_length_non_aborted/mean:771.2119140625 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:70.0 - response_length_non_aborted/clip_ratio:0.0146484375 - response/aborted_ratio:0.0 - prompt_length/mean:138.96875 - prompt_length/max:744.0 - prompt_length/min:74.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.017120227217674e-05 - timing_s/generate_sequences:57.73490524291992 - timing_s/generation_timing/max:58.955562591552734 - timing_s/generation_timing/min:57.111995697021484 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:67.7503520147875 - timing_s/reward:0.31892093224450946 - timing_s/old_log_prob:20.20839376980439 - timing_s/ref:17.066908000968397 - timing_s/adv:0.26806331472471356 - timing_s/update_actor:69.36266928631812 - timing_s/step:175.18393165199086 - timing_s/stop_profile:4.1536055505275726e-05 - timing_per_token_ms/update_actor:0.07442146861545358 - timing_per_token_ms/ref:0.01831164185613948 - timing_per_token_ms/adv:0.00028761386735840085 - timing_per_token_ms/gen:0.08579023733038313 - perf/total_num_tokens:932025 - perf/time_per_step:175.18393165199086 - perf/throughput:1330.0663354380883
[36m(TaskRunner pid=82921)[0m 
Training Progress:  62%|██████▏   | 36/58 [3:28:53<1:09:55, 190.73s/it]
[36m(TaskRunner pid=82921)[0m step:37 - actor/entropy:0.1945866346359253 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0002519861106833332) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.000713323350107764) - actor/grad_norm:np.float64(0.13888169825077057) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(150.61836433410645) - actor/lr:np.float64(3e-06) - training/global_step:37 - training/epoch:0 - critic/score/mean:0.466796875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.466796875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.17572171986103058 - critic/advantages/max:2.5211241245269775 - critic/advantages/min:-2.571357488632202 - critic/returns/mean:-0.17572171986103058 - critic/returns/max:2.5211241245269775 - critic/returns/min:-2.571357488632202 - response_length/mean:792.046875 - response_length/max:4096.0 - response_length/min:162.0 - response_length/clip_ratio:0.0166015625 - response_length_non_aborted/mean:792.046875 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:162.0 - response_length_non_aborted/clip_ratio:0.0166015625 - response/aborted_ratio:0.0 - prompt_length/mean:138.84375 - prompt_length/max:659.0 - prompt_length/min:79.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.824623465538025e-05 - timing_s/generate_sequences:60.644569396972656 - timing_s/generation_timing/max:63.27025604248047 - timing_s/generation_timing/min:57.901405334472656 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:72.35605547390878 - timing_s/reward:0.319878906942904 - timing_s/old_log_prob:22.77012827200815 - timing_s/ref:17.87616865383461 - timing_s/adv:0.2048669452778995 - timing_s/update_actor:71.54710079636425 - timing_s/step:185.33518755016848 - timing_s/stop_profile:3.2786745578050613e-05 - timing_per_token_ms/update_actor:0.07505738455734202 - timing_per_token_ms/ref:0.018753219209840428 - timing_per_token_ms/adv:0.00021491824160109973 - timing_per_token_ms/gen:0.08921215732811148 - perf/total_num_tokens:953232 - perf/time_per_step:185.33518755016848 - perf/throughput:1285.8216680277849
[36m(TaskRunner pid=82921)[0m 
Training Progress:  64%|██████▍   | 37/58 [3:31:58<1:06:11, 189.13s/it]
[36m(TaskRunner pid=82921)[0m step:38 - actor/entropy:0.268371045589447 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00026249280452361745) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.0006101996543661503) - actor/grad_norm:np.float64(0.1473093330860138) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(138.03936767578125) - actor/lr:np.float64(3e-06) - training/global_step:38 - training/epoch:0 - critic/score/mean:0.46875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.46875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.2105608433485031 - critic/advantages/max:2.567416191101074 - critic/advantages/min:-2.569117307662964 - critic/returns/mean:-0.2105608433485031 - critic/returns/max:2.567416191101074 - critic/returns/min:-2.569117307662964 - response_length/mean:812.9521484375 - response_length/max:4096.0 - response_length/min:157.0 - response_length/clip_ratio:0.0205078125 - response_length_non_aborted/mean:812.9521484375 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:157.0 - response_length_non_aborted/clip_ratio:0.0205078125 - response/aborted_ratio:0.0 - prompt_length/mean:144.4453125 - prompt_length/max:908.0 - prompt_length/min:76.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.267032146453857e-05 - timing_s/generate_sequences:61.17196273803711 - timing_s/generation_timing/max:64.11162567138672 - timing_s/generation_timing/min:57.98333740234375 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:72.56338351778686 - timing_s/reward:0.26883613504469395 - timing_s/old_log_prob:22.699627447873354 - timing_s/ref:17.782277701888233 - timing_s/adv:0.28607478411868215 - timing_s/update_actor:70.23640387086198 - timing_s/step:184.02337760990486 - timing_s/stop_profile:4.4294167309999466e-05 - timing_per_token_ms/update_actor:0.07164238569002879 - timing_per_token_ms/ref:0.018138240675137814 - timing_per_token_ms/adv:0.00029180138632531647 - timing_per_token_ms/gen:0.08716709753801294 - perf/total_num_tokens:980375 - perf/time_per_step:184.02337760990486 - perf/throughput:1331.862033961538
[36m(TaskRunner pid=82921)[0m 
Training Progress:  66%|██████▌   | 38/58 [3:35:02<1:02:32, 187.63s/it]
[36m(TaskRunner pid=82921)[0m step:39 - actor/entropy:0.20727558434009552 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0002502880280701447) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.0006598187158175506) - actor/grad_norm:np.float64(0.15215298533439636) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(144.44195175170898) - actor/lr:np.float64(3e-06) - training/global_step:39 - training/epoch:0 - critic/score/mean:0.46875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.46875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.15205545723438263 - critic/advantages/max:2.509448289871216 - critic/advantages/min:-2.570037603378296 - critic/returns/mean:-0.15205545723438263 - critic/returns/max:2.509448289871216 - critic/returns/min:-2.570037603378296 - response_length/mean:753.6708984375 - response_length/max:4096.0 - response_length/min:143.0 - response_length/clip_ratio:0.009765625 - response_length_non_aborted/mean:753.6708984375 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:143.0 - response_length_non_aborted/clip_ratio:0.009765625 - response/aborted_ratio:0.0 - prompt_length/mean:130.703125 - prompt_length/max:705.0 - prompt_length/min:77.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.8325320929288864e-05 - timing_s/generate_sequences:55.18526077270508 - timing_s/generation_timing/max:55.53847122192383 - timing_s/generation_timing/min:54.73134994506836 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:63.271130614914 - timing_s/reward:0.23764254292473197 - timing_s/old_log_prob:19.692035870160908 - timing_s/ref:17.15965748997405 - timing_s/adv:0.25764859933406115 - timing_s/update_actor:67.36410008696839 - timing_s/step:168.16127817099914 - timing_s/stop_profile:4.580290988087654e-05 - timing_per_token_ms/update_actor:0.07438623506316636 - timing_per_token_ms/ref:0.01894840596110867 - timing_per_token_ms/adv:0.000284506276325461 - timing_per_token_ms/gen:0.081983016219978 - perf/total_num_tokens:905599 - perf/time_per_step:168.16127817099914 - perf/throughput:1346.3251020831299
[36m(TaskRunner pid=82921)[0m 
Training Progress:  67%|██████▋   | 39/58 [3:37:51<57:34, 181.80s/it]  
[36m(TaskRunner pid=82921)[0m test_gen_batch meta info: {'eos_token_id': 151643, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 40}
[36m(TaskRunner pid=82921)[0m validation generation end
[36m(TaskRunner pid=82921)[0m [prompt] system
[36m(TaskRunner pid=82921)[0m You are a helpful AI Assistant, designed to provide well-reasoned and detailed responses. You FIRST think about the reasoning process step by step and then provide the user with the answer. Please enclose your final answer in the box: \boxed{Your Answer}.
[36m(TaskRunner pid=82921)[0m user
[36m(TaskRunner pid=82921)[0m Bin $A$ has one white ball and four black balls.  Bin $B$ has three balls labeled $\$1$ and one ball labeled $\$7$.  Bin $W$ has five balls labeled $\$8$ and one ball labeled $\$500$.  A game is played as follows: a ball is randomly selected from bin $A$.  If it is black, then a ball is randomly selected from bin $B$; otherwise, if the original ball is white, then a ball is randomly selected from bin $W$.  You win the amount printed on the second ball selected.  What is your expected win?
[36m(TaskRunner pid=82921)[0m assistant
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m [response] To determine the expected win in this game, we need to calculate the expected value of the winnings based on the probabilities of selecting each type of ball from bins A and B, and the corresponding winnings.
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m First, let's calculate the probability of selecting a black ball from bin A. Since bin A has one white ball and four black balls, the probability of selecting a black ball is:
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m P(\text{Black from A}) = \frac{4}{5}
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m If a black ball is selected from bin A, then a ball is randomly selected from bin B. Bin B has three balls labeled \$1 and one ball labeled \$7. The probability of selecting a ball labeled \$1 from bin B is:
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m P(\$1 from B | Black from A) = \frac{3}{4}
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m The probability of selecting a ball labeled \$7 from bin B is:
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m P(\$7 from B | Black from A) = \frac{1}{4}
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m The expected value of the winnings if a black ball is selected from bin A is:
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m E(\text{Winnings} | \text{Black from A}) = \$1 \cdot \frac{3}{4} + \$7 \cdot \frac{1}{4} = \frac{3}{4} + \frac{7}{4} = \$5
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m Next, let's calculate the probability of selecting a white ball from bin A. Since bin A has one white ball and four black balls, the probability of selecting a white ball is:
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m P(\text{White from A}) = \frac{1}{5}
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m If a white ball is selected from bin A, then a ball is randomly selected from bin W. Bin W has five balls labeled \$8 and one ball labeled \$500. The probability of selecting a ball labeled \$8 from bin W is:
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m P(\$8 from W | White from A) = \frac{5}{6}
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m The probability of selecting a ball labeled \$500 from bin W is:
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m P(\$500 from W | White from A) = \frac{1}{6}
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m The expected value of the winnings if a white ball is selected from bin A is:
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m E(\text{Winnings} | \text{White from A}) = \$8 \cdot \frac{5}{6} + \$500 \cdot \frac{1}{6} = \frac{40}{6} + \frac{500}{6} = \frac{540}{6} = \$90
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m The overall expected value of the winnings is the weighted average of the expected values from the two scenarios, weighted by their respective probabilities:
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m E(\text{Winnings}) = P(\text{Black from A}) \cdot E(\text{Winnings} | \text{Black from A}) + P(\text{White from A}) \cdot E(\text{Winnings} | \text{White from A})
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m Substituting the values we calculated:
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m E(\text{Winnings}) = \frac{4}{5} \cdot 5 + \frac{1}{5} \cdot 90 = 4 + 18 = 22
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m Therefore, the expected win is:
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m \boxed{22}
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m [ground_truth] \$20
[36m(TaskRunner pid=82921)[0m [score] 0.0
[36m(TaskRunner pid=82921)[0m step:40 - actor/entropy:0.23468002676963806 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00024858503992675196) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.0013100651166553234) - actor/grad_norm:np.float64(0.14670917391777039) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(155.7884349822998) - actor/lr:np.float64(3e-06) - val-core/DigitalLearningGmbH/MATH-lighteval/reward/mean@1:np.float64(0.5166066426570628) - training/global_step:40 - training/epoch:0 - critic/score/mean:0.40234375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.40234375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.23204047977924347 - critic/advantages/max:2.5575942993164062 - critic/advantages/min:-2.5722594261169434 - critic/returns/mean:-0.23204047977924347 - critic/returns/max:2.5575942993164062 - critic/returns/min:-2.5722594261169434 - response_length/mean:837.7412109375 - response_length/max:4096.0 - response_length/min:125.0 - response_length/clip_ratio:0.0146484375 - response_length_non_aborted/mean:837.7412109375 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:125.0 - response_length_non_aborted/clip_ratio:0.0146484375 - response/aborted_ratio:0.0 - prompt_length/mean:138.5703125 - prompt_length/max:656.0 - prompt_length/min:73.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.522215411067009e-05 - timing_s/generate_sequences:58.30463790893555 - timing_s/generation_timing/max:59.20708465576172 - timing_s/generation_timing/min:56.99943923950195 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:66.92781183868647 - timing_s/reward:0.3412554250098765 - timing_s/old_log_prob:22.707992346026003 - timing_s/ref:18.12768226210028 - timing_s/adv:0.28168238094076514 - timing_s/update_actor:71.06970345461741 - timing_s/step:179.67062866315246 - timing_s/testing:336.56686398293823 - timing_s/stop_profile:3.584893420338631e-05 - timing_per_token_ms/update_actor:0.07108797306369478 - timing_per_token_ms/ref:0.018132342274064715 - timing_per_token_ms/adv:0.0002817547919222892 - timing_per_token_ms/gen:0.07801835506644712 - perf/total_num_tokens:999743 - perf/time_per_step:179.67062866315246 - perf/throughput:1391.0773945616954
[36m(TaskRunner pid=82921)[0m 
Training Progress:  69%|██████▉   | 40/58 [3:46:27<1:24:38, 282.15s/it]
[36m(TaskRunner pid=82921)[0m step:41 - actor/entropy:0.31047800183296204 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00027551531590574996) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.0012572398624826064) - actor/grad_norm:np.float64(0.15355396270751953) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(144.39386749267578) - actor/lr:np.float64(3e-06) - training/global_step:41 - training/epoch:0 - critic/score/mean:0.4130859375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4130859375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.21644650399684906 - critic/advantages/max:2.567889451980591 - critic/advantages/min:-2.5658068656921387 - critic/returns/mean:-0.21644650399684906 - critic/returns/max:2.567889451980591 - critic/returns/min:-2.5658068656921387 - response_length/mean:771.970703125 - response_length/max:4096.0 - response_length/min:138.0 - response_length/clip_ratio:0.017578125 - response_length_non_aborted/mean:771.970703125 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:138.0 - response_length_non_aborted/clip_ratio:0.017578125 - response/aborted_ratio:0.0 - prompt_length/mean:147.015625 - prompt_length/max:775.0 - prompt_length/min:76.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.604202255606651e-05 - timing_s/generate_sequences:57.48147201538086 - timing_s/generation_timing/max:60.45114517211914 - timing_s/generation_timing/min:54.83049011230469 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:66.00451456336305 - timing_s/reward:0.3270932827144861 - timing_s/old_log_prob:20.936851256061345 - timing_s/ref:18.157530010677874 - timing_s/adv:0.20216184575110674 - timing_s/update_actor:69.49106896296144 - timing_s/step:175.35591403907165 - timing_s/stop_profile:8.605374023318291e-05 - timing_per_token_ms/update_actor:0.07384481135056824 - timing_per_token_ms/ref:0.019295132428390947 - timing_per_token_ms/adv:0.00021482765461170356 - timing_per_token_ms/gen:0.08349738337524326 - perf/total_num_tokens:941042 - perf/time_per_step:175.35591403907165 - perf/throughput:1341.6171407117802
[36m(TaskRunner pid=82921)[0m 
Training Progress:  71%|███████   | 41/58 [3:49:22<1:10:52, 250.13s/it]
[36m(TaskRunner pid=82921)[0m step:42 - actor/entropy:0.2866212725639343 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0002644692584397035) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.0010640782087989464) - actor/grad_norm:np.float64(0.15456651151180267) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(158.5966625213623) - actor/lr:np.float64(3e-06) - training/global_step:42 - training/epoch:0 - critic/score/mean:0.4248046875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4248046875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.23412659764289856 - critic/advantages/max:2.561229705810547 - critic/advantages/min:-2.5693795680999756 - critic/returns/mean:-0.23412659764289856 - critic/returns/max:2.561229705810547 - critic/returns/min:-2.5693795680999756 - response_length/mean:823.193359375 - response_length/max:4096.0 - response_length/min:105.0 - response_length/clip_ratio:0.0185546875 - response_length_non_aborted/mean:823.193359375 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:105.0 - response_length_non_aborted/clip_ratio:0.0185546875 - response/aborted_ratio:0.0 - prompt_length/mean:148.609375 - prompt_length/max:885.0 - prompt_length/min:76.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.335577487945557e-05 - timing_s/generate_sequences:58.48552703857422 - timing_s/generation_timing/max:59.067108154296875 - timing_s/generation_timing/min:58.046653747558594 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:68.77273426624015 - timing_s/reward:0.33906726306304336 - timing_s/old_log_prob:21.781012470368296 - timing_s/ref:17.837862462736666 - timing_s/adv:0.20410409988835454 - timing_s/update_actor:74.67484332900494 - timing_s/step:183.80675091594458 - timing_s/stop_profile:4.100613296031952e-05 - timing_per_token_ms/update_actor:0.07504059117036932 - timing_per_token_ms/ref:0.017925230033922 - timing_per_token_ms/adv:0.00020510377569107283 - timing_per_token_ms/gen:0.08158578120438953 - perf/total_num_tokens:995126 - perf/time_per_step:183.80675091594458 - perf/throughput:1353.4949002703856
[36m(TaskRunner pid=82921)[0m 
Training Progress:  72%|███████▏  | 42/58 [3:52:26<1:01:24, 230.26s/it]
[36m(TaskRunner pid=82921)[0m step:43 - actor/entropy:0.2742822766304016 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0002829341167966959) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.000893607054081258) - actor/grad_norm:np.float64(0.15813541412353516) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(150.76005172729492) - actor/lr:np.float64(3e-06) - training/global_step:43 - training/epoch:0 - critic/score/mean:0.4443359375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4443359375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.22927379608154297 - critic/advantages/max:2.5424883365631104 - critic/advantages/min:-2.5571720600128174 - critic/returns/mean:-0.22927379608154297 - critic/returns/max:2.5424883365631104 - critic/returns/min:-2.5571720600128174 - response_length/mean:828.4755859375 - response_length/max:4096.0 - response_length/min:110.0 - response_length/clip_ratio:0.025390625 - response_length_non_aborted/mean:828.4755859375 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:110.0 - response_length_non_aborted/clip_ratio:0.025390625 - response/aborted_ratio:0.0 - prompt_length/mean:152.71875 - prompt_length/max:883.0 - prompt_length/min:74.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.537395089864731e-05 - timing_s/generate_sequences:60.29655456542969 - timing_s/generation_timing/max:62.316165924072266 - timing_s/generation_timing/min:58.32395553588867 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:72.80724346172065 - timing_s/reward:0.3284865948371589 - timing_s/old_log_prob:22.425122901331633 - timing_s/ref:18.188762364909053 - timing_s/adv:0.24441577307879925 - timing_s/update_actor:74.089208568912 - timing_s/step:188.28320535225794 - timing_s/stop_profile:4.9944035708904266e-05 - timing_per_token_ms/update_actor:0.07373946229922676 - timing_per_token_ms/ref:0.018102900308744677 - timing_per_token_ms/adv:0.00024326198150054218 - timing_per_token_ms/gen:0.08582126606981319 - perf/total_num_tokens:1004743 - perf/time_per_step:188.28320535225794 - perf/throughput:1334.0847343769087
[36m(TaskRunner pid=82921)[0m 
Training Progress:  74%|███████▍  | 43/58 [3:55:35<54:25, 217.69s/it]  
[36m(TaskRunner pid=82921)[0m step:44 - actor/entropy:0.3193632960319519 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00029803924927307435) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.0010849723117019039) - actor/grad_norm:np.float64(0.14954140782356262) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(144.9589958190918) - actor/lr:np.float64(3e-06) - training/global_step:44 - training/epoch:0 - critic/score/mean:0.4384765625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4384765625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.12087638676166534 - critic/advantages/max:2.5665128231048584 - critic/advantages/min:-2.5593931674957275 - critic/returns/mean:-0.12087638676166534 - critic/returns/max:2.5665128231048584 - critic/returns/min:-2.5593931674957275 - response_length/mean:875.6376953125 - response_length/max:4096.0 - response_length/min:124.0 - response_length/clip_ratio:0.0244140625 - response_length_non_aborted/mean:875.6376953125 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:124.0 - response_length_non_aborted/clip_ratio:0.0244140625 - response/aborted_ratio:0.0 - prompt_length/mean:134.2421875 - prompt_length/max:539.0 - prompt_length/min:78.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.471497282385826e-05 - timing_s/generate_sequences:61.458900451660156 - timing_s/generation_timing/max:61.69289779663086 - timing_s/generation_timing/min:61.24924850463867 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:71.16522426623851 - timing_s/reward:0.3392148120328784 - timing_s/old_log_prob:22.42217835225165 - timing_s/ref:19.013138958252966 - timing_s/adv:0.22128036571666598 - timing_s/update_actor:74.3186459527351 - timing_s/step:187.71488269465044 - timing_s/stop_profile:3.864103928208351e-05 - timing_per_token_ms/update_actor:0.07186676744772119 - timing_per_token_ms/ref:0.018385868289809534 - timing_per_token_ms/adv:0.00021398000972488218 - timing_per_token_ms/gen:0.0793676308072783 - perf/total_num_tokens:1034117 - perf/time_per_step:187.71488269465044 - perf/throughput:1377.2442881928596
[36m(TaskRunner pid=82921)[0m 
Training Progress:  76%|███████▌  | 44/58 [3:58:42<48:41, 208.71s/it]
[36m(TaskRunner pid=82921)[0m step:45 - actor/entropy:0.29590874910354614 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00030877696573838875) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.0008069888643831291) - actor/grad_norm:np.float64(0.1452200710773468) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(153.96571350097656) - actor/lr:np.float64(3e-06) - training/global_step:45 - training/epoch:0 - critic/score/mean:0.4677734375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4677734375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.2163662612438202 - critic/advantages/max:2.4605491161346436 - critic/advantages/min:-2.5236976146698 - critic/returns/mean:-0.2163662612438202 - critic/returns/max:2.4605491161346436 - critic/returns/min:-2.5236976146698 - response_length/mean:904.193359375 - response_length/max:4096.0 - response_length/min:112.0 - response_length/clip_ratio:0.041015625 - response_length_non_aborted/mean:904.193359375 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:112.0 - response_length_non_aborted/clip_ratio:0.041015625 - response/aborted_ratio:0.0 - prompt_length/mean:127.8671875 - prompt_length/max:373.0 - prompt_length/min:75.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.957601100206375e-05 - timing_s/generate_sequences:64.313232421875 - timing_s/generation_timing/max:70.2442398071289 - timing_s/generation_timing/min:58.13307189941406 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:77.51169650768861 - timing_s/reward:0.3448588470928371 - timing_s/old_log_prob:23.847949985414743 - timing_s/ref:18.419702677987516 - timing_s/adv:0.3006698861718178 - timing_s/update_actor:73.93207774171606 - timing_s/step:194.56243840511888 - timing_s/stop_profile:3.673182800412178e-05 - timing_per_token_ms/update_actor:0.06995645254365987 - timing_per_token_ms/ref:0.017429201175200852 - timing_per_token_ms/adv:0.0002845016570042654 - timing_per_token_ms/gen:0.08371551873938983 - perf/total_num_tokens:1056830 - perf/time_per_step:194.56243840511888 - perf/throughput:1357.9573846102085
[36m(TaskRunner pid=82921)[0m 
Training Progress:  78%|███████▊  | 45/58 [4:01:57<44:18, 204.49s/it]
[36m(TaskRunner pid=82921)[0m step:46 - actor/entropy:0.27403923869132996 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00030923874915345095) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.0008014961483837624) - actor/grad_norm:np.float64(0.15445314347743988) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(144.86515045166016) - actor/lr:np.float64(3e-06) - training/global_step:46 - training/epoch:0 - critic/score/mean:0.470703125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.470703125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.18778856098651886 - critic/advantages/max:2.4960803985595703 - critic/advantages/min:-2.5732381343841553 - critic/returns/mean:-0.18778856098651886 - critic/returns/max:2.4960803985595703 - critic/returns/min:-2.5732381343841553 - response_length/mean:843.052734375 - response_length/max:4096.0 - response_length/min:122.0 - response_length/clip_ratio:0.0185546875 - response_length_non_aborted/mean:843.052734375 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:122.0 - response_length_non_aborted/clip_ratio:0.0185546875 - response/aborted_ratio:0.0 - prompt_length/mean:145.1953125 - prompt_length/max:812.0 - prompt_length/min:74.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.994504317641258e-05 - timing_s/generate_sequences:63.19879150390625 - timing_s/generation_timing/max:67.62703704833984 - timing_s/generation_timing/min:59.08696365356445 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:75.23557760706171 - timing_s/reward:0.26915876287966967 - timing_s/old_log_prob:24.540039144922048 - timing_s/ref:18.278652658686042 - timing_s/adv:0.24364658165723085 - timing_s/update_actor:73.05028482386842 - timing_s/step:191.82395817432553 - timing_s/stop_profile:3.3833086490631104e-05 - timing_per_token_ms/update_actor:0.07218650115109443 - timing_per_token_ms/ref:0.018062516585227215 - timing_per_token_ms/adv:0.000240765580718355 - timing_per_token_ms/gen:0.08715023480869806 - perf/total_num_tokens:1011966 - perf/time_per_step:191.82395817432553 - perf/throughput:1318.8733170133353
[36m(TaskRunner pid=82921)[0m 
Training Progress:  79%|███████▉  | 46/58 [4:05:09<40:08, 200.71s/it]
[36m(TaskRunner pid=82921)[0m step:47 - actor/entropy:0.2929745316505432 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0003031612517219173) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.0006279323108060453) - actor/grad_norm:np.float64(0.15260307490825653) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(138.90375900268555) - actor/lr:np.float64(3e-06) - training/global_step:47 - training/epoch:0 - critic/score/mean:0.5068359375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5068359375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.17945748567581177 - critic/advantages/max:2.4139721393585205 - critic/advantages/min:-2.551421642303467 - critic/returns/mean:-0.17945748567581177 - critic/returns/max:2.4139721393585205 - critic/returns/min:-2.551421642303467 - response_length/mean:879.0556640625 - response_length/max:4096.0 - response_length/min:98.0 - response_length/clip_ratio:0.033203125 - response_length_non_aborted/mean:879.0556640625 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:98.0 - response_length_non_aborted/clip_ratio:0.033203125 - response/aborted_ratio:0.0 - prompt_length/mean:129.828125 - prompt_length/max:340.0 - prompt_length/min:74.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.3735221475362778e-05 - timing_s/generate_sequences:67.17259216308594 - timing_s/generation_timing/max:69.70198059082031 - timing_s/generation_timing/min:64.8891372680664 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:77.41953542781994 - timing_s/reward:0.3360106637701392 - timing_s/old_log_prob:24.3363704867661 - timing_s/ref:18.531020489055663 - timing_s/adv:0.2112947842106223 - timing_s/update_actor:71.86964422883466 - timing_s/step:192.90011083707213 - timing_s/stop_profile:4.95309941470623e-05 - timing_per_token_ms/update_actor:0.06956717929568536 - timing_per_token_ms/ref:0.017937348079663056 - timing_per_token_ms/adv:0.00020452560041372912 - timing_per_token_ms/gen:0.08600708482649054 - perf/total_num_tokens:1033097 - perf/time_per_step:192.90011083707213 - perf/throughput:1338.9015116644716
[36m(TaskRunner pid=82921)[0m 
Training Progress:  81%|████████  | 47/58 [4:08:22<36:22, 198.39s/it]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m step:48 - actor/entropy:0.2988913953304291 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00029903568147915394) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.0012262136373237809) - actor/grad_norm:np.float64(0.14800569415092468) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(147.7302713394165) - actor/lr:np.float64(3e-06) - training/global_step:48 - training/epoch:0 - critic/score/mean:0.4228515625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4228515625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.21871204674243927 - critic/advantages/max:2.458543539047241 - critic/advantages/min:-2.5517776012420654 - critic/returns/mean:-0.21871204674243927 - critic/returns/max:2.458543539047241 - critic/returns/min:-2.5517776012420654 - response_length/mean:857.9765625 - response_length/max:4096.0 - response_length/min:115.0 - response_length/clip_ratio:0.0234375 - response_length_non_aborted/mean:857.9765625 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:115.0 - response_length_non_aborted/clip_ratio:0.0234375 - response/aborted_ratio:0.0 - prompt_length/mean:135.3125 - prompt_length/max:448.0 - prompt_length/min:78.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.589410334825516e-05 - timing_s/generate_sequences:59.725494384765625 - timing_s/generation_timing/max:62.120662689208984 - timing_s/generation_timing/min:57.668907165527344 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:69.6737887780182 - timing_s/reward:0.3399569150060415 - timing_s/old_log_prob:21.54523649904877 - timing_s/ref:18.37428402667865 - timing_s/adv:0.262164699845016 - timing_s/update_actor:73.14569462509826 - timing_s/step:183.57040574913844 - timing_s/stop_profile:3.459630534052849e-05 - timing_per_token_ms/update_actor:0.07191395244757617 - timing_per_token_ms/ref:0.018064868951281107 - timing_per_token_ms/adv:0.0002577499585548879 - timing_per_token_ms/gen:0.07930380890041318 - perf/total_num_tokens:1017128 - perf/time_per_step:183.57040574913844 - perf/throughput:1385.2014923772288
[36m(TaskRunner pid=82921)[0m 
Training Progress:  83%|████████▎ | 48/58 [4:11:25<32:19, 193.96s/it]
[36m(TaskRunner pid=82921)[0m step:49 - actor/entropy:0.2944461405277252 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00028611636577124955) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.0016121476268216028) - actor/grad_norm:np.float64(0.16166161000728607) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(148.73125076293945) - actor/lr:np.float64(3e-06) - training/global_step:49 - training/epoch:0 - critic/score/mean:0.388671875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.388671875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.2076081782579422 - critic/advantages/max:2.5296037197113037 - critic/advantages/min:-2.5279042720794678 - critic/returns/mean:-0.2076081782579422 - critic/returns/max:2.5296037197113037 - critic/returns/min:-2.5279042720794678 - response_length/mean:942.3837890625 - response_length/max:4096.0 - response_length/min:102.0 - response_length/clip_ratio:0.0341796875 - response_length_non_aborted/mean:942.3837890625 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:102.0 - response_length_non_aborted/clip_ratio:0.0341796875 - response/aborted_ratio:0.0 - prompt_length/mean:139.5078125 - prompt_length/max:410.0 - prompt_length/min:75.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.149802356958389e-05 - timing_s/generate_sequences:66.03276062011719 - timing_s/generation_timing/max:67.40845489501953 - timing_s/generation_timing/min:64.4421615600586 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:76.82082933885977 - timing_s/reward:0.35571511927992105 - timing_s/old_log_prob:22.27117910515517 - timing_s/ref:18.185383231844753 - timing_s/adv:0.2244247286580503 - timing_s/update_actor:79.30279717594385 - timing_s/step:197.3894591620192 - timing_s/stop_profile:5.764001980423927e-05 - timing_per_token_ms/update_actor:0.07158216013072431 - timing_per_token_ms/ref:0.01641491928276371 - timing_per_token_ms/adv:0.00020257553877264873 - timing_per_token_ms/gen:0.07960699454079298 - perf/total_num_tokens:1107857 - perf/time_per_step:197.3894591620192 - perf/throughput:1403.1359687381535
[36m(TaskRunner pid=82921)[0m 
Training Progress:  84%|████████▍ | 49/58 [4:14:43<29:15, 195.02s/it]
[36m(TaskRunner pid=82921)[0m test_gen_batch meta info: {'eos_token_id': 151643, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 50}
[36m(TaskRunner pid=82921)[0m validation generation end
[36m(TaskRunner pid=82921)[0m [prompt] system
[36m(TaskRunner pid=82921)[0m You are a helpful AI Assistant, designed to provide well-reasoned and detailed responses. You FIRST think about the reasoning process step by step and then provide the user with the answer. Please enclose your final answer in the box: \boxed{Your Answer}.
[36m(TaskRunner pid=82921)[0m user
[36m(TaskRunner pid=82921)[0m Bin $A$ has one white ball and four black balls.  Bin $B$ has three balls labeled $\$1$ and one ball labeled $\$7$.  Bin $W$ has five balls labeled $\$8$ and one ball labeled $\$500$.  A game is played as follows: a ball is randomly selected from bin $A$.  If it is black, then a ball is randomly selected from bin $B$; otherwise, if the original ball is white, then a ball is randomly selected from bin $W$.  You win the amount printed on the second ball selected.  What is your expected win?
[36m(TaskRunner pid=82921)[0m assistant
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m [response] To find the expected win, we need to calculate the probability of each outcome and the corresponding winnings. Let's break it down step by step.
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 1. **Probability of selecting a black ball from bin A:**
[36m(TaskRunner pid=82921)[0m    Bin A has 1 white ball and 4 black balls, so the probability of selecting a black ball is:
[36m(TaskRunner pid=82921)[0m    \[
[36m(TaskRunner pid=82921)[0m    P(\text{Black from A}) = \frac{4}{5}
[36m(TaskRunner pid=82921)[0m    \]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 2. **Probability of selecting a white ball from bin A:**
[36m(TaskRunner pid=82921)[0m    The probability of selecting a white ball is:
[36m(TaskRunner pid=82921)[0m    \[
[36m(TaskRunner pid=82921)[0m    P(\text{White from A}) = \frac{1}{5}
[36m(TaskRunner pid=82921)[0m    \]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 3. **Probability of selecting a ball from bin B given a black ball from bin A:**
[36m(TaskRunner pid=82921)[0m    Bin B has 3 balls labeled $1 and 1 ball labeled $7, so the probability of selecting a ball from bin B is:
[36m(TaskRunner pid=82921)[0m    \[
[36m(TaskRunner pid=82921)[0m    P(\text{Ball from B} | \text{Black from A}) = \frac{3}{4}
[36m(TaskRunner pid=82921)[0m    \]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 4. **Probability of selecting a ball from bin W given a white ball from bin A:**
[36m(TaskRunner pid=82921)[0m    Bin W has 5 balls labeled $8 and 1 ball labeled $500, so the probability of selecting a ball from bin W is:
[36m(TaskRunner pid=82921)[0m    \[
[36m(TaskRunner pid=82921)[0m    P(\text{Ball from W} | \text{White from A}) = \frac{5}{6}
[36m(TaskRunner pid=82921)[0m    \]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 5. **Expected winnings if a black ball is selected from bin A:**
[36m(TaskRunner pid=82921)[0m    The expected winnings if a black ball is selected from bin A are:
[36m(TaskRunner pid=82921)[0m    \[
[36m(TaskRunner pid=82921)[0m    E(\text{Winnings} | \text{Black from A}) = 1 \cdot \frac{3}{4} + 7 \cdot \frac{1}{4} = \frac{3}{4} + \frac{7}{4} = \frac{10}{4} = 2.5
[36m(TaskRunner pid=82921)[0m    \]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 6. **Expected winnings if a white ball is selected from bin A:**
[36m(TaskRunner pid=82921)[0m    The expected winnings if a white ball is selected from bin A are:
[36m(TaskRunner pid=82921)[0m    \[
[36m(TaskRunner pid=82921)[0m    E(\text{Winnings} | \text{White from A}) = 8 \cdot \frac{5}{6} + 500 \cdot \frac{1}{6} = \frac{40}{6} + \frac{500}{6} = \frac{540}{6} = 90
[36m(TaskRunner pid=82921)[0m    \]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 7. **Total expected winnings:**
[36m(TaskRunner pid=82921)[0m    The total expected winnings are the weighted sum of the expected winnings from each scenario:
[36m(TaskRunner pid=82921)[0m    \[
[36m(TaskRunner pid=82921)[0m    E(\text{Total Winnings}) = P(\text{Black from A}) \cdot E(\text{Winnings} | \text{Black from A}) + P(\text{White from A}) \cdot E(\text{Winnings} | \text{White from A})
[36m(TaskRunner pid=82921)[0m    \]
[36m(TaskRunner pid=82921)[0m    Substituting the values we have:
[36m(TaskRunner pid=82921)[0m    \[
[36m(TaskRunner pid=82921)[0m    E(\text{Total Winnings}) = \frac{4}{5} \cdot 2.5 + \frac{1}{5} \cdot 90 = \frac{10}{5} + \frac{90}{5} = \frac{100}{5} = 20
[36m(TaskRunner pid=82921)[0m    \]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Therefore, the expected win is \(\boxed{20}\).
[36m(TaskRunner pid=82921)[0m [ground_truth] \$20
[36m(TaskRunner pid=82921)[0m [score] 1.0
[36m(TaskRunner pid=82921)[0m step:50 - actor/entropy:0.22771206498146057 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0002830570615230954) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.0010008380896167068) - actor/grad_norm:np.float64(0.14076633751392365) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(143.99903106689453) - actor/lr:np.float64(3e-06) - val-core/DigitalLearningGmbH/MATH-lighteval/reward/mean@1:np.float64(0.5148059223689476) - training/global_step:50 - training/epoch:0 - critic/score/mean:0.43359375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.43359375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.20304197072982788 - critic/advantages/max:2.486646890640259 - critic/advantages/min:-2.509937047958374 - critic/returns/mean:-0.20304197072982788 - critic/returns/max:2.486646890640259 - critic/returns/min:-2.509937047958374 - response_length/mean:872.0517578125 - response_length/max:4096.0 - response_length/min:127.0 - response_length/clip_ratio:0.025390625 - response_length_non_aborted/mean:872.0517578125 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:127.0 - response_length_non_aborted/clip_ratio:0.025390625 - response/aborted_ratio:0.0 - prompt_length/mean:135.015625 - prompt_length/max:726.0 - prompt_length/min:78.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.911872282624245e-05 - timing_s/generate_sequences:62.034149169921875 - timing_s/generation_timing/max:63.192108154296875 - timing_s/generation_timing/min:60.47566604614258 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:71.94720375724137 - timing_s/reward:0.2572176130488515 - timing_s/old_log_prob:22.546863603871316 - timing_s/ref:17.731573584955186 - timing_s/adv:0.2621266869828105 - timing_s/update_actor:72.07633805600926 - timing_s/step:185.00388993974775 - timing_s/testing:372.6508414102718 - timing_s/stop_profile:3.2984185963869095e-05 - timing_per_token_ms/update_actor:0.06989308767626574 - timing_per_token_ms/ref:0.017194469927819877 - timing_per_token_ms/adv:0.0002541866583363577 - timing_per_token_ms/gen:0.08056969158049429 - perf/total_num_tokens:1031237 - perf/time_per_step:185.00388993974775 - perf/throughput:1393.53421208583
[36m(TaskRunner pid=82921)[0m 
Training Progress:  86%|████████▌ | 50/58 [4:24:01<40:30, 303.85s/it]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        [36m(TaskRunner pid=82921)[0m step:52 - actor/entropy:0.3008166253566742 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00035458665622911667) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.001100306846865351) - actor/grad_norm:np.float64(0.14132079482078552) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(145.1569709777832) - actor/lr:np.float64(3e-06) - training/global_step:52 - training/epoch:0 - critic/score/mean:0.4228515625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4228515625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.19352059066295624 - critic/advantages/max:2.5732405185699463 - critic/advantages/min:-2.544220447540283 - critic/returns/mean:-0.19352059066295624 - critic/returns/max:2.5732405185699463 - critic/returns/min:-2.544220447540283 - response_length/mean:927.123046875 - response_length/max:4096.0 - response_length/min:99.0 - response_length/clip_ratio:0.0380859375 - response_length_non_aborted/mean:927.123046875 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:99.0 - response_length_non_aborted/clip_ratio:0.0380859375 - response/aborted_ratio:0.0 - prompt_length/mean:160.8203125 - prompt_length/max:787.0 - prompt_length/min:79.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.74671071767807e-05 - timing_s/generate_sequences:67.09829711914062 - timing_s/generation_timing/max:68.05079650878906 - timing_s/generation_timing/min:66.24925231933594 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:78.49985140515491 - timing_s/reward:0.2693618396297097 - timing_s/old_log_prob:23.908522503916174 - timing_s/ref:19.281313133891672 - timing_s/adv:0.23569797165691853 - timing_s/update_actor:74.93071836279705 - timing_s/step:197.3022271762602 - timing_s/stop_profile:5.391007289290428e-05 - timing_per_token_ms/update_actor:0.06725950300685339 - timing_per_token_ms/ref:0.017307341595552524 - timing_per_token_ms/adv:0.00021156781597383837 - timing_per_token_ms/gen:0.08268590819335153 - perf/total_num_tokens:1114054 - perf/time_per_step:197.3022271762602 - perf/throughput:1411.608495180288
[36m(TaskRunner pid=82921)[0m Training Progress:  90%|████████▉ | 52/58 [4:30:27<24:47, 247.88s/it]
[36m(TaskRunner pid=82921)[0m step:53 - actor/entropy:0.2733634412288666 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0003365934315979757) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.0006761877597085686) - actor/grad_norm:np.float64(0.15767760574817657) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(155.93579292297363) - actor/lr:np.float64(3e-06) - training/global_step:53 - training/epoch:0 - critic/score/mean:0.447265625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.447265625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.12253721058368683 - critic/advantages/max:2.5524284839630127 - critic/advantages/min:-2.562758445739746 - critic/returns/mean:-0.12253721058368683 - critic/returns/max:2.5524284839630127 - critic/returns/min:-2.562758445739746 - response_length/mean:900.580078125 - response_length/max:4096.0 - response_length/min:88.0 - response_length/clip_ratio:0.0283203125 - response_length_non_aborted/mean:900.580078125 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:88.0 - response_length_non_aborted/clip_ratio:0.0283203125 - response/aborted_ratio:0.0 - prompt_length/mean:139.4609375 - prompt_length/max:485.0 - prompt_length/min:76.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.6763958632946014e-05 - timing_s/generate_sequences:64.05274963378906 - timing_s/generation_timing/max:68.6035385131836 - timing_s/generation_timing/min:59.71602249145508 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:76.79711086628959 - timing_s/reward:0.35499174194410443 - timing_s/old_log_prob:21.86219452228397 - timing_s/ref:18.231148630846292 - timing_s/adv:0.23147436464205384 - timing_s/update_actor:75.87028796412051 - timing_s/step:193.55606626486406 - timing_s/stop_profile:3.338512033224106e-05 - timing_per_token_ms/update_actor:0.07123957322532776 - timing_per_token_ms/ref:0.017118417271372536 - timing_per_token_ms/adv:0.00021734641309786634 - timing_per_token_ms/gen:0.08327652410044913 - perf/total_num_tokens:1065002 - perf/time_per_step:193.55606626486406 - perf/throughput:1375.5730065089263
[36m(TaskRunner pid=82921)[0m Training Progress:  91%|█████████▏| 53/58 [4:33:41<19:17, 231.60s/it]
[36m(TaskRunner pid=82921)[0m step:54 - actor/entropy:0.22141310572624207 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0003130705908915843) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.0007389813972658033) - actor/grad_norm:np.float64(0.1585237979888916) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(147.70334243774414) - actor/lr:np.float64(3e-06) - training/global_step:54 - training/epoch:0 - critic/score/mean:0.4716796875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4716796875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.20229372382164001 - critic/advantages/max:2.425936222076416 - critic/advantages/min:-2.5711560249328613 - critic/returns/mean:-0.20229372382164001 - critic/returns/max:2.425936222076416 - critic/returns/min:-2.5711560249328613 - response_length/mean:821.4384765625 - response_length/max:4096.0 - response_length/min:142.0 - response_length/clip_ratio:0.025390625 - response_length_non_aborted/mean:821.4384765625 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:142.0 - response_length_non_aborted/clip_ratio:0.025390625 - response/aborted_ratio:0.0 - prompt_length/mean:142.53125 - prompt_length/max:969.0 - prompt_length/min:77.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.425667718052864e-05 - timing_s/generate_sequences:59.10082244873047 - timing_s/generation_timing/max:63.09684753417969 - timing_s/generation_timing/min:55.10862731933594 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:71.65279387868941 - timing_s/reward:0.3316071033477783 - timing_s/old_log_prob:21.987940341234207 - timing_s/ref:17.741748956032097 - timing_s/adv:0.27026791498064995 - timing_s/update_actor:72.50327108521014 - timing_s/step:184.69470070302486 - timing_s/stop_profile:3.637978807091713e-05 - timing_per_token_ms/update_actor:0.0734504141760098 - timing_per_token_ms/ref:0.017973517463726853 - timing_per_token_ms/adv:0.0002737985472474052 - timing_per_token_ms/gen:0.08518401988543037 - perf/total_num_tokens:987105 - perf/time_per_step:184.69470070302486 - perf/throughput:1336.130647282607
[36m(TaskRunner pid=82921)[0m Training Progress:  93%|█████████▎| 54/58 [4:36:46<14:30, 217.57s/it]
[36m(TaskRunner pid=82921)[0m step:55 - actor/entropy:0.20222075283527374 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0003540297454236452) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.0005486953803419681) - actor/grad_norm:np.float64(0.15747471153736115) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(141.76438522338867) - actor/lr:np.float64(3e-06) - training/global_step:55 - training/epoch:0 - critic/score/mean:0.4912109375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4912109375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.1799466758966446 - critic/advantages/max:2.544921875 - critic/advantages/min:-2.5547478199005127 - critic/returns/mean:-0.1799466758966446 - critic/returns/max:2.544921875 - critic/returns/min:-2.5547478199005127 - response_length/mean:821.9619140625 - response_length/max:4096.0 - response_length/min:65.0 - response_length/clip_ratio:0.02734375 - response_length_non_aborted/mean:821.9619140625 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:65.0 - response_length_non_aborted/clip_ratio:0.02734375 - response/aborted_ratio:0.0 - prompt_length/mean:131.3203125 - prompt_length/max:602.0 - prompt_length/min:76.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.553686499595642e-05 - timing_s/generate_sequences:61.59014892578125 - timing_s/generation_timing/max:67.70144653320312 - timing_s/generation_timing/min:55.4148063659668 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:75.60208603227511 - timing_s/reward:0.2576685226522386 - timing_s/old_log_prob:22.26975129544735 - timing_s/ref:17.653678168077022 - timing_s/adv:0.27141896868124604 - timing_s/update_actor:69.3013950008899 - timing_s/step:185.53159660985693 - timing_s/stop_profile:4.321988672018051e-05 - timing_per_token_ms/update_actor:0.07099381659469073 - timing_per_token_ms/ref:0.018084801757166105 - timing_per_token_ms/adv:0.00027804733920044547 - timing_per_token_ms/gen:0.0898218772400199 - perf/total_num_tokens:976161 - perf/time_per_step:185.53159660985693 - perf/throughput:1315.3568150075123
[36m(TaskRunner pid=82921)[0m Training Progress:  95%|█████████▍| 55/58 [4:39:52<10:23, 207.97s/it]
[36m(TaskRunner pid=82921)[0m step:56 - actor/entropy:0.17108191549777985 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0003183672513387137) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.00018274977443866192) - actor/grad_norm:np.float64(0.1413051337003708) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(153.3453712463379) - actor/lr:np.float64(3e-06) - training/global_step:56 - training/epoch:0 - critic/score/mean:0.509765625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.509765625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.13329781591892242 - critic/advantages/max:2.546748399734497 - critic/advantages/min:-2.5481433868408203 - critic/returns/mean:-0.13329781591892242 - critic/returns/max:2.546748399734497 - critic/returns/min:-2.5481433868408203 - response_length/mean:844.4873046875 - response_length/max:4096.0 - response_length/min:132.0 - response_length/clip_ratio:0.0263671875 - response_length_non_aborted/mean:844.4873046875 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:132.0 - response_length_non_aborted/clip_ratio:0.0263671875 - response/aborted_ratio:0.0 - prompt_length/mean:137.8359375 - prompt_length/max:577.0 - prompt_length/min:77.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.6275945603847504e-05 - timing_s/generate_sequences:60.512386322021484 - timing_s/generation_timing/max:65.4703369140625 - timing_s/generation_timing/min:55.758094787597656 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:73.78154787467793 - timing_s/reward:0.32287136744707823 - timing_s/old_log_prob:22.23954133503139 - timing_s/ref:17.588182311039418 - timing_s/adv:0.2528374777175486 - timing_s/update_actor:71.84594630915672 - timing_s/step:186.23607361642644 - timing_s/stop_profile:3.7570949643850327e-05 - timing_per_token_ms/update_actor:0.07142461251990181 - timing_per_token_ms/ref:0.017485038071455898 - timing_per_token_ms/adv:0.0002513547361291229 - timing_per_token_ms/gen:0.08532075313201766 - perf/total_num_tokens:1005899 - perf/time_per_step:186.23607361642644 - perf/throughput:1350.3009654184384
[36m(TaskRunner pid=82921)[0m Training Progress:  97%|█████████▋| 56/58 [4:42:58<06:42, 201.47s/it]
[36m(TaskRunner pid=82921)[0m step:57 - actor/entropy:0.2118070423603058 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00037631614878819164) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(-0.00030887452425432116) - actor/grad_norm:np.float64(0.16877751052379608) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(161.44374465942383) - actor/lr:np.float64(3e-06) - training/global_step:57 - training/epoch:0 - critic/score/mean:0.5615234375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5615234375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.15300589799880981 - critic/advantages/max:2.47029709815979 - critic/advantages/min:-2.5720512866973877 - critic/returns/mean:-0.15300589799880981 - critic/returns/max:2.47029709815979 - critic/returns/min:-2.5720512866973877 - response_length/mean:763.9990234375 - response_length/max:4096.0 - response_length/min:90.0 - response_length/clip_ratio:0.0224609375 - response_length_non_aborted/mean:763.9990234375 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:90.0 - response_length_non_aborted/clip_ratio:0.0224609375 - response/aborted_ratio:0.0 - prompt_length/mean:134.8515625 - prompt_length/max:481.0 - prompt_length/min:77.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.919175550341606e-05 - timing_s/generate_sequences:57.087833404541016 - timing_s/generation_timing/max:57.83091354370117 - timing_s/generation_timing/min:56.046077728271484 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:65.94026049599051 - timing_s/reward:0.3099520029500127 - timing_s/old_log_prob:21.57822640798986 - timing_s/ref:18.287179646082222 - timing_s/adv:0.22274027718231082 - timing_s/update_actor:68.39533588523045 - timing_s/step:174.94560566963628 - timing_s/stop_profile:3.8288068026304245e-05 - timing_per_token_ms/update_actor:0.07430859059935535 - timing_per_token_ms/ref:0.019868234112013956 - timing_per_token_ms/adv:0.00024199773058942553 - timing_per_token_ms/gen:0.08428647637647621 - perf/total_num_tokens:920423 - perf/time_per_step:174.94560566963628 - perf/throughput:1315.2988274225477
[36m(TaskRunner pid=82921)[0m Training Progress:  98%|█████████▊| 57/58 [4:45:53<03:13, 193.53s/it]
[36m(TaskRunner pid=82921)[0m test_gen_batch meta info: {'eos_token_id': 151643, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 58}
[36m(TaskRunner pid=82921)[0m validation generation end
[36m(TaskRunner pid=82921)[0m [prompt] system
[36m(TaskRunner pid=82921)[0m You are a helpful AI Assistant, designed to provide well-reasoned and detailed responses. You FIRST think about the reasoning process step by step and then provide the user with the answer. Please enclose your final answer in the box: \boxed{Your Answer}.
[36m(TaskRunner pid=82921)[0m user
[36m(TaskRunner pid=82921)[0m Bin $A$ has one white ball and four black balls.  Bin $B$ has three balls labeled $\$1$ and one ball labeled $\$7$.  Bin $W$ has five balls labeled $\$8$ and one ball labeled $\$500$.  A game is played as follows: a ball is randomly selected from bin $A$.  If it is black, then a ball is randomly selected from bin $B$; otherwise, if the original ball is white, then a ball is randomly selected from bin $W$.  You win the amount printed on the second ball selected.  What is your expected win?
[36m(TaskRunner pid=82921)[0m assistant
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m [response] To determine the expected win in this game, we need to calculate the expected value of the winnings based on the probabilities of selecting each type of ball from bins A and B, and the corresponding winnings.
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m First, let's define the probabilities and winnings for each scenario:
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 1. **Probability of selecting a black ball from bin A:**
[36m(TaskRunner pid=82921)[0m    - Bin A has 1 white ball and 4 black balls.
[36m(TaskRunner pid=82921)[0m    - The probability of selecting a black ball from bin A is:
[36m(TaskRunner pid=82921)[0m      \[
[36m(TaskRunner pid=82921)[0m      P(\text{Black from A}) = \frac{4}{5}
[36m(TaskRunner pid=82921)[0m      \]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 2. **Probability of selecting a white ball from bin A:**
[36m(TaskRunner pid=82921)[0m    - The probability of selecting a white ball from bin A is:
[36m(TaskRunner pid=82921)[0m      \[
[36m(TaskRunner pid=82921)[0m      P(\text{White from A}) = \frac{1}{5}
[36m(TaskRunner pid=82921)[0m      \]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 3. **Probability of selecting a ball from bin B:**
[36m(TaskRunner pid=82921)[0m    - Bin B has 3 balls labeled \$1 and 1 ball labeled \$7.
[36m(TaskRunner pid=82921)[0m    - The probability of selecting a ball from bin B is:
[36m(TaskRunner pid=82921)[0m      \[
[36m(TaskRunner pid=82921)[0m      P(\text{Ball from B}) = \frac{3}{5}
[36m(TaskRunner pid=82921)[0m      \]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 4. **Probability of selecting a ball from bin W:**
[36m(TaskRunner pid=82921)[0m    - Bin W has 5 balls labeled \$8 and 1 ball labeled \$500.
[36m(TaskRunner pid=82921)[0m    - The probability of selecting a ball from bin W is:
[36m(TaskRunner pid=82921)[0m      \[
[36m(TaskRunner pid=82921)[0m      P(\text{Ball from W}) = \frac{1}{6}
[36m(TaskRunner pid=82921)[0m      \]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m 5. **Winnings for each scenario:**
[36m(TaskRunner pid=82921)[0m    - If a black ball is selected from bin A, a ball is selected from bin B. The winnings are \$1.
[36m(TaskRunner pid=82921)[0m    - If a white ball is selected from bin A, a ball is selected from bin W. The winnings are \$8.
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Now, we can calculate the expected value of the winnings by considering the probabilities of each scenario and their corresponding winnings:
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m E(\text{Winnings}) = P(\text{Black from A}) \times P(\text{Ball from B}) \times \text{Winnings from B} + P(\text{White from A}) \times P(\text{Ball from W}) \times \text{Winnings from W}
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Substituting the values:
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m E(\text{Winnings}) = \left(\frac{4}{5} \times \frac{3}{5}\right) \times 1 + \left(\frac{1}{5} \times \frac{1}{6}\right) \times 8
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Simplify the expressions:
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m E(\text{Winnings}) = \frac{12}{25} + \frac{8}{30}
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m To add these fractions, we need a common denominator. The least common multiple of 25 and 30 is 150:
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m \frac{12}{25} = \frac{12 \times 6}{25 \times 6} = \frac{72}{150}
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m \frac{8}{30} = \frac{8 \times 5}{30 \times 5} = \frac{40}{150}
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Now add the fractions:
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m E(\text{Winnings}) = \frac{72}{150} + \frac{40}{150} = \frac{112}{150}
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Simplify the fraction:
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m \frac{112}{150} = \frac{56}{75}
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m Thus, the expected win is:
[36m(TaskRunner pid=82921)[0m 
[36m(TaskRunner pid=82921)[0m \[
[36m(TaskRunner pid=82921)[0m \boxed{\frac{56}{75}}
[36m(TaskRunner pid=82921)[0m \]
[36m(TaskRunner pid=82921)[0m [ground_truth] \$20
[36m(TaskRunner pid=82921)[0m [score] 0.0
[36m(TaskRunner pid=82921)[0m local_global_step_folder: /workspace/verl_exp/ckpts/CGPO/CGPO-Qwen2.5-1.5B/global_step_58
[36m(WorkerDict pid=84125)[0m INFO:2025-12-28 01:26:13,089:[Rank 2] Saved model to /workspace/verl_exp/ckpts/CGPO/CGPO-Qwen2.5-1.5B/global_step_58/actor/model_world_size_4_rank_2.pt
[36m(WorkerDict pid=84124)[0m INFO:2025-12-28 01:26:19,412:[Rank 1] Saved model to /workspace/verl_exp/ckpts/CGPO/CGPO-Qwen2.5-1.5B/global_step_58/actor/model_world_size_4_rank_1.pt[32m [repeated 2x across cluster][0m
[36m(WorkerDict pid=84123)[0m INFO:2025-12-28 01:26:26,000:[Rank 0] Saved model to /workspace/verl_exp/ckpts/CGPO/CGPO-Qwen2.5-1.5B/global_step_58/actor/model_world_size_4_rank_0.pt
[36m(WorkerDict pid=84125)[0m INFO:2025-12-28 01:27:29,146:[Rank 2] Saved optim to /workspace/verl_exp/ckpts/CGPO/CGPO-Qwen2.5-1.5B/global_step_58/actor/optim_world_size_4_rank_2.pt
[36m(WorkerDict pid=84125)[0m INFO:2025-12-28 01:27:29,289:[Rank 2] Saved extra_state to /workspace/verl_exp/ckpts/CGPO/CGPO-Qwen2.5-1.5B/global_step_58/actor/extra_state_world_size_4_rank_2.pt
[36m(WorkerDict pid=84123)[0m INFO:2025-12-28 01:27:34,044:[Rank 0] Saved optim to /workspace/verl_exp/ckpts/CGPO/CGPO-Qwen2.5-1.5B/global_step_58/actor/optim_world_size_4_rank_0.pt[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=84123)[0m INFO:2025-12-28 01:27:34,364:[Rank 0] Saved extra_state to /workspace/verl_exp/ckpts/CGPO/CGPO-Qwen2.5-1.5B/global_step_58/actor/extra_state_world_size_4_rank_0.pt[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=84123)[0m INFO:2025-12-28 01:27:35,379:[Rank 0] Saved model config and tokenizer class to /workspace/verl_exp/ckpts/CGPO/CGPO-Qwen2.5-1.5B/global_step_58/actor/huggingface
[36m(TaskRunner pid=82921)[0m step:58 - actor/entropy:0.18154717981815338 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00035080883587568223) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.00039497615100003713) - actor/grad_norm:np.float64(0.15285885334014893) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(53.26817226409912) - perf/max_memory_reserved_gb:np.float64(57.0703125) - perf/cpu_memory_used_gb:np.float64(173.51203536987305) - actor/lr:np.float64(3e-06) - val-core/DigitalLearningGmbH/MATH-lighteval/reward/mean@1:np.float64(0.5214085634253701) - training/global_step:58 - training/epoch:0 - critic/score/mean:0.4833984375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4833984375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.15024161338806152 - critic/advantages/max:2.5579419136047363 - critic/advantages/min:-2.528782844543457 - critic/returns/mean:-0.15024161338806152 - critic/returns/max:2.5579419136047363 - critic/returns/min:-2.528782844543457 - response_length/mean:859.63671875 - response_length/max:4096.0 - response_length/min:93.0 - response_length/clip_ratio:0.02734375 - response_length_non_aborted/mean:859.63671875 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:93.0 - response_length_non_aborted/clip_ratio:0.02734375 - response/aborted_ratio:0.0 - prompt_length/mean:135.5859375 - prompt_length/max:447.0 - prompt_length/min:75.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.14022496342659e-05 - timing_s/generate_sequences:63.01570129394531 - timing_s/generation_timing/max:72.27799987792969 - timing_s/generation_timing/min:53.7715950012207 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:80.91010204935446 - timing_s/reward:0.32566346134990454 - timing_s/old_log_prob:22.681956014130265 - timing_s/ref:18.537533252034336 - timing_s/adv:0.20187311619520187 - timing_s/update_actor:72.48627204122022 - timing_s/step:195.3538953680545 - timing_s/testing:385.7112214169465 - timing_s/save_checkpoint:88.94972948078066 - timing_s/stop_profile:0.0002811979502439499 - timing_per_token_ms/update_actor:0.07112717400042019 - timing_per_token_ms/ref:0.018189959505797555 - timing_per_token_ms/adv:0.0001980880497407555 - timing_per_token_ms/gen:0.09191530539489617 - perf/total_num_tokens:1019108 - perf/time_per_step:195.3538953680545 - perf/throughput:1304.1818261160854
[36m(TaskRunner pid=82921)[0m ('Final validation metrics: '
[36m(TaskRunner pid=82921)[0m  "{'val-core/DigitalLearningGmbH/MATH-lighteval/reward/mean@1': "
[36m(TaskRunner pid=82921)[0m  'np.float64(0.5214085634253701)}')
[36m(TaskRunner pid=82921)[0m Training Progress: 100%|██████████| 58/58 [4:57:03<00:00, 336.61s/it]Training Progress: 100%|██████████| 58/58 [4:57:03<00:00, 307.31s/it]
[36m(TaskRunner pid=82921)[0m Traceback (most recent call last):
[36m(TaskRunner pid=82921)[0m   File "/workspace/anaconda3/envs/verl_rl/lib/python3.12/site-packages/ray/_private/workers/default_worker.py", line 322, in <module>
[36m(TaskRunner pid=82921)[0m     worker.main_loop()
[36m(TaskRunner pid=82921)[0m   File "/workspace/anaconda3/envs/verl_rl/lib/python3.12/site-packages/ray/_private/worker.py", line 1031, in main_loop
[36m(TaskRunner pid=82921)[0m     self.core_worker.run_task_loop()
[36m(TaskRunner pid=82921)[0m   File "/workspace/anaconda3/envs/verl_rl/lib/python3.12/site-packages/torch/utils/data/_utils/signal_handling.py", line 73, in handler
[36m(TaskRunner pid=82921)[0m     _error_if_any_worker_fails()
[36m(TaskRunner pid=82921)[0m RuntimeError: DataLoader worker (pid 85689) is killed by signal: Killed. 
Exception ignored in: <function ResourceTracker.__del__ at 0x7dceeb78d760>
Traceback (most recent call last):
  File "/workspace/anaconda3/envs/verl_rl/lib/python3.12/site-packages/multiprocess/resource_tracker.py", line 80, in __del__
  File "/workspace/anaconda3/envs/verl_rl/lib/python3.12/site-packages/multiprocess/resource_tracker.py", line 89, in _stop
  File "/workspace/anaconda3/envs/verl_rl/lib/python3.12/site-packages/multiprocess/resource_tracker.py", line 102, in _stop_locked
AttributeError: '_thread.RLock' object has no attribute '_recursion_count'
