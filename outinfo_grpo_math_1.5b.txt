+ export RAY_TMPDIR=/workspace/tmp/
+ RAY_TMPDIR=/workspace/tmp/
+ export WANDB_API_KEY=37f371d2968f35d69749ee52089583eb8e1f0cab
+ WANDB_API_KEY=37f371d2968f35d69749ee52089583eb8e1f0cab
+ export WANDB_DIR=/workspace/verl_exp/
+ WANDB_DIR=/workspace/verl_exp/
+ export ACCELERATE_LOG_LEVEL=info
+ ACCELERATE_LOG_LEVEL=info
+ export HYDRA_FULL_ERROR=1
+ HYDRA_FULL_ERROR=1
+ export CUDA_VISIBLE_DEVICES=4,5,6,7
+ CUDA_VISIBLE_DEVICES=4,5,6,7
+ project_name=GRPO
+ exp_name=GRPO-Qwen2.5-1.5B
+ adv_estimator=grpo
+ use_kl_in_reward=False
+ use_kl_loss=True
+ kl_loss_coef=0.005
+ max_prompt_length=1024
+ max_response_length=4096
+ train_prompt_bsz=128
+ n_resp_per_prompt=8
+ train_prompt_mini_bsz=128
+ filter_overlong_prompts=True
+ loss_agg_mode=token-mean
+ RAY_ADDRESS=http://localhost:8265
+ WORKING_DIR=/workspace/verl
+ RUNTIME_ENV=/workspace/verl/verl/trainer/runtime_env.yaml
+ NNODES=1
+ RAY_DATA_HOME=/workspace/verl_exp
+ MODEL_PATH=/models/Qwen/Qwen2.5-1.5B
+ CKPTS_DIR=/workspace/verl_exp/ckpts/GRPO/GRPO-Qwen2.5-1.5B
+ TRAIN_FILE=/workspace/verl_exp/data/math/train.parquet
+ TEST_FILE=/workspace/verl_exp/data/math/test.parquet
+ temperature=1.0
+ top_p=1.0
+ top_k=-1
+ val_top_p=0.7
+ offload=True
+ tee grpo_qwen2.5_1.5b.log
+ PYTHONUNBUFFERED=1
+ python3 -m verl.trainer.main_ppo data.train_files=/workspace/verl_exp/data/math/train.parquet data.val_files=/workspace/verl_exp/data/math/test.parquet data.train_batch_size=128 data.max_prompt_length=1024 data.max_response_length=4096 data.filter_overlong_prompts=True data.truncation=error algorithm.adv_estimator=grpo algorithm.use_kl_in_reward=False actor_rollout_ref.model.path=/models/Qwen/Qwen2.5-1.5B actor_rollout_ref.actor.loss_agg_mode=token-mean actor_rollout_ref.model.use_fused_kernels=False actor_rollout_ref.actor.optim.lr=3e-6 actor_rollout_ref.actor.optim.warmup_style=cosine actor_rollout_ref.actor.optim.lr_warmup_steps_ratio=0.1 actor_rollout_ref.model.use_remove_padding=True actor_rollout_ref.actor.ppo_mini_batch_size=128 actor_rollout_ref.actor.ppo_micro_batch_size_per_gpu=4 actor_rollout_ref.actor.use_kl_loss=True actor_rollout_ref.actor.kl_loss_coef=0.005 actor_rollout_ref.actor.kl_loss_type=low_var_kl actor_rollout_ref.actor.entropy_coeff=0 actor_rollout_ref.model.enable_gradient_checkpointing=True actor_rollout_ref.actor.fsdp_config.param_offload=False actor_rollout_ref.actor.fsdp_config.optimizer_offload=False actor_rollout_ref.rollout.log_prob_micro_batch_size_per_gpu=4 actor_rollout_ref.rollout.name=vllm actor_rollout_ref.rollout.gpu_memory_utilization=0.80 actor_rollout_ref.rollout.n=8 actor_rollout_ref.ref.log_prob_micro_batch_size_per_gpu=4 actor_rollout_ref.ref.fsdp_config.param_offload=True trainer.critic_warmup=0 trainer.val_before_train=False trainer.n_gpus_per_node=4 trainer.nnodes=1 'trainer.logger=[console,wandb]' trainer.project_name=GRPO trainer.experiment_name=GRPO-Qwen2.5-1.5B trainer.save_freq=30 trainer.test_freq=10 trainer.default_local_dir=/workspace/verl_exp/ckpts/GRPO/GRPO-Qwen2.5-1.5B trainer.resume_mode=auto trainer.total_epochs=1
/workspace/anaconda3/envs/verl_rl/lib/python3.12/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]
ray init kwargs: {'num_cpus': None, 'runtime_env': {'env_vars': {'TOKENIZERS_PARALLELISM': 'true', 'NCCL_DEBUG': 'WARN', 'VLLM_LOGGING_LEVEL': 'WARN', 'VLLM_ALLOW_RUNTIME_LORA_UPDATING': 'true', 'VLLM_ALLREDUCE_USE_SYMM_MEM': '0', 'CUDA_DEVICE_MAX_CONNECTIONS': '1', 'NCCL_CUMEM_ENABLE': '0', 'RAY_DEBUG': '1'}, 'working_dir': None}}
2025-12-24 22:10:49,094	WARNING utils.py:458 -- Detecting docker specified CPUs. In previous versions of Ray, CPU detection in containers was incorrect. Please ensure that Ray has enough CPUs allocated. As a temporary workaround to revert to the prior behavior, set `RAY_USE_MULTIPROCESSING_CPU_COUNT=1` as an env var before starting Ray. Set the env var: `RAY_DISABLE_DOCKER_CPU_WARNING=1` to mute this warning.
2025-12-24 22:10:49,276	INFO worker.py:1998 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
/workspace/anaconda3/envs/verl_rl/lib/python3.12/site-packages/ray/_private/worker.py:2046: FutureWarning: Tip: In future versions of Ray, Ray will no longer override accelerator visible devices env var if num_gpus=0 or num_gpus=None (default). To enable this behavior and turn off this error message, set RAY_ACCEL_ENV_VAR_OVERRIDE_ON_ZERO=0
  warnings.warn(
[36m(pid=4953)[0m /workspace/anaconda3/envs/verl_rl/lib/python3.12/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
[36m(pid=4953)[0m   import pynvml  # type: ignore[import]
[36m(TaskRunner pid=4953)[0m TaskRunner hostname: 12b604b22a03, PID: 4953
[36m(TaskRunner pid=4953)[0m {'actor_rollout_ref': {'actor': {'_target_': 'verl.workers.config.FSDPActorConfig',
[36m(TaskRunner pid=4953)[0m                                  'checkpoint': {'_target_': 'verl.trainer.config.CheckpointConfig',
[36m(TaskRunner pid=4953)[0m                                                 'async_save': False,
[36m(TaskRunner pid=4953)[0m                                                 'load_contents': ['model',
[36m(TaskRunner pid=4953)[0m                                                                   'optimizer',
[36m(TaskRunner pid=4953)[0m                                                                   'extra'],
[36m(TaskRunner pid=4953)[0m                                                 'save_contents': ['model',
[36m(TaskRunner pid=4953)[0m                                                                   'optimizer',
[36m(TaskRunner pid=4953)[0m                                                                   'extra']},
[36m(TaskRunner pid=4953)[0m                                  'clip_ratio': 0.2,
[36m(TaskRunner pid=4953)[0m                                  'clip_ratio_c': 3.0,
[36m(TaskRunner pid=4953)[0m                                  'clip_ratio_high': 0.2,
[36m(TaskRunner pid=4953)[0m                                  'clip_ratio_low': 0.2,
[36m(TaskRunner pid=4953)[0m                                  'entropy_checkpointing': False,
[36m(TaskRunner pid=4953)[0m                                  'entropy_coeff': 0,
[36m(TaskRunner pid=4953)[0m                                  'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=4953)[0m                                  'freeze_vision_tower': False,
[36m(TaskRunner pid=4953)[0m                                  'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=4953)[0m                                                  'dtype': 'bfloat16',
[36m(TaskRunner pid=4953)[0m                                                  'entropy_checkpointing': False,
[36m(TaskRunner pid=4953)[0m                                                  'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=4953)[0m                                                  'forward_only': False,
[36m(TaskRunner pid=4953)[0m                                                  'forward_prefetch': False,
[36m(TaskRunner pid=4953)[0m                                                  'fsdp_size': -1,
[36m(TaskRunner pid=4953)[0m                                                  'model_dtype': 'fp32',
[36m(TaskRunner pid=4953)[0m                                                  'offload_policy': False,
[36m(TaskRunner pid=4953)[0m                                                  'optimizer_offload': False,
[36m(TaskRunner pid=4953)[0m                                                  'param_offload': False,
[36m(TaskRunner pid=4953)[0m                                                  'reshard_after_forward': True,
[36m(TaskRunner pid=4953)[0m                                                  'strategy': 'fsdp',
[36m(TaskRunner pid=4953)[0m                                                  'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=4953)[0m                                                  'use_orig_params': False,
[36m(TaskRunner pid=4953)[0m                                                  'use_torch_compile': True,
[36m(TaskRunner pid=4953)[0m                                                  'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=4953)[0m                                  'grad_clip': 1.0,
[36m(TaskRunner pid=4953)[0m                                  'kl_loss_coef': 0.005,
[36m(TaskRunner pid=4953)[0m                                  'kl_loss_type': 'low_var_kl',
[36m(TaskRunner pid=4953)[0m                                  'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=4953)[0m                                  'optim': {'_target_': 'verl.workers.config.FSDPOptimizerConfig',
[36m(TaskRunner pid=4953)[0m                                            'betas': [0.9, 0.999],
[36m(TaskRunner pid=4953)[0m                                            'clip_grad': 1.0,
[36m(TaskRunner pid=4953)[0m                                            'lr': 3e-06,
[36m(TaskRunner pid=4953)[0m                                            'lr_scheduler_type': 'constant',
[36m(TaskRunner pid=4953)[0m                                            'lr_warmup_steps': -1,
[36m(TaskRunner pid=4953)[0m                                            'lr_warmup_steps_ratio': 0.1,
[36m(TaskRunner pid=4953)[0m                                            'min_lr_ratio': 0.0,
[36m(TaskRunner pid=4953)[0m                                            'num_cycles': 0.5,
[36m(TaskRunner pid=4953)[0m                                            'optimizer': 'AdamW',
[36m(TaskRunner pid=4953)[0m                                            'optimizer_impl': 'torch.optim',
[36m(TaskRunner pid=4953)[0m                                            'override_optimizer_config': None,
[36m(TaskRunner pid=4953)[0m                                            'total_training_steps': -1,
[36m(TaskRunner pid=4953)[0m                                            'warmup_style': 'cosine',
[36m(TaskRunner pid=4953)[0m                                            'weight_decay': 0.01},
[36m(TaskRunner pid=4953)[0m                                  'policy_loss': {'_target_': 'verl.workers.config.PolicyLossConfig',
[36m(TaskRunner pid=4953)[0m                                                  'clip_cov_lb': 1.0,
[36m(TaskRunner pid=4953)[0m                                                  'clip_cov_ratio': 0.0002,
[36m(TaskRunner pid=4953)[0m                                                  'clip_cov_ub': 5.0,
[36m(TaskRunner pid=4953)[0m                                                  'kl_cov_ratio': 0.0002,
[36m(TaskRunner pid=4953)[0m                                                  'loss_mode': 'vanilla',
[36m(TaskRunner pid=4953)[0m                                                  'ppo_kl_coef': 0.1},
[36m(TaskRunner pid=4953)[0m                                  'ppo_epochs': 1,
[36m(TaskRunner pid=4953)[0m                                  'ppo_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=4953)[0m                                  'ppo_micro_batch_size': None,
[36m(TaskRunner pid=4953)[0m                                  'ppo_micro_batch_size_per_gpu': 4,
[36m(TaskRunner pid=4953)[0m                                  'ppo_mini_batch_size': 128,
[36m(TaskRunner pid=4953)[0m                                  'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=4953)[0m                                               'all_ranks': False,
[36m(TaskRunner pid=4953)[0m                                               'enable': False,
[36m(TaskRunner pid=4953)[0m                                               'ranks': [],
[36m(TaskRunner pid=4953)[0m                                               'save_path': 'outputs/profile',
[36m(TaskRunner pid=4953)[0m                                               'tool': None,
[36m(TaskRunner pid=4953)[0m                                               'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=4953)[0m                                                                       'analysis': True,
[36m(TaskRunner pid=4953)[0m                                                                       'contents': [],
[36m(TaskRunner pid=4953)[0m                                                                       'discrete': False,
[36m(TaskRunner pid=4953)[0m                                                                       'level': 'level1'},
[36m(TaskRunner pid=4953)[0m                                                               'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=4953)[0m                                                                        'discrete': False},
[36m(TaskRunner pid=4953)[0m                                                               'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=4953)[0m                                                                         'step_end': None,
[36m(TaskRunner pid=4953)[0m                                                                         'step_start': 0},
[36m(TaskRunner pid=4953)[0m                                                               'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=4953)[0m                                                                                'stack_depth': 32,
[36m(TaskRunner pid=4953)[0m                                                                                'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=4953)[0m                                  'shuffle': False,
[36m(TaskRunner pid=4953)[0m                                  'strategy': 'fsdp',
[36m(TaskRunner pid=4953)[0m                                  'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=4953)[0m                                  'use_dynamic_bsz': False,
[36m(TaskRunner pid=4953)[0m                                  'use_fused_kernels': False,
[36m(TaskRunner pid=4953)[0m                                  'use_kl_loss': True,
[36m(TaskRunner pid=4953)[0m                                  'use_remove_padding': True,
[36m(TaskRunner pid=4953)[0m                                  'use_torch_compile': True},
[36m(TaskRunner pid=4953)[0m                        'hybrid_engine': True,
[36m(TaskRunner pid=4953)[0m                        'model': {'_target_': 'verl.workers.config.HFModelConfig',
[36m(TaskRunner pid=4953)[0m                                  'custom_chat_template': None,
[36m(TaskRunner pid=4953)[0m                                  'enable_activation_offload': False,
[36m(TaskRunner pid=4953)[0m                                  'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=4953)[0m                                  'exclude_modules': None,
[36m(TaskRunner pid=4953)[0m                                  'external_lib': None,
[36m(TaskRunner pid=4953)[0m                                  'fused_kernel_options': {'impl_backend': 'torch'},
[36m(TaskRunner pid=4953)[0m                                  'hf_config_path': None,
[36m(TaskRunner pid=4953)[0m                                  'lora_adapter_path': None,
[36m(TaskRunner pid=4953)[0m                                  'lora_alpha': 16,
[36m(TaskRunner pid=4953)[0m                                  'lora_rank': 0,
[36m(TaskRunner pid=4953)[0m                                  'override_config': {},
[36m(TaskRunner pid=4953)[0m                                  'path': '/models/Qwen/Qwen2.5-1.5B',
[36m(TaskRunner pid=4953)[0m                                  'target_modules': 'all-linear',
[36m(TaskRunner pid=4953)[0m                                  'tokenizer_path': None,
[36m(TaskRunner pid=4953)[0m                                  'trust_remote_code': False,
[36m(TaskRunner pid=4953)[0m                                  'use_fused_kernels': False,
[36m(TaskRunner pid=4953)[0m                                  'use_liger': False,
[36m(TaskRunner pid=4953)[0m                                  'use_remove_padding': True,
[36m(TaskRunner pid=4953)[0m                                  'use_shm': False},
[36m(TaskRunner pid=4953)[0m                        'nccl_timeout': 600,
[36m(TaskRunner pid=4953)[0m                        'ref': {'entropy_checkpointing': False,
[36m(TaskRunner pid=4953)[0m                                'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=4953)[0m                                'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=4953)[0m                                                'dtype': 'bfloat16',
[36m(TaskRunner pid=4953)[0m                                                'entropy_checkpointing': False,
[36m(TaskRunner pid=4953)[0m                                                'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=4953)[0m                                                'forward_only': False,
[36m(TaskRunner pid=4953)[0m                                                'forward_prefetch': False,
[36m(TaskRunner pid=4953)[0m                                                'fsdp_size': -1,
[36m(TaskRunner pid=4953)[0m                                                'model_dtype': 'fp32',
[36m(TaskRunner pid=4953)[0m                                                'offload_policy': False,
[36m(TaskRunner pid=4953)[0m                                                'optimizer_offload': False,
[36m(TaskRunner pid=4953)[0m                                                'param_offload': True,
[36m(TaskRunner pid=4953)[0m                                                'reshard_after_forward': True,
[36m(TaskRunner pid=4953)[0m                                                'strategy': 'fsdp',
[36m(TaskRunner pid=4953)[0m                                                'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=4953)[0m                                                'use_orig_params': False,
[36m(TaskRunner pid=4953)[0m                                                'use_torch_compile': True,
[36m(TaskRunner pid=4953)[0m                                                'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=4953)[0m                                'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=4953)[0m                                'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=4953)[0m                                'log_prob_micro_batch_size_per_gpu': 4,
[36m(TaskRunner pid=4953)[0m                                'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=4953)[0m                                'model': None,
[36m(TaskRunner pid=4953)[0m                                'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=4953)[0m                                             'all_ranks': False,
[36m(TaskRunner pid=4953)[0m                                             'enable': False,
[36m(TaskRunner pid=4953)[0m                                             'ranks': [],
[36m(TaskRunner pid=4953)[0m                                             'save_path': 'outputs/profile',
[36m(TaskRunner pid=4953)[0m                                             'tool': None,
[36m(TaskRunner pid=4953)[0m                                             'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=4953)[0m                                                                     'analysis': True,
[36m(TaskRunner pid=4953)[0m                                                                     'contents': [],
[36m(TaskRunner pid=4953)[0m                                                                     'discrete': False,
[36m(TaskRunner pid=4953)[0m                                                                     'level': 'level1'},
[36m(TaskRunner pid=4953)[0m                                                             'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=4953)[0m                                                                      'discrete': False},
[36m(TaskRunner pid=4953)[0m                                                             'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=4953)[0m                                                                       'step_end': None,
[36m(TaskRunner pid=4953)[0m                                                                       'step_start': 0},
[36m(TaskRunner pid=4953)[0m                                                             'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=4953)[0m                                                                              'stack_depth': 32,
[36m(TaskRunner pid=4953)[0m                                                                              'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=4953)[0m                                'strategy': 'fsdp',
[36m(TaskRunner pid=4953)[0m                                'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=4953)[0m                                'use_torch_compile': True},
[36m(TaskRunner pid=4953)[0m                        'rollout': {'_target_': 'verl.workers.config.RolloutConfig',
[36m(TaskRunner pid=4953)[0m                                    'agent': {'_target_': 'verl.workers.config.AgentLoopConfig',
[36m(TaskRunner pid=4953)[0m                                              'agent_loop_config_path': None,
[36m(TaskRunner pid=4953)[0m                                              'custom_async_server': {'_target_': 'verl.workers.config.CustomAsyncServerConfig',
[36m(TaskRunner pid=4953)[0m                                                                      'name': None,
[36m(TaskRunner pid=4953)[0m                                                                      'path': None},
[36m(TaskRunner pid=4953)[0m                                              'default_agent_loop': 'single_turn_agent',
[36m(TaskRunner pid=4953)[0m                                              'num_workers': 8},
[36m(TaskRunner pid=4953)[0m                                    'calculate_log_probs': False,
[36m(TaskRunner pid=4953)[0m                                    'cudagraph_capture_sizes': None,
[36m(TaskRunner pid=4953)[0m                                    'data_parallel_size': 1,
[36m(TaskRunner pid=4953)[0m                                    'disable_log_stats': True,
[36m(TaskRunner pid=4953)[0m                                    'do_sample': True,
[36m(TaskRunner pid=4953)[0m                                    'dtype': 'bfloat16',
[36m(TaskRunner pid=4953)[0m                                    'enable_chunked_prefill': True,
[36m(TaskRunner pid=4953)[0m                                    'enable_prefix_caching': True,
[36m(TaskRunner pid=4953)[0m                                    'enforce_eager': False,
[36m(TaskRunner pid=4953)[0m                                    'engine_kwargs': {'sglang': {}, 'vllm': {}},
[36m(TaskRunner pid=4953)[0m                                    'expert_parallel_size': 1,
[36m(TaskRunner pid=4953)[0m                                    'free_cache_engine': True,
[36m(TaskRunner pid=4953)[0m                                    'gpu_memory_utilization': 0.8,
[36m(TaskRunner pid=4953)[0m                                    'ignore_eos': False,
[36m(TaskRunner pid=4953)[0m                                    'layered_summon': False,
[36m(TaskRunner pid=4953)[0m                                    'load_format': 'dummy',
[36m(TaskRunner pid=4953)[0m                                    'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=4953)[0m                                    'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=4953)[0m                                    'log_prob_micro_batch_size_per_gpu': 4,
[36m(TaskRunner pid=4953)[0m                                    'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=4953)[0m                                    'max_model_len': None,
[36m(TaskRunner pid=4953)[0m                                    'max_num_batched_tokens': 8192,
[36m(TaskRunner pid=4953)[0m                                    'max_num_seqs': 1024,
[36m(TaskRunner pid=4953)[0m                                    'mode': 'sync',
[36m(TaskRunner pid=4953)[0m                                    'multi_stage_wake_up': False,
[36m(TaskRunner pid=4953)[0m                                    'multi_turn': {'_target_': 'verl.workers.config.MultiTurnConfig',
[36m(TaskRunner pid=4953)[0m                                                   'enable': False,
[36m(TaskRunner pid=4953)[0m                                                   'format': 'hermes',
[36m(TaskRunner pid=4953)[0m                                                   'interaction_config_path': None,
[36m(TaskRunner pid=4953)[0m                                                   'max_assistant_turns': None,
[36m(TaskRunner pid=4953)[0m                                                   'max_parallel_calls': 1,
[36m(TaskRunner pid=4953)[0m                                                   'max_tool_response_length': 256,
[36m(TaskRunner pid=4953)[0m                                                   'max_user_turns': None,
[36m(TaskRunner pid=4953)[0m                                                   'num_repeat_rollouts': None,
[36m(TaskRunner pid=4953)[0m                                                   'tokenization_sanity_check_mode': 'strict',
[36m(TaskRunner pid=4953)[0m                                                   'tool_config_path': None,
[36m(TaskRunner pid=4953)[0m                                                   'tool_response_truncate_side': 'middle',
[36m(TaskRunner pid=4953)[0m                                                   'use_inference_chat_template': False},
[36m(TaskRunner pid=4953)[0m                                    'n': 8,
[36m(TaskRunner pid=4953)[0m                                    'name': 'vllm',
[36m(TaskRunner pid=4953)[0m                                    'over_sample_rate': 0,
[36m(TaskRunner pid=4953)[0m                                    'pipeline_model_parallel_size': 1,
[36m(TaskRunner pid=4953)[0m                                    'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=4953)[0m                                                 'all_ranks': False,
[36m(TaskRunner pid=4953)[0m                                                 'enable': False,
[36m(TaskRunner pid=4953)[0m                                                 'ranks': [],
[36m(TaskRunner pid=4953)[0m                                                 'save_path': 'outputs/profile',
[36m(TaskRunner pid=4953)[0m                                                 'tool': None,
[36m(TaskRunner pid=4953)[0m                                                 'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=4953)[0m                                                                         'analysis': True,
[36m(TaskRunner pid=4953)[0m                                                                         'contents': [],
[36m(TaskRunner pid=4953)[0m                                                                         'discrete': False,
[36m(TaskRunner pid=4953)[0m                                                                         'level': 'level1'},
[36m(TaskRunner pid=4953)[0m                                                                 'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=4953)[0m                                                                          'discrete': False},
[36m(TaskRunner pid=4953)[0m                                                                 'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=4953)[0m                                                                           'step_end': None,
[36m(TaskRunner pid=4953)[0m                                                                           'step_start': 0},
[36m(TaskRunner pid=4953)[0m                                                                 'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=4953)[0m                                                                                  'stack_depth': 32,
[36m(TaskRunner pid=4953)[0m                                                                                  'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=4953)[0m                                    'prometheus': {'_target_': 'verl.workers.config.PrometheusConfig',
[36m(TaskRunner pid=4953)[0m                                                   'enable': False,
[36m(TaskRunner pid=4953)[0m                                                   'file': '/tmp/ray/session_latest/metrics/prometheus/prometheus.yml',
[36m(TaskRunner pid=4953)[0m                                                   'port': 9090,
[36m(TaskRunner pid=4953)[0m                                                   'served_model_name': '/models/Qwen/Qwen2.5-1.5B'},
[36m(TaskRunner pid=4953)[0m                                    'prompt_length': 1024,
[36m(TaskRunner pid=4953)[0m                                    'response_length': 4096,
[36m(TaskRunner pid=4953)[0m                                    'skip_dump_dir': '/tmp/rollout_dump',
[36m(TaskRunner pid=4953)[0m                                    'skip_rollout': False,
[36m(TaskRunner pid=4953)[0m                                    'skip_tokenizer_init': True,
[36m(TaskRunner pid=4953)[0m                                    'temperature': 1.0,
[36m(TaskRunner pid=4953)[0m                                    'tensor_model_parallel_size': 2,
[36m(TaskRunner pid=4953)[0m                                    'top_k': -1,
[36m(TaskRunner pid=4953)[0m                                    'top_p': 1,
[36m(TaskRunner pid=4953)[0m                                    'trace': {'_target_': 'verl.workers.config.TraceConfig',
[36m(TaskRunner pid=4953)[0m                                              'backend': None,
[36m(TaskRunner pid=4953)[0m                                              'token2text': False},
[36m(TaskRunner pid=4953)[0m                                    'update_weights_bucket_megabytes': 512,
[36m(TaskRunner pid=4953)[0m                                    'val_kwargs': {'_target_': 'verl.workers.config.SamplingConfig',
[36m(TaskRunner pid=4953)[0m                                                   'do_sample': False,
[36m(TaskRunner pid=4953)[0m                                                   'n': 1,
[36m(TaskRunner pid=4953)[0m                                                   'temperature': 0,
[36m(TaskRunner pid=4953)[0m                                                   'top_k': -1,
[36m(TaskRunner pid=4953)[0m                                                   'top_p': 1.0}}},
[36m(TaskRunner pid=4953)[0m  'algorithm': {'_target_': 'verl.trainer.config.AlgoConfig',
[36m(TaskRunner pid=4953)[0m                'adv_estimator': 'grpo',
[36m(TaskRunner pid=4953)[0m                'gamma': 1.0,
[36m(TaskRunner pid=4953)[0m                'kl_ctrl': {'_target_': 'verl.trainer.config.KLControlConfig',
[36m(TaskRunner pid=4953)[0m                            'horizon': 10000,
[36m(TaskRunner pid=4953)[0m                            'kl_coef': 0.001,
[36m(TaskRunner pid=4953)[0m                            'target_kl': 0.1,
[36m(TaskRunner pid=4953)[0m                            'type': 'fixed'},
[36m(TaskRunner pid=4953)[0m                'kl_penalty': 'kl',
[36m(TaskRunner pid=4953)[0m                'lam': 1.0,
[36m(TaskRunner pid=4953)[0m                'metric_weights': {'mean_logprob': 1.0,
[36m(TaskRunner pid=4953)[0m                                   'min_logprob': 1.0,
[36m(TaskRunner pid=4953)[0m                                   'tail_mean_logprob': 2.0},
[36m(TaskRunner pid=4953)[0m                'norm_adv_by_std_in_grpo': True,
[36m(TaskRunner pid=4953)[0m                'pf_ppo': {'reweight_method': 'pow', 'weight_pow': 2.0},
[36m(TaskRunner pid=4953)[0m                'rollout_correction': {'bypass_mode': False,
[36m(TaskRunner pid=4953)[0m                                       'rollout_is': None,
[36m(TaskRunner pid=4953)[0m                                       'rollout_is_batch_normalize': False,
[36m(TaskRunner pid=4953)[0m                                       'rollout_is_threshold': 2.0,
[36m(TaskRunner pid=4953)[0m                                       'rollout_rs': None,
[36m(TaskRunner pid=4953)[0m                                       'rollout_rs_threshold': None,
[36m(TaskRunner pid=4953)[0m                                       'rollout_rs_threshold_lower': None,
[36m(TaskRunner pid=4953)[0m                                       'rollout_token_veto_threshold': None,
[36m(TaskRunner pid=4953)[0m                                       'use_policy_gradient': False},
[36m(TaskRunner pid=4953)[0m                'rrf_k': 1.0,
[36m(TaskRunner pid=4953)[0m                'tail_frac': 0.1,
[36m(TaskRunner pid=4953)[0m                'use_kl_in_reward': False,
[36m(TaskRunner pid=4953)[0m                'use_pf_ppo': False},
[36m(TaskRunner pid=4953)[0m  'critic': {'_target_': 'verl.workers.config.FSDPCriticConfig',
[36m(TaskRunner pid=4953)[0m             'checkpoint': {'_target_': 'verl.trainer.config.CheckpointConfig',
[36m(TaskRunner pid=4953)[0m                            'async_save': False,
[36m(TaskRunner pid=4953)[0m                            'load_contents': ['model', 'optimizer', 'extra'],
[36m(TaskRunner pid=4953)[0m                            'save_contents': ['model', 'optimizer', 'extra']},
[36m(TaskRunner pid=4953)[0m             'cliprange_value': 0.5,
[36m(TaskRunner pid=4953)[0m             'enable': None,
[36m(TaskRunner pid=4953)[0m             'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=4953)[0m             'forward_micro_batch_size': None,
[36m(TaskRunner pid=4953)[0m             'forward_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=4953)[0m             'grad_clip': 1.0,
[36m(TaskRunner pid=4953)[0m             'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=4953)[0m             'model': {'_target_': 'verl.workers.config.FSDPCriticModelCfg',
[36m(TaskRunner pid=4953)[0m                       'enable_activation_offload': False,
[36m(TaskRunner pid=4953)[0m                       'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=4953)[0m                       'external_lib': None,
[36m(TaskRunner pid=4953)[0m                       'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=4953)[0m                                       'dtype': 'bfloat16',
[36m(TaskRunner pid=4953)[0m                                       'entropy_checkpointing': False,
[36m(TaskRunner pid=4953)[0m                                       'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=4953)[0m                                       'forward_only': False,
[36m(TaskRunner pid=4953)[0m                                       'forward_prefetch': False,
[36m(TaskRunner pid=4953)[0m                                       'fsdp_size': -1,
[36m(TaskRunner pid=4953)[0m                                       'model_dtype': 'fp32',
[36m(TaskRunner pid=4953)[0m                                       'offload_policy': False,
[36m(TaskRunner pid=4953)[0m                                       'optimizer_offload': False,
[36m(TaskRunner pid=4953)[0m                                       'param_offload': False,
[36m(TaskRunner pid=4953)[0m                                       'reshard_after_forward': True,
[36m(TaskRunner pid=4953)[0m                                       'strategy': 'fsdp',
[36m(TaskRunner pid=4953)[0m                                       'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=4953)[0m                                       'use_orig_params': False,
[36m(TaskRunner pid=4953)[0m                                       'use_torch_compile': True,
[36m(TaskRunner pid=4953)[0m                                       'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=4953)[0m                       'lora_alpha': 16,
[36m(TaskRunner pid=4953)[0m                       'lora_rank': 0,
[36m(TaskRunner pid=4953)[0m                       'override_config': {},
[36m(TaskRunner pid=4953)[0m                       'path': '~/models/deepseek-llm-7b-chat',
[36m(TaskRunner pid=4953)[0m                       'target_modules': 'all-linear',
[36m(TaskRunner pid=4953)[0m                       'tokenizer_path': '/models/Qwen/Qwen2.5-1.5B',
[36m(TaskRunner pid=4953)[0m                       'trust_remote_code': False,
[36m(TaskRunner pid=4953)[0m                       'use_remove_padding': False,
[36m(TaskRunner pid=4953)[0m                       'use_shm': False},
[36m(TaskRunner pid=4953)[0m             'optim': {'_target_': 'verl.workers.config.FSDPOptimizerConfig',
[36m(TaskRunner pid=4953)[0m                       'betas': [0.9, 0.999],
[36m(TaskRunner pid=4953)[0m                       'clip_grad': 1.0,
[36m(TaskRunner pid=4953)[0m                       'lr': 1e-05,
[36m(TaskRunner pid=4953)[0m                       'lr_scheduler_type': 'constant',
[36m(TaskRunner pid=4953)[0m                       'lr_warmup_steps': -1,
[36m(TaskRunner pid=4953)[0m                       'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=4953)[0m                       'min_lr_ratio': 0.0,
[36m(TaskRunner pid=4953)[0m                       'num_cycles': 0.5,
[36m(TaskRunner pid=4953)[0m                       'optimizer': 'AdamW',
[36m(TaskRunner pid=4953)[0m                       'optimizer_impl': 'torch.optim',
[36m(TaskRunner pid=4953)[0m                       'override_optimizer_config': None,
[36m(TaskRunner pid=4953)[0m                       'total_training_steps': -1,
[36m(TaskRunner pid=4953)[0m                       'warmup_style': None,
[36m(TaskRunner pid=4953)[0m                       'weight_decay': 0.01},
[36m(TaskRunner pid=4953)[0m             'ppo_epochs': 1,
[36m(TaskRunner pid=4953)[0m             'ppo_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=4953)[0m             'ppo_micro_batch_size': None,
[36m(TaskRunner pid=4953)[0m             'ppo_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=4953)[0m             'ppo_mini_batch_size': 128,
[36m(TaskRunner pid=4953)[0m             'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=4953)[0m                          'all_ranks': False,
[36m(TaskRunner pid=4953)[0m                          'enable': False,
[36m(TaskRunner pid=4953)[0m                          'ranks': [],
[36m(TaskRunner pid=4953)[0m                          'save_path': 'outputs/profile',
[36m(TaskRunner pid=4953)[0m                          'tool': None,
[36m(TaskRunner pid=4953)[0m                          'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=4953)[0m                                                  'analysis': True,
[36m(TaskRunner pid=4953)[0m                                                  'contents': [],
[36m(TaskRunner pid=4953)[0m                                                  'discrete': False,
[36m(TaskRunner pid=4953)[0m                                                  'level': 'level1'},
[36m(TaskRunner pid=4953)[0m                                          'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=4953)[0m                                                   'discrete': False},
[36m(TaskRunner pid=4953)[0m                                          'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=4953)[0m                                                    'step_end': None,
[36m(TaskRunner pid=4953)[0m                                                    'step_start': 0},
[36m(TaskRunner pid=4953)[0m                                          'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=4953)[0m                                                           'stack_depth': 32,
[36m(TaskRunner pid=4953)[0m                                                           'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=4953)[0m             'rollout_n': 8,
[36m(TaskRunner pid=4953)[0m             'shuffle': False,
[36m(TaskRunner pid=4953)[0m             'strategy': 'fsdp',
[36m(TaskRunner pid=4953)[0m             'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=4953)[0m             'use_dynamic_bsz': False},
[36m(TaskRunner pid=4953)[0m  'custom_reward_function': {'name': 'compute_score', 'path': None},
[36m(TaskRunner pid=4953)[0m  'data': {'apply_chat_template_kwargs': {},
[36m(TaskRunner pid=4953)[0m           'custom_cls': {'name': None, 'path': None},
[36m(TaskRunner pid=4953)[0m           'datagen': {'name': None, 'path': None},
[36m(TaskRunner pid=4953)[0m           'dataloader_num_workers': 8,
[36m(TaskRunner pid=4953)[0m           'filter_overlong_prompts': True,
[36m(TaskRunner pid=4953)[0m           'filter_overlong_prompts_workers': 1,
[36m(TaskRunner pid=4953)[0m           'image_key': 'images',
[36m(TaskRunner pid=4953)[0m           'image_patch_size': 14,
[36m(TaskRunner pid=4953)[0m           'max_prompt_length': 1024,
[36m(TaskRunner pid=4953)[0m           'max_response_length': 4096,
[36m(TaskRunner pid=4953)[0m           'prompt_key': 'prompt',
[36m(TaskRunner pid=4953)[0m           'return_full_prompt': False,
[36m(TaskRunner pid=4953)[0m           'return_multi_modal_inputs': True,
[36m(TaskRunner pid=4953)[0m           'return_raw_chat': False,
[36m(TaskRunner pid=4953)[0m           'return_raw_input_ids': False,
[36m(TaskRunner pid=4953)[0m           'reward_fn_key': 'data_source',
[36m(TaskRunner pid=4953)[0m           'sampler': {'class_name': None, 'class_path': None},
[36m(TaskRunner pid=4953)[0m           'seed': None,
[36m(TaskRunner pid=4953)[0m           'shuffle': True,
[36m(TaskRunner pid=4953)[0m           'tokenizer': None,
[36m(TaskRunner pid=4953)[0m           'tool_config_path': None,
[36m(TaskRunner pid=4953)[0m           'train_batch_size': 128,
[36m(TaskRunner pid=4953)[0m           'train_files': '/workspace/verl_exp/data/math/train.parquet',
[36m(TaskRunner pid=4953)[0m           'train_max_samples': -1,
[36m(TaskRunner pid=4953)[0m           'truncation': 'error',
[36m(TaskRunner pid=4953)[0m           'trust_remote_code': False,
[36m(TaskRunner pid=4953)[0m           'use_shm': False,
[36m(TaskRunner pid=4953)[0m           'val_batch_size': None,
[36m(TaskRunner pid=4953)[0m           'val_files': '/workspace/verl_exp/data/math/test.parquet',
[36m(TaskRunner pid=4953)[0m           'val_max_samples': -1,
[36m(TaskRunner pid=4953)[0m           'validation_shuffle': False,
[36m(TaskRunner pid=4953)[0m           'video_key': 'videos'},
[36m(TaskRunner pid=4953)[0m  'global_profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=4953)[0m                      'global_tool_config': {'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=4953)[0m                                                      'controller_nsight_options': {'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=4953)[0m                                                                                    'cuda-memory-usage': 'true',
[36m(TaskRunner pid=4953)[0m                                                                                    'trace': 'cuda,nvtx,cublas,ucx'},
[36m(TaskRunner pid=4953)[0m                                                      'discrete': False,
[36m(TaskRunner pid=4953)[0m                                                      'worker_nsight_options': {'capture-range': 'cudaProfilerApi',
[36m(TaskRunner pid=4953)[0m                                                                                'capture-range-end': None,
[36m(TaskRunner pid=4953)[0m                                                                                'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=4953)[0m                                                                                'cuda-memory-usage': 'true',
[36m(TaskRunner pid=4953)[0m                                                                                'kill': 'none',
[36m(TaskRunner pid=4953)[0m                                                                                'trace': 'cuda,nvtx,cublas,ucx'}},
[36m(TaskRunner pid=4953)[0m                                             'torch_memory': {'context': 'all',
[36m(TaskRunner pid=4953)[0m                                                              'kw_args': {},
[36m(TaskRunner pid=4953)[0m                                                              'stack_depth': 32,
[36m(TaskRunner pid=4953)[0m                                                              'stacks': 'all',
[36m(TaskRunner pid=4953)[0m                                                              'trace_alloc_max_entries': 100000}},
[36m(TaskRunner pid=4953)[0m                      'profile_continuous_steps': False,
[36m(TaskRunner pid=4953)[0m                      'save_path': 'outputs/profile',
[36m(TaskRunner pid=4953)[0m                      'steps': None,
[36m(TaskRunner pid=4953)[0m                      'tool': None},
[36m(TaskRunner pid=4953)[0m  'ray_kwargs': {'ray_init': {'num_cpus': None}, 'timeline_json_file': None},
[36m(TaskRunner pid=4953)[0m  'reward_model': {'enable': False,
[36m(TaskRunner pid=4953)[0m                   'enable_resource_pool': False,
[36m(TaskRunner pid=4953)[0m                   'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=4953)[0m                   'launch_reward_fn_async': False,
[36m(TaskRunner pid=4953)[0m                   'max_length': None,
[36m(TaskRunner pid=4953)[0m                   'micro_batch_size': None,
[36m(TaskRunner pid=4953)[0m                   'micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=4953)[0m                   'model': {'external_lib': None,
[36m(TaskRunner pid=4953)[0m                             'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=4953)[0m                                             'forward_prefetch': False,
[36m(TaskRunner pid=4953)[0m                                             'fsdp_size': -1,
[36m(TaskRunner pid=4953)[0m                                             'param_offload': False,
[36m(TaskRunner pid=4953)[0m                                             'reshard_after_forward': True,
[36m(TaskRunner pid=4953)[0m                                             'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=4953)[0m                             'input_tokenizer': '/models/Qwen/Qwen2.5-1.5B',
[36m(TaskRunner pid=4953)[0m                             'path': '~/models/FsfairX-LLaMA3-RM-v0.1',
[36m(TaskRunner pid=4953)[0m                             'trust_remote_code': False,
[36m(TaskRunner pid=4953)[0m                             'use_fused_kernels': False,
[36m(TaskRunner pid=4953)[0m                             'use_remove_padding': False,
[36m(TaskRunner pid=4953)[0m                             'use_shm': False},
[36m(TaskRunner pid=4953)[0m                   'n_gpus_per_node': 0,
[36m(TaskRunner pid=4953)[0m                   'nnodes': 0,
[36m(TaskRunner pid=4953)[0m                   'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=4953)[0m                                'all_ranks': False,
[36m(TaskRunner pid=4953)[0m                                'enable': False,
[36m(TaskRunner pid=4953)[0m                                'ranks': [],
[36m(TaskRunner pid=4953)[0m                                'save_path': 'outputs/profile',
[36m(TaskRunner pid=4953)[0m                                'tool': None,
[36m(TaskRunner pid=4953)[0m                                'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=4953)[0m                                                        'analysis': True,
[36m(TaskRunner pid=4953)[0m                                                        'contents': [],
[36m(TaskRunner pid=4953)[0m                                                        'discrete': False,
[36m(TaskRunner pid=4953)[0m                                                        'level': 'level1'},
[36m(TaskRunner pid=4953)[0m                                                'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=4953)[0m                                                         'discrete': False},
[36m(TaskRunner pid=4953)[0m                                                'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=4953)[0m                                                          'step_end': None,
[36m(TaskRunner pid=4953)[0m                                                          'step_start': 0},
[36m(TaskRunner pid=4953)[0m                                                'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=4953)[0m                                                                 'stack_depth': 32,
[36m(TaskRunner pid=4953)[0m                                                                 'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=4953)[0m                   'reward_manager': 'naive',
[36m(TaskRunner pid=4953)[0m                   'sandbox_fusion': {'max_concurrent': 64,
[36m(TaskRunner pid=4953)[0m                                      'memory_limit_mb': 1024,
[36m(TaskRunner pid=4953)[0m                                      'url': None},
[36m(TaskRunner pid=4953)[0m                   'strategy': 'fsdp',
[36m(TaskRunner pid=4953)[0m                   'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=4953)[0m                   'use_dynamic_bsz': False},
[36m(TaskRunner pid=4953)[0m  'trainer': {'balance_batch': True,
[36m(TaskRunner pid=4953)[0m              'critic_warmup': 0,
[36m(TaskRunner pid=4953)[0m              'default_hdfs_dir': None,
[36m(TaskRunner pid=4953)[0m              'default_local_dir': '/workspace/verl_exp/ckpts/GRPO/GRPO-Qwen2.5-1.5B',
[36m(TaskRunner pid=4953)[0m              'del_local_ckpt_after_load': False,
[36m(TaskRunner pid=4953)[0m              'device': 'cuda',
[36m(TaskRunner pid=4953)[0m              'esi_redundant_time': 0,
[36m(TaskRunner pid=4953)[0m              'experiment_name': 'GRPO-Qwen2.5-1.5B',
[36m(TaskRunner pid=4953)[0m              'log_val_generations': 0,
[36m(TaskRunner pid=4953)[0m              'logger': ['console', 'wandb'],
[36m(TaskRunner pid=4953)[0m              'max_actor_ckpt_to_keep': None,
[36m(TaskRunner pid=4953)[0m              'max_critic_ckpt_to_keep': None,
[36m(TaskRunner pid=4953)[0m              'n_gpus_per_node': 4,
[36m(TaskRunner pid=4953)[0m              'nnodes': 1,
[36m(TaskRunner pid=4953)[0m              'project_name': 'GRPO',
[36m(TaskRunner pid=4953)[0m              'ray_wait_register_center_timeout': 300,
[36m(TaskRunner pid=4953)[0m              'resume_from_path': None,
[36m(TaskRunner pid=4953)[0m              'resume_mode': 'auto',
[36m(TaskRunner pid=4953)[0m              'rollout_data_dir': None,
[36m(TaskRunner pid=4953)[0m              'save_freq': 30,
[36m(TaskRunner pid=4953)[0m              'test_freq': 10,
[36m(TaskRunner pid=4953)[0m              'total_epochs': 1,
[36m(TaskRunner pid=4953)[0m              'total_training_steps': None,
[36m(TaskRunner pid=4953)[0m              'use_legacy_worker_impl': 'auto',
[36m(TaskRunner pid=4953)[0m              'val_before_train': False,
[36m(TaskRunner pid=4953)[0m              'val_only': False,
[36m(TaskRunner pid=4953)[0m              'validation_data_dir': None},
[36m(TaskRunner pid=4953)[0m  'transfer_queue': {'enable': False}}
[36m(TaskRunner pid=4953)[0m /workspace/verl/verl/trainer/main_ppo.py:274: UserWarning: Disabled critic as algorithm.adv_estimator != gae. If it is not intended, please set critic.enable=True
[36m(TaskRunner pid=4953)[0m   use_critic=need_critic(config),
[36m(TaskRunner pid=4953)[0m /workspace/verl/verl/utils/profiler/config.py:49: UserWarning: Torch profiler tool config is not fully supported now.
[36m(TaskRunner pid=4953)[0m   warnings.warn("Torch profiler tool config is not fully supported now.", stacklevel=1)
[36m(TaskRunner pid=4953)[0m [validate_config] All configuration checks passed successfully!
[36m(TaskRunner pid=4953)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=4953)[0m dataset len: 7500
[36m(TaskRunner pid=4953)[0m Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=4953)[0m WARNING:2025-12-24 22:10:57,299:Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=4953)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1):   0%|          | 0/7500 [00:00<?, ? examples/s]
[36m(TaskRunner pid=4953)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1):  13%|█▎        | 1000/7500 [00:00<00:06, 1031.22 examples/s]
[36m(TaskRunner pid=4953)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1):  27%|██▋       | 2000/7500 [00:01<00:03, 1596.57 examples/s]
[36m(TaskRunner pid=4953)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1):  40%|████      | 3000/7500 [00:01<00:02, 1951.05 examples/s]
[36m(TaskRunner pid=4953)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1):  53%|█████▎    | 4000/7500 [00:02<00:01, 2199.48 examples/s]
[36m(TaskRunner pid=4953)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1):  67%|██████▋   | 5000/7500 [00:02<00:01, 2455.41 examples/s]
[36m(TaskRunner pid=4953)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1):  80%|████████  | 6000/7500 [00:02<00:00, 2511.22 examples/s]
[36m(TaskRunner pid=4953)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1):  93%|█████████▎| 7000/7500 [00:03<00:00, 2557.11 examples/s]
[36m(TaskRunner pid=4953)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1): 100%|██████████| 7500/7500 [00:03<00:00, 2561.53 examples/s]
[36m(TaskRunner pid=4953)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1): 100%|██████████| 7500/7500 [00:03<00:00, 2152.90 examples/s]
[36m(TaskRunner pid=4953)[0m filter dataset len: 7492
[36m(TaskRunner pid=4953)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=4953)[0m dataset len: 5000
[36m(TaskRunner pid=4953)[0m Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=4953)[0m WARNING:2025-12-24 22:11:01,208:Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=4953)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1):   0%|          | 0/5000 [00:00<?, ? examples/s]
[36m(TaskRunner pid=4953)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1):  20%|██        | 1000/5000 [00:00<00:03, 1073.60 examples/s]
[36m(TaskRunner pid=4953)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1):  40%|████      | 2000/5000 [00:01<00:01, 1689.85 examples/s]
[36m(TaskRunner pid=4953)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1):  60%|██████    | 3000/5000 [00:01<00:00, 2131.15 examples/s]
[36m(TaskRunner pid=4953)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1):  80%|████████  | 4000/5000 [00:01<00:00, 2548.42 examples/s]
[36m(TaskRunner pid=4953)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1): 100%|██████████| 5000/5000 [00:02<00:00, 2867.54 examples/s]
[36m(TaskRunner pid=4953)[0m 
Filtering prompts longer than 1024 tokens (num_proc=1): 100%|██████████| 5000/5000 [00:02<00:00, 2204.49 examples/s]
[36m(TaskRunner pid=4953)[0m /workspace/verl/verl/trainer/ppo/ray_trainer.py:341: UserWarning: Disabled critic as algorithm.adv_estimator != gae. If it is not intended, please set critic.enable=True
[36m(TaskRunner pid=4953)[0m   self.use_critic = need_critic(self.config)
[36m(TaskRunner pid=4953)[0m filter dataset len: 4998
[36m(TaskRunner pid=4953)[0m Size of train dataloader: 58, Size of val dataloader: 1
[36m(TaskRunner pid=4953)[0m Total training steps: 58
[36m(TaskRunner pid=4953)[0m colocated worker base class <class 'verl.single_controller.base.worker.Worker'>
[36m(pid=5527)[0m /workspace/anaconda3/envs/verl_rl/lib/python3.12/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
[36m(pid=5527)[0m   import pynvml  # type: ignore[import]
[36m(WorkerDict pid=5528)[0m [Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[36m(WorkerDict pid=5525)[0m reference model: /models/Qwen/Qwen2.5-1.5B
[36m(WorkerDict pid=5525)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=5525)[0m   "architectures": [
[36m(WorkerDict pid=5525)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=5525)[0m   ],
[36m(WorkerDict pid=5525)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=5525)[0m   "dtype": "bfloat16",
[36m(WorkerDict pid=5525)[0m   "eos_token_id": 151643,
[36m(WorkerDict pid=5525)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=5525)[0m   "hidden_size": 1536,
[36m(WorkerDict pid=5525)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=5525)[0m   "intermediate_size": 8960,
[36m(WorkerDict pid=5525)[0m   "layer_types": [
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention"
[36m(WorkerDict pid=5525)[0m   ],
[36m(WorkerDict pid=5525)[0m   "max_position_embeddings": 131072,
[36m(WorkerDict pid=5525)[0m   "max_window_layers": 28,
[36m(WorkerDict pid=5525)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=5525)[0m   "num_attention_heads": 12,
[36m(WorkerDict pid=5525)[0m   "num_hidden_layers": 28,
[36m(WorkerDict pid=5525)[0m   "num_key_value_heads": 2,
[36m(WorkerDict pid=5525)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=5525)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=5525)[0m   "rope_scaling": null,
[36m(WorkerDict pid=5525)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=5525)[0m   "sliding_window": null,
[36m(WorkerDict pid=5525)[0m   "tie_word_embeddings": true,
[36m(WorkerDict pid=5525)[0m   "transformers_version": "4.56.1",
[36m(WorkerDict pid=5525)[0m   "use_cache": true,
[36m(WorkerDict pid=5525)[0m   "use_mrope": false,
[36m(WorkerDict pid=5525)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=5525)[0m   "vocab_size": 151936
[36m(WorkerDict pid=5525)[0m }
[36m(WorkerDict pid=5525)[0m 
[36m(WorkerDict pid=5527)[0m `torch_dtype` is deprecated! Use `dtype` instead!
[36m(WorkerDict pid=5527)[0m Flash Attention 2 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", dtype=torch.float16)`
[36m(WorkerDict pid=5527)[0m Flash Attention 2 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2Model is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", dtype=torch.float16)`
[36m(pid=5526)[0m /workspace/anaconda3/envs/verl_rl/lib/python3.12/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.[32m [repeated 3x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(pid=5526)[0m   import pynvml  # type: ignore[import][32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=5528)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention
[36m(WorkerDict pid=5528)[0m Skipping monkey patch for Qwen2ForCausalLM as use_fused_kernels is False or fused_kernels_backend is torch
[36m(WorkerDict pid=5525)[0m Qwen2ForCausalLM contains 1.54B parameters
[36m(WorkerDict pid=5525)[0m wrap_policy: functools.partial(<function _or_policy at 0x74eff5e728e0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x74eff5e727a0>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=5526)[0m [Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=5525)[0m NCCL version 2.27.3+cuda12.9
[36m(WorkerDict pid=5525)[0m Ref use_remove_padding=True
[36m(WorkerDict pid=5525)[0m Ref use_fused_kernels=False
[36m(WorkerDict pid=5525)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=5525)[0m   "architectures": [
[36m(WorkerDict pid=5525)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=5525)[0m   ],
[36m(WorkerDict pid=5525)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=5525)[0m   "dtype": "bfloat16",
[36m(WorkerDict pid=5525)[0m   "eos_token_id": 151643,
[36m(WorkerDict pid=5525)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=5525)[0m   "hidden_size": 1536,
[36m(WorkerDict pid=5525)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=5525)[0m   "intermediate_size": 8960,
[36m(WorkerDict pid=5525)[0m   "layer_types": [
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention",
[36m(WorkerDict pid=5525)[0m     "full_attention"
[36m(WorkerDict pid=5525)[0m   ],
[36m(WorkerDict pid=5525)[0m   "max_position_embeddings": 131072,
[36m(WorkerDict pid=5525)[0m   "max_window_layers": 28,
[36m(WorkerDict pid=5525)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=5525)[0m   "num_attention_heads": 12,
[36m(WorkerDict pid=5525)[0m   "num_hidden_layers": 28,
[36m(WorkerDict pid=5525)[0m   "num_key_value_heads": 2,
[36m(WorkerDict pid=5525)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=5525)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=5525)[0m   "rope_scaling": null,
[36m(WorkerDict pid=5525)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=5525)[0m   "sliding_window": null,
[36m(WorkerDict pid=5525)[0m   "tie_word_embeddings": true,
[36m(WorkerDict pid=5525)[0m   "transformers_version": "4.56.1",
[36m(WorkerDict pid=5525)[0m   "use_cache": true,
[36m(WorkerDict pid=5525)[0m   "use_mrope": false,
[36m(WorkerDict pid=5525)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=5525)[0m   "vocab_size": 151936
[36m(WorkerDict pid=5525)[0m }
[36m(WorkerDict pid=5525)[0m 
[36m(WorkerDict pid=5525)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=5525)[0m Skipping monkey patch for Qwen2ForCausalLM as use_fused_kernels is False or fused_kernels_backend is torch[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=5525)[0m Qwen2ForCausalLM contains 1.54B parameters
[36m(WorkerDict pid=5525)[0m wrap_policy: functools.partial(<function _or_policy at 0x74eff5e728e0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x74eff5e727a0>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=5525)[0m Total steps: 58, num_warmup_steps: 5
[36m(WorkerDict pid=5525)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=5525)[0m Actor use_fused_kernels=False
[36m(WorkerDict pid=5527)[0m /workspace/verl/verl/utils/profiler/config.py:49: UserWarning: Torch profiler tool config is not fully supported now.
[36m(WorkerDict pid=5527)[0m   warnings.warn("Torch profiler tool config is not fully supported now.", stacklevel=1)
[36m(WorkerDict pid=5525)[0m `torch_dtype` is deprecated! Use `dtype` instead![32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=5525)[0m Flash Attention 2 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2Model is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", dtype=torch.float16)`[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=5528)[0m [Gloo] Rank 1 is connected to 1 peer ranks. Expected number of connected peer ranks is : 1
[36m(WorkerDict pid=5528)[0m [Gloo] Rank 1 is connected to 1 peer ranks. Expected number of connected peer ranks is : 1
[36m(WorkerDict pid=5528)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=5526)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention[32m [repeated 4x across cluster][0m
[36m(WorkerDict pid=5526)[0m Skipping monkey patch for Qwen2ForCausalLM as use_fused_kernels is False or fused_kernels_backend is torch[32m [repeated 4x across cluster][0m
[36m(WorkerDict pid=5527)[0m NCCL version 2.27.3+cuda12.9
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/67 [00:00<?, ?it/s]
[36m(WorkerDict pid=5526)[0m /workspace/verl/verl/utils/profiler/config.py:49: UserWarning: Torch profiler tool config is not fully supported now.[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=5526)[0m   warnings.warn("Torch profiler tool config is not fully supported now.", stacklevel=1)[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=5526)[0m `torch_dtype` is deprecated! Use `dtype` instead![32m [repeated 4x across cluster][0m
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   3%|▎         | 2/67 [00:00<00:04, 16.01it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   6%|▌         | 4/67 [00:00<00:04, 13.19it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  10%|█         | 7/67 [00:00<00:03, 15.81it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  13%|█▎        | 9/67 [00:01<00:15,  3.73it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|█▊        | 12/67 [00:01<00:09,  5.77it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  22%|██▏       | 15/67 [00:02<00:06,  8.01it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  27%|██▋       | 18/67 [00:02<00:04, 10.33it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  31%|███▏      | 21/67 [00:02<00:03, 12.58it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▌      | 24/67 [00:02<00:02, 14.59it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 27/67 [00:02<00:02, 16.31it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  45%|████▍     | 30/67 [00:02<00:02, 17.49it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  49%|████▉     | 33/67 [00:03<00:04,  8.20it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  52%|█████▏    | 35/67 [00:04<00:05,  5.79it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▌    | 37/67 [00:04<00:04,  6.93it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|█████▉    | 40/67 [00:04<00:03,  8.93it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  63%|██████▎   | 42/67 [00:04<00:02, 10.31it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  66%|██████▌   | 44/67 [00:04<00:01, 11.73it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  69%|██████▊   | 46/67 [00:04<00:01, 13.06it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  72%|███████▏  | 48/67 [00:04<00:01, 14.42it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▍  | 50/67 [00:04<00:01, 15.62it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  78%|███████▊  | 52/67 [00:05<00:00, 16.67it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  81%|████████  | 54/67 [00:05<00:00, 17.15it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  84%|████████▎ | 56/67 [00:06<00:02,  5.36it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  87%|████████▋ | 58/67 [00:06<00:01,  4.60it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  90%|████████▉ | 60/67 [00:06<00:01,  5.87it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  93%|█████████▎| 62/67 [00:07<00:00,  6.69it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  96%|█████████▌| 64/67 [00:07<00:00,  8.30it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 67/67 [00:07<00:00, 10.42it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 67/67 [00:07<00:00,  9.09it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/67 [00:00<?, ?it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (decode, FULL):   4%|▍         | 3/67 [00:00<00:02, 21.88it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (decode, FULL):   9%|▉         | 6/67 [00:00<00:02, 23.62it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (decode, FULL):  13%|█▎        | 9/67 [00:00<00:02, 23.97it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (decode, FULL):  18%|█▊        | 12/67 [00:01<00:11,  4.92it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (decode, FULL):  21%|██        | 14/67 [00:01<00:08,  6.18it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 17/67 [00:01<00:05,  8.57it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (decode, FULL):  30%|██▉       | 20/67 [00:02<00:04, 10.89it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (decode, FULL):  34%|███▍      | 23/67 [00:02<00:03, 13.26it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (decode, FULL):  39%|███▉      | 26/67 [00:02<00:02, 15.39it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (decode, FULL):  43%|████▎     | 29/67 [00:02<00:02, 17.43it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (decode, FULL):  48%|████▊     | 32/67 [00:02<00:01, 19.11it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (decode, FULL):  52%|█████▏    | 35/67 [00:02<00:01, 20.40it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 38/67 [00:02<00:01, 21.87it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (decode, FULL):  61%|██████    | 41/67 [00:04<00:04,  5.85it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (decode, FULL):  66%|██████▌   | 44/67 [00:04<00:03,  7.64it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (decode, FULL):  70%|███████   | 47/67 [00:04<00:02,  9.59it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (decode, FULL):  75%|███████▍  | 50/67 [00:04<00:01, 11.73it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (decode, FULL):  79%|███████▉  | 53/67 [00:04<00:01, 13.87it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (decode, FULL):  84%|████████▎ | 56/67 [00:04<00:00, 15.79it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (decode, FULL):  88%|████████▊ | 59/67 [00:04<00:00, 17.36it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (decode, FULL):  93%|█████████▎| 62/67 [00:05<00:00, 15.96it/s]
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (decode, FULL):  97%|█████████▋| 65/67 [00:05<00:00, 18.13it/s]
[36m(WorkerDict pid=5528)[0m kwargs: {'n': 1, 'logprobs': 0, 'max_tokens': 4096, 'repetition_penalty': 1.0, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}
[36m(WorkerDict pid=5527)[0m [Gloo] Rank 0 is connected to 1 peer ranks. Expected number of connected peer ranks is : 1[32m [repeated 33x across cluster][0m
[36m(WorkerDict pid=5527)[0m /workspace/anaconda3/envs/verl_rl/lib/python3.12/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:678: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=5527)[0m   warnings.warn(
[36m(WorkerDict pid=5525)[0m 
Capturing CUDA graphs (decode, FULL): 100%|██████████| 67/67 [00:06<00:00, 10.59it/s]
[36m(TaskRunner pid=4953)[0m wandb: Currently logged in as: 740775822 (xieyuhui) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[36m(WorkerDict pid=5525)[0m /workspace/anaconda3/envs/verl_rl/lib/python3.12/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:678: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=5525)[0m   warnings.warn([32m [repeated 3x across cluster][0m
[36m(TaskRunner pid=4953)[0m wandb: setting up run 0au3107d
[36m(TaskRunner pid=4953)[0m wandb: Tracking run with wandb version 0.23.1
[36m(TaskRunner pid=4953)[0m wandb: Run data is saved locally in /workspace/verl_exp/wandb/run-20251224_221202-0au3107d
[36m(TaskRunner pid=4953)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(TaskRunner pid=4953)[0m wandb: Syncing run GRPO-Qwen2.5-1.5B
[36m(TaskRunner pid=4953)[0m wandb: ⭐️ View project at https://wandb.ai/xieyuhui/GRPO
[36m(TaskRunner pid=4953)[0m wandb: 🚀 View run at https://wandb.ai/xieyuhui/GRPO/runs/0au3107d
[36m(TaskRunner pid=4953)[0m 
Training Progress:   0%|          | 0/58 [00:00<?, ?it/s]
[36m(TaskRunner pid=4953)[0m Checkpoint tracker file does not exist: /workspace/verl_exp/ckpts/GRPO/GRPO-Qwen2.5-1.5B/latest_checkpointed_iteration.txt
[36m(TaskRunner pid=4953)[0m Training from scratch
[36m(WorkerDict pid=5525)[0m kwargs: {'n': 1, 'logprobs': 0, 'max_tokens': 4096, 'repetition_penalty': 1.0, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}[32m [repeated 3x across cluster][0m
[36m(TaskRunner pid=4953)[0m 
Training Progress:   2%|▏         | 1/58 [05:10<4:54:53, 310.42s/it]
[36m(TaskRunner pid=4953)[0m step:1 - actor/entropy:3.4019949436187744 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(-5.874886318224526e-05) - actor/grad_norm:np.float64(0.24288177490234375) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(60.97293710708618) - perf/max_memory_reserved_gb:np.float64(64.640625) - perf/cpu_memory_used_gb:np.float64(115.30707454681396) - actor/lr:np.float64(0.0) - training/global_step:1 - training/epoch:0 - critic/score/mean:0.03515625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.03515625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:0.006784831639379263 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-0.7245674133300781 - critic/returns/mean:0.006784831639379263 - critic/returns/max:2.4748666286468506 - critic/returns/min:-0.7245674133300781 - response_length/mean:1496.513671875 - response_length/max:4096.0 - response_length/min:2.0 - response_length/clip_ratio:0.1767578125 - response_length_non_aborted/mean:1496.513671875 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:2.0 - response_length_non_aborted/clip_ratio:0.1767578125 - response/aborted_ratio:0.0 - prompt_length/mean:138.3515625 - prompt_length/max:706.0 - prompt_length/min:76.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00023033097386360168 - timing_s/generate_sequences:103.72837829589844 - timing_s/generation_timing/max:109.78800964355469 - timing_s/generation_timing/min:97.58479309082031 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:116.46830209391192 - timing_s/reward:0.46089000906795263 - timing_s/old_log_prob:36.4096738640219 - timing_s/ref:38.65807976317592 - timing_s/adv:0.03947474993765354 - timing_s/update_actor:117.65248836320825 - timing_s/step:309.97621354484 - timing_s/stop_profile:4.9541937187314034e-05 - timing_per_token_ms/gen:0.07600236362764493 - timing_per_token_ms/ref:0.023091830583307302 - timing_per_token_ms/adv:2.3579656399462842e-05 - timing_per_token_ms/update_actor:0.07027796894287698 - perf/total_num_tokens:1674102 - perf/time_per_step:309.97621354484 - perf/throughput:1350.1858585012287
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m 
Training Progress:   3%|▎         | 2/58 [10:20<4:49:15, 309.93s/it]
[36m(TaskRunner pid=4953)[0m step:2 - actor/entropy:3.2311651706695557 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(1.4704908721796528e-05) - actor/grad_norm:np.float64(0.20141346752643585) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(63.623101234436035) - perf/max_memory_reserved_gb:np.float64(67.375) - perf/cpu_memory_used_gb:np.float64(149.26136779785156) - actor/lr:np.float64(6.000000000000001e-07) - training/global_step:2 - training/epoch:0 - critic/score/mean:0.0361328125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.0361328125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.01406688243150711 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-0.7245674133300781 - critic/returns/mean:-0.01406688243150711 - critic/returns/max:2.4748666286468506 - critic/returns/min:-0.7245674133300781 - response_length/mean:1427.78515625 - response_length/max:4096.0 - response_length/min:2.0 - response_length/clip_ratio:0.1669921875 - response_length_non_aborted/mean:1427.78515625 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:2.0 - response_length_non_aborted/clip_ratio:0.1669921875 - response/aborted_ratio:0.0 - prompt_length/mean:142.546875 - prompt_length/max:631.0 - prompt_length/min:76.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.514291115105152e-05 - timing_s/generate_sequences:100.81783294677734 - timing_s/generation_timing/max:107.4523696899414 - timing_s/generation_timing/min:94.21846008300781 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:116.28597732493654 - timing_s/reward:0.5225856429897249 - timing_s/old_log_prob:38.638262091204524 - timing_s/ref:33.37007679603994 - timing_s/adv:0.07584554702043533 - timing_s/update_actor:120.29321369109675 - timing_s/step:309.4764696289785 - timing_s/stop_profile:6.255484186112881e-05 - timing_per_token_ms/gen:0.07953614325956707 - timing_per_token_ms/ref:0.020752277208019764 - timing_per_token_ms/adv:4.716704208929947e-05 - timing_per_token_ms/update_actor:0.07480828204319397 - perf/total_num_tokens:1608020 - perf/time_per_step:309.4764696289785 - perf/throughput:1298.9840567909766
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m 
Training Progress:   5%|▌         | 3/58 [15:25<4:42:14, 307.90s/it]
[36m(TaskRunner pid=4953)[0m step:3 - actor/entropy:3.1673152446746826 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(1.0179292387668681e-05) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(-6.131777274731576e-05) - actor/grad_norm:np.float64(0.12416049838066101) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(63.67818307876587) - perf/max_memory_reserved_gb:np.float64(67.43359375) - perf/cpu_memory_used_gb:np.float64(148.54716682434082) - actor/lr:np.float64(1.2000000000000002e-06) - training/global_step:3 - training/epoch:0 - critic/score/mean:0.0283203125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.0283203125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.031301867216825485 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-0.7245674133300781 - critic/returns/mean:-0.031301867216825485 - critic/returns/max:2.4748666286468506 - critic/returns/min:-0.7245674133300781 - response_length/mean:1415.1455078125 - response_length/max:4096.0 - response_length/min:2.0 - response_length/clip_ratio:0.166015625 - response_length_non_aborted/mean:1415.1455078125 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:2.0 - response_length_non_aborted/clip_ratio:0.166015625 - response/aborted_ratio:0.0 - prompt_length/mean:137.3359375 - prompt_length/max:640.0 - prompt_length/min:78.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.36221331357956e-05 - timing_s/generate_sequences:99.22743225097656 - timing_s/generation_timing/max:101.04361724853516 - timing_s/generation_timing/min:97.41655731201172 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:111.2145611140877 - timing_s/reward:0.49131027585826814 - timing_s/old_log_prob:38.74352499702945 - timing_s/ref:32.34069667197764 - timing_s/adv:0.029306839918717742 - timing_s/update_actor:122.26984415901825 - timing_s/step:305.37970889010467 - timing_s/stop_profile:5.02229668200016e-05 - timing_per_token_ms/gen:0.07674685694042871 - timing_per_token_ms/ref:0.02034337459496713 - timing_per_token_ms/adv:1.8434977721979706e-05 - timing_per_token_ms/update_actor:0.07691180145634934 - perf/total_num_tokens:1589741 - perf/time_per_step:305.37970889010467 - perf/throughput:1301.4461617128034
[36m(TaskRunner pid=4953)[0m 
Training Progress:   7%|▋         | 4/58 [20:44<4:40:54, 312.11s/it]
[36m(TaskRunner pid=4953)[0m step:4 - actor/entropy:3.2047019004821777 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(1.0370147859539713e-05) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(-5.060894869757249e-05) - actor/grad_norm:np.float64(0.17458193004131317) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.04295587539673) - perf/max_memory_reserved_gb:np.float64(67.8046875) - perf/cpu_memory_used_gb:np.float64(148.96477127075195) - actor/lr:np.float64(1.8e-06) - training/global_step:4 - training/epoch:0 - critic/score/mean:0.0361328125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.0361328125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.004851927515119314 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-0.935412585735321 - critic/returns/mean:-0.004851927515119314 - critic/returns/max:2.4748666286468506 - critic/returns/min:-0.935412585735321 - response_length/mean:1447.138671875 - response_length/max:4096.0 - response_length/min:2.0 - response_length/clip_ratio:0.1689453125 - response_length_non_aborted/mean:1447.138671875 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:2.0 - response_length_non_aborted/clip_ratio:0.1689453125 - response/aborted_ratio:0.0 - prompt_length/mean:143.2890625 - prompt_length/max:851.0 - prompt_length/min:80.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.06829596310854e-05 - timing_s/generate_sequences:101.96981048583984 - timing_s/generation_timing/max:113.68701934814453 - timing_s/generation_timing/min:90.19635009765625 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:123.24462191201746 - timing_s/reward:0.5014616239350289 - timing_s/old_log_prob:35.38788186199963 - timing_s/ref:32.87197575182654 - timing_s/adv:0.02895107213407755 - timing_s/update_actor:126.13857624307275 - timing_s/step:318.4525991601404 - timing_s/stop_profile:4.264595918357372e-05 - timing_per_token_ms/gen:0.08316830890160234 - timing_per_token_ms/ref:0.020184217192841046 - timing_per_token_ms/adv:1.7776684076781102e-05 - timing_per_token_ms/update_actor:0.07745224803362938 - perf/total_num_tokens:1628598 - perf/time_per_step:318.4525991601404 - perf/throughput:1278.5246566483715
[36m(TaskRunner pid=4953)[0m 
Training Progress:   9%|▊         | 5/58 [25:52<4:34:25, 310.68s/it]
[36m(TaskRunner pid=4953)[0m step:5 - actor/entropy:3.495642900466919 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(1.137014406626946e-05) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(1.9678415810631122e-05) - actor/grad_norm:np.float64(0.1936952769756317) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.04295587539673) - perf/max_memory_reserved_gb:np.float64(67.8046875) - perf/cpu_memory_used_gb:np.float64(114.31645202636719) - actor/lr:np.float64(2.4000000000000003e-06) - training/global_step:5 - training/epoch:0 - critic/score/mean:0.0380859375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.0380859375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.02802957221865654 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-0.935412585735321 - critic/returns/mean:-0.02802957221865654 - critic/returns/max:2.4748666286468506 - critic/returns/min:-0.935412585735321 - response_length/mean:1444.771484375 - response_length/max:4096.0 - response_length/min:2.0 - response_length/clip_ratio:0.1767578125 - response_length_non_aborted/mean:1444.771484375 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:2.0 - response_length_non_aborted/clip_ratio:0.1767578125 - response/aborted_ratio:0.0 - prompt_length/mean:134.0390625 - prompt_length/max:448.0 - prompt_length/min:76.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.915303386747837e-05 - timing_s/generate_sequences:100.0320816040039 - timing_s/generation_timing/max:105.7146224975586 - timing_s/generation_timing/min:94.35637664794922 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:114.97171979700215 - timing_s/reward:0.5080797711852938 - timing_s/old_log_prob:36.35286814207211 - timing_s/ref:32.05776001396589 - timing_s/adv:0.03615689417347312 - timing_s/update_actor:123.84732692781836 - timing_s/step:308.04221063805744 - timing_s/stop_profile:5.6816963478922844e-05 - timing_per_token_ms/gen:0.07771268420544052 - timing_per_token_ms/ref:0.019829108898217415 - timing_per_token_ms/adv:2.2364600386139884e-05 - timing_per_token_ms/update_actor:0.07660491972411636 - perf/total_num_tokens:1616702 - perf/time_per_step:308.04221063805744 - perf/throughput:1312.0782997980007
[36m(TaskRunner pid=4953)[0m 
Training Progress:  10%|█         | 6/58 [31:07<4:30:30, 312.13s/it]
[36m(TaskRunner pid=4953)[0m step:6 - actor/entropy:3.195591926574707 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(1.6671828880099326e-05) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(-6.3502959619654575e-06) - actor/grad_norm:np.float64(0.20373301208019257) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.04295587539673) - perf/max_memory_reserved_gb:np.float64(67.8046875) - perf/cpu_memory_used_gb:np.float64(138.08998107910156) - actor/lr:np.float64(3e-06) - training/global_step:6 - training/epoch:0 - critic/score/mean:0.033203125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.033203125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.02621426060795784 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-0.7245674133300781 - critic/returns/mean:-0.02621426060795784 - critic/returns/max:2.4748666286468506 - critic/returns/min:-0.7245674133300781 - response_length/mean:1536.2353515625 - response_length/max:4096.0 - response_length/min:2.0 - response_length/clip_ratio:0.1875 - response_length_non_aborted/mean:1536.2353515625 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:2.0 - response_length_non_aborted/clip_ratio:0.1875 - response/aborted_ratio:0.0 - prompt_length/mean:148.6484375 - prompt_length/max:566.0 - prompt_length/min:75.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00014541600830852985 - timing_s/generate_sequences:105.28864288330078 - timing_s/generation_timing/max:113.43814086914062 - timing_s/generation_timing/min:97.16952514648438 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:121.56206502881832 - timing_s/reward:0.40527722891420126 - timing_s/old_log_prob:37.136687169084325 - timing_s/ref:31.82243195991032 - timing_s/adv:0.026064262026920915 - timing_s/update_actor:123.70222864183597 - timing_s/step:314.8686519579496 - timing_s/stop_profile:3.8529047742486e-05 - timing_per_token_ms/gen:0.07727523911551888 - timing_per_token_ms/ref:0.018444354389652893 - timing_per_token_ms/adv:1.5106905918910692e-05 - timing_per_token_ms/update_actor:0.07169809481356569 - perf/total_num_tokens:1725321 - perf/time_per_step:314.8686519579496 - perf/throughput:1369.873587979802
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m 
Training Progress:  12%|█▏        | 7/58 [36:29<4:28:07, 315.45s/it]
[36m(TaskRunner pid=4953)[0m step:7 - actor/entropy:3.2015256881713867 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(3.0741851936966214e-05) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(5.391834690726682e-06) - actor/grad_norm:np.float64(0.20370115339756012) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.04295587539673) - perf/max_memory_reserved_gb:np.float64(67.8046875) - perf/cpu_memory_used_gb:np.float64(147.4728889465332) - actor/lr:np.float64(3e-06) - training/global_step:7 - training/epoch:0 - critic/score/mean:0.0947265625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.0947265625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.01710573025047779 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-1.6201815605163574 - critic/returns/mean:-0.01710573025047779 - critic/returns/max:2.4748666286468506 - critic/returns/min:-1.6201815605163574 - response_length/mean:1531.30859375 - response_length/max:4096.0 - response_length/min:2.0 - response_length/clip_ratio:0.1640625 - response_length_non_aborted/mean:1531.30859375 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:2.0 - response_length_non_aborted/clip_ratio:0.1640625 - response/aborted_ratio:0.0 - prompt_length/mean:140.1171875 - prompt_length/max:504.0 - prompt_length/min:78.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.9850128814578056e-05 - timing_s/generate_sequences:107.80693817138672 - timing_s/generation_timing/max:118.2313003540039 - timing_s/generation_timing/min:97.42561340332031 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:128.26886855904013 - timing_s/reward:0.5541014450136572 - timing_s/old_log_prob:38.34813118795864 - timing_s/ref:32.26509212516248 - timing_s/adv:0.029989790869876742 - timing_s/update_actor:122.47607300896198 - timing_s/step:322.1811089871917 - timing_s/stop_profile:4.347390495240688e-05 - timing_per_token_ms/gen:0.08180099521640762 - timing_per_token_ms/ref:0.01885149755492859 - timing_per_token_ms/adv:1.752210925241405e-05 - timing_per_token_ms/update_actor:0.0715589895701894 - perf/total_num_tokens:1711540 - perf/time_per_step:322.1811089871917 - perf/throughput:1328.0884200352373
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m 
Training Progress:  14%|█▍        | 8/58 [41:45<4:22:57, 315.55s/it]
[36m(TaskRunner pid=4953)[0m step:8 - actor/entropy:2.8710827827453613 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(5.918384540315458e-05) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(-2.973719318788426e-05) - actor/grad_norm:np.float64(0.1926148682832718) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.04295587539673) - perf/max_memory_reserved_gb:np.float64(67.8046875) - perf/cpu_memory_used_gb:np.float64(115.71402359008789) - actor/lr:np.float64(3e-06) - training/global_step:8 - training/epoch:0 - critic/score/mean:0.099609375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.099609375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.03807174041867256 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-1.6201815605163574 - critic/returns/mean:-0.03807174041867256 - critic/returns/max:2.4748666286468506 - critic/returns/min:-1.6201815605163574 - response_length/mean:1460.18359375 - response_length/max:4096.0 - response_length/min:2.0 - response_length/clip_ratio:0.1513671875 - response_length_non_aborted/mean:1460.18359375 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:2.0 - response_length_non_aborted/clip_ratio:0.1513671875 - response/aborted_ratio:0.0 - prompt_length/mean:145.3671875 - prompt_length/max:784.0 - prompt_length/min:75.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.147900760173798e-05 - timing_s/generate_sequences:102.51685333251953 - timing_s/generation_timing/max:115.17326354980469 - timing_s/generation_timing/min:89.96622467041016 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:125.71976875094697 - timing_s/reward:0.4146455971058458 - timing_s/old_log_prob:37.1485348099377 - timing_s/ref:31.108976181130856 - timing_s/adv:0.05199282895773649 - timing_s/update_actor:120.95681295194663 - timing_s/step:315.69922265806235 - timing_s/stop_profile:5.505792796611786e-05 - timing_per_token_ms/gen:0.08408066779845413 - timing_per_token_ms/ref:0.01892176809769504 - timing_per_token_ms/adv:3.1624192533797845e-05 - timing_per_token_ms/update_actor:0.07357094464269869 - perf/total_num_tokens:1644084 - perf/time_per_step:315.69922265806235 - perf/throughput:1301.9385874294085
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m 
Training Progress:  16%|█▌        | 9/58 [47:01<4:17:51, 315.74s/it]
[36m(TaskRunner pid=4953)[0m step:9 - actor/entropy:2.7457542419433594 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(7.879685605161058e-05) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(-4.6166142766423945e-05) - actor/grad_norm:np.float64(0.1739174723625183) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.04295587539673) - perf/max_memory_reserved_gb:np.float64(67.8046875) - perf/cpu_memory_used_gb:np.float64(131.77920532226562) - actor/lr:np.float64(3e-06) - training/global_step:9 - training/epoch:0 - critic/score/mean:0.1298828125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.1298828125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.041339222341775894 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-1.6201815605163574 - critic/returns/mean:-0.041339222341775894 - critic/returns/max:2.4748666286468506 - critic/returns/min:-1.6201815605163574 - response_length/mean:1491.0546875 - response_length/max:4096.0 - response_length/min:3.0 - response_length/clip_ratio:0.1630859375 - response_length_non_aborted/mean:1491.0546875 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:3.0 - response_length_non_aborted/clip_ratio:0.1630859375 - response/aborted_ratio:0.0 - prompt_length/mean:136.515625 - prompt_length/max:495.0 - prompt_length/min:75.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.63869970291853e-05 - timing_s/generate_sequences:105.28385925292969 - timing_s/generation_timing/max:113.98219299316406 - timing_s/generation_timing/min:95.90074157714844 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:124.39071611105464 - timing_s/reward:0.4261027940083295 - timing_s/old_log_prob:36.27769560110755 - timing_s/ref:31.739593002013862 - timing_s/adv:0.03377621294930577 - timing_s/update_actor:123.01155609311536 - timing_s/step:316.0940789252054 - timing_s/stop_profile:0.00012098695151507854 - timing_per_token_ms/gen:0.08146938520804711 - timing_per_token_ms/ref:0.019044151919568243 - timing_per_token_ms/adv:2.026614930548902e-05 - timing_per_token_ms/update_actor:0.07380846887202175 - perf/total_num_tokens:1666632 - perf/time_per_step:316.0940789252054 - perf/throughput:1318.145538874805
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m test_gen_batch meta info: {'eos_token_id': 151643, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 10}
[36m(TaskRunner pid=4953)[0m validation generation end
[36m(TaskRunner pid=4953)[0m [prompt] system
[36m(TaskRunner pid=4953)[0m You are a helpful AI Assistant, designed to provide well-reasoned and detailed responses. You FIRST think about the reasoning process step by step and then provide the user with the answer. Please enclose your final answer in the box: \boxed{Your Answer}.
[36m(TaskRunner pid=4953)[0m user
[36m(TaskRunner pid=4953)[0m Bin $A$ has one white ball and four black balls.  Bin $B$ has three balls labeled $\$1$ and one ball labeled $\$7$.  Bin $W$ has five balls labeled $\$8$ and one ball labeled $\$500$.  A game is played as follows: a ball is randomly selected from bin $A$.  If it is black, then a ball is randomly selected from bin $B$; otherwise, if the original ball is white, then a ball is randomly selected from bin $W$.  You win the amount printed on the second ball selected.  What is your expected win?
[36m(TaskRunner pid=4953)[0m assistant
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m [response] To find the expected win, we need to consider the probabilities of each scenario and the corresponding winnings.
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m First, let's find the probability of selecting a black ball from bin $A$. Since bin $A$ has one white ball and four black balls, the probability of selecting a black ball is $\frac{4}{5}$.
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m Next, let's find the probability of selecting a white ball from bin $A$. Since bin $A$ has one white ball and four black balls, the probability of selecting a white ball is $\frac{1}{5}$.
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m Now, let's find the probability of selecting a ball from bin $B$ given that a black ball was selected from bin $A$. Since bin $B$ has three balls labeled $\$1$ and one ball labeled $\$7$, the probability of selecting a ball from bin $B$ is $\frac{3}{4}$.
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m Finally, let's find the probability of selecting a ball from bin $W$ given that a white ball was selected from bin $A$. Since bin $W$ has five balls labeled $\$8$ and one ball labeled $\$500$, the probability of selecting a ball from bin $W$ is $\frac{1}{6}$.
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m Now, we can calculate the expected win by multiplying the probability of each scenario by the corresponding winnings and summing them up:
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m Expected win = $\left(\frac{4}{5} \times \frac{3}{4} \times \$1\right) + \left(\frac{1}{5} \times \frac{1}{6} \times \$500\right)$
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m Expected win = $\left(\frac{3}{5} \times \$1\right) + \left(\frac{1}{30} \times \$500\right)$
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m Expected win = $\boxed{\$0.60}$
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m Therefore, the expected win is $\$0.60$.
[36m(TaskRunner pid=4953)[0m [ground_truth] \$20
[36m(TaskRunner pid=4953)[0m [score] 0.0
[36m(TaskRunner pid=4953)[0m 
Training Progress:  17%|█▋        | 10/58 [58:32<5:45:21, 431.70s/it]
[36m(TaskRunner pid=4953)[0m step:10 - actor/entropy:2.562983989715576 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(9.396994846611051e-05) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(1.787410179154847e-05) - actor/grad_norm:np.float64(0.17407885193824768) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.04295587539673) - perf/max_memory_reserved_gb:np.float64(67.8046875) - perf/cpu_memory_used_gb:np.float64(143.7009105682373) - actor/lr:np.float64(3e-06) - val-core/DigitalLearningGmbH/MATH-lighteval/reward/mean@1:np.float64(0.4027611044417767) - training/global_step:10 - training/epoch:0 - critic/score/mean:0.1728515625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.1728515625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.08008027076721191 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.08008027076721191 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:1347.50390625 - response_length/max:4096.0 - response_length/min:2.0 - response_length/clip_ratio:0.1298828125 - response_length_non_aborted/mean:1347.50390625 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:2.0 - response_length_non_aborted/clip_ratio:0.1298828125 - response/aborted_ratio:0.0 - prompt_length/mean:136.25 - prompt_length/max:502.0 - prompt_length/min:73.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.273606464266777e-05 - timing_s/generate_sequences:94.6899642944336 - timing_s/generation_timing/max:104.63602447509766 - timing_s/generation_timing/min:84.6633529663086 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:114.52801127289422 - timing_s/reward:0.4037200319580734 - timing_s/old_log_prob:34.96536704013124 - timing_s/ref:31.42832375387661 - timing_s/adv:0.0440048580057919 - timing_s/update_actor:116.36988257616758 - timing_s/step:297.9607276530005 - timing_s/testing:393.3040508348495 - timing_s/stop_profile:4.80178277939558e-05 - timing_per_token_ms/gen:0.08300069520387393 - timing_per_token_ms/ref:0.020685183901867236 - timing_per_token_ms/adv:2.896268307383346e-05 - timing_per_token_ms/update_actor:0.07659118063621856 - perf/total_num_tokens:1519364 - perf/time_per_step:297.9607276530005 - perf/throughput:1274.802229783637
[36m(TaskRunner pid=4953)[0m 
Training Progress:  19%|█▉        | 11/58 [1:03:19<5:03:31, 387.49s/it]
[36m(TaskRunner pid=4953)[0m step:11 - actor/entropy:2.130077838897705 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00012794116754832885) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(-6.158007529677434e-05) - actor/grad_norm:np.float64(0.1906764656305313) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(152.44108200073242) - actor/lr:np.float64(3e-06) - training/global_step:11 - training/epoch:0 - critic/score/mean:0.2265625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.2265625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0986366719007492 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.0986366719007492 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:1299.0634765625 - response_length/max:4096.0 - response_length/min:3.0 - response_length/clip_ratio:0.1162109375 - response_length_non_aborted/mean:1299.0634765625 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:3.0 - response_length_non_aborted/clip_ratio:0.1162109375 - response/aborted_ratio:0.0 - prompt_length/mean:150.546875 - prompt_length/max:906.0 - prompt_length/min:75.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.983297109603882e-05 - timing_s/generate_sequences:91.58499145507812 - timing_s/generation_timing/max:98.75862884521484 - timing_s/generation_timing/min:84.48249053955078 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:106.55335129587911 - timing_s/reward:0.488333233166486 - timing_s/old_log_prob:34.3474731890019 - timing_s/ref:30.283104703994468 - timing_s/adv:0.03854952193796635 - timing_s/update_actor:115.18603437207639 - timing_s/step:287.1603600701783 - timing_s/stop_profile:4.5915134251117706e-05 - timing_per_token_ms/gen:0.08010078722267552 - timing_per_token_ms/ref:0.02040089214706435 - timing_per_token_ms/adv:2.596974937228306e-05 - timing_per_token_ms/update_actor:0.07759765344544796 - perf/total_num_tokens:1484401 - perf/time_per_step:287.1603600701783 - perf/throughput:1292.3101569774738
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m Training Progress:  21%|██        | 12/58 [1:07:53<4:30:24, 352.71s/it]
[36m(TaskRunner pid=4953)[0m step:12 - actor/entropy:1.8021291494369507 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00015431080484518134) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(-2.4844358240017073e-05) - actor/grad_norm:np.float64(0.18805670738220215) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(148.8457851409912) - actor/lr:np.float64(3e-06) - training/global_step:12 - training/epoch:0 - critic/score/mean:0.294921875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.294921875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.1030975803732872 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.1030975803732872 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:1128.263671875 - response_length/max:4096.0 - response_length/min:49.0 - response_length/clip_ratio:0.0888671875 - response_length_non_aborted/mean:1128.263671875 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:49.0 - response_length_non_aborted/clip_ratio:0.0888671875 - response/aborted_ratio:0.0 - prompt_length/mean:134.3515625 - prompt_length/max:466.0 - prompt_length/min:78.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.115909829735756e-05 - timing_s/generate_sequences:83.1478271484375 - timing_s/generation_timing/max:90.2591781616211 - timing_s/generation_timing/min:76.65498352050781 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:99.22031554579735 - timing_s/reward:0.3349085580557585 - timing_s/old_log_prob:32.22008461994119 - timing_s/ref:29.896566150942817 - timing_s/adv:0.042082492960616946 - timing_s/update_actor:111.15400805603713 - timing_s/step:273.0745304902084 - timing_s/stop_profile:4.816404543817043e-05 - timing_per_token_ms/gen:0.08587960581870767 - timing_per_token_ms/ref:0.02312332735018216 - timing_per_token_ms/adv:3.254846243970379e-05 - timing_per_token_ms/update_actor:0.0859714290125415 - perf/total_num_tokens:1292918 - perf/time_per_step:273.0745304902084 - perf/throughput:1183.6676947489616
[36m(TaskRunner pid=4953)[0m Training Progress:  22%|██▏       | 13/58 [1:12:12<4:03:14, 324.32s/it]
[36m(TaskRunner pid=4953)[0m step:13 - actor/entropy:1.4623068571090698 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00019200785995110436) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(4.6909746004075714e-05) - actor/grad_norm:np.float64(0.1571478545665741) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(148.37388610839844) - actor/lr:np.float64(3e-06) - training/global_step:13 - training/epoch:0 - critic/score/mean:0.291015625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.291015625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0692867636680603 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.0692867636680603 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:1002.9990234375 - response_length/max:4096.0 - response_length/min:43.0 - response_length/clip_ratio:0.0576171875 - response_length_non_aborted/mean:1002.9990234375 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:43.0 - response_length_non_aborted/clip_ratio:0.0576171875 - response/aborted_ratio:0.0 - prompt_length/mean:155.9609375 - prompt_length/max:880.0 - prompt_length/min:77.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.113208994269371e-05 - timing_s/generate_sequences:74.06366729736328 - timing_s/generation_timing/max:80.55491638183594 - timing_s/generation_timing/min:67.50228881835938 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:91.53410773002543 - timing_s/reward:0.40321352099999785 - timing_s/old_log_prob:33.7911414320115 - timing_s/ref:29.774674843996763 - timing_s/adv:0.035746115958318114 - timing_s/update_actor:103.12976162997074 - timing_s/step:258.9176726760343 - timing_s/stop_profile:3.8997968658804893e-05 - timing_per_token_ms/gen:0.08912149961397549 - timing_per_token_ms/ref:0.025088727723449486 - timing_per_token_ms/adv:3.0120381671604233e-05 - timing_per_token_ms/update_actor:0.08689916928648711 - perf/total_num_tokens:1186775 - perf/time_per_step:258.9176726760343 - perf/throughput:1145.8999570540414
[36m(TaskRunner pid=4953)[0m Training Progress:  24%|██▍       | 14/58 [1:16:17<3:40:19, 300.44s/it]
[36m(TaskRunner pid=4953)[0m step:14 - actor/entropy:1.055912971496582 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00020999332136284465) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(1.037594653752194e-05) - actor/grad_norm:np.float64(0.162098690867424) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(145.78834533691406) - actor/lr:np.float64(3e-06) - training/global_step:14 - training/epoch:0 - critic/score/mean:0.3974609375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.3974609375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.10787080228328705 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.10787080228328705 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:898.666015625 - response_length/max:4096.0 - response_length/min:24.0 - response_length/clip_ratio:0.048828125 - response_length_non_aborted/mean:898.666015625 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:24.0 - response_length_non_aborted/clip_ratio:0.048828125 - response/aborted_ratio:0.0 - prompt_length/mean:133.90625 - prompt_length/max:684.0 - prompt_length/min:76.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.0772993341088295e-05 - timing_s/generate_sequences:66.64118957519531 - timing_s/generation_timing/max:72.90221405029297 - timing_s/generation_timing/min:60.38874816894531 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:83.3007443419192 - timing_s/reward:0.35968149290420115 - timing_s/old_log_prob:32.73220563493669 - timing_s/ref:27.686315558152273 - timing_s/adv:0.0424557039514184 - timing_s/update_actor:100.84595155902207 - timing_s/step:245.22075533191673 - timing_s/stop_profile:0.00012009707279503345 - timing_per_token_ms/gen:0.09052126344160202 - timing_per_token_ms/ref:0.02618452813168747 - timing_per_token_ms/adv:4.0152781330962384e-05 - timing_per_token_ms/update_actor:0.0953757696656201 - perf/total_num_tokens:1057354 - perf/time_per_step:245.22075533191673 - perf/throughput:1077.961364413084
[36m(TaskRunner pid=4953)[0m Training Progress:  26%|██▌       | 15/58 [1:19:51<3:16:36, 274.34s/it]
[36m(TaskRunner pid=4953)[0m step:15 - actor/entropy:0.9033088684082031 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00022496072857336458) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(-4.839910549314652e-05) - actor/grad_norm:np.float64(0.13906849920749664) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(151.45082473754883) - actor/lr:np.float64(3e-06) - training/global_step:15 - training/epoch:0 - critic/score/mean:0.412109375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.412109375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.06313525885343552 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.06313525885343552 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:825.46875 - response_length/max:4096.0 - response_length/min:60.0 - response_length/clip_ratio:0.0361328125 - response_length_non_aborted/mean:825.46875 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:60.0 - response_length_non_aborted/clip_ratio:0.0361328125 - response/aborted_ratio:0.0 - prompt_length/mean:141.15625 - prompt_length/max:628.0 - prompt_length/min:76.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.0002258610911667347 - timing_s/generate_sequences:60.95376968383789 - timing_s/generation_timing/max:66.53777313232422 - timing_s/generation_timing/min:55.31829071044922 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:75.31860176404007 - timing_s/reward:0.3421955199446529 - timing_s/old_log_prob:22.29845927399583 - timing_s/ref:27.281207394087687 - timing_s/adv:0.03771325899288058 - timing_s/update_actor:88.2804564719554 - timing_s/step:213.7883935959544 - timing_s/stop_profile:4.404713399708271e-05 - timing_per_token_ms/gen:0.08910491406875837 - timing_per_token_ms/ref:0.02756167499887625 - timing_per_token_ms/adv:3.810097450948915e-05 - timing_per_token_ms/update_actor:0.0891880339049724 - perf/total_num_tokens:989824 - perf/time_per_step:213.7883935959544 - perf/throughput:1157.4809831242528
[36m(TaskRunner pid=4953)[0m Training Progress:  28%|██▊       | 16/58 [1:23:09<2:55:57, 251.36s/it]
[36m(TaskRunner pid=4953)[0m step:16 - actor/entropy:0.6548309326171875 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00027521963062326904) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(2.594904725938818e-05) - actor/grad_norm:np.float64(0.13364861905574799) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(151.4690933227539) - actor/lr:np.float64(3e-06) - training/global_step:16 - training/epoch:0 - critic/score/mean:0.4873046875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4873046875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.05676755681633949 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.05676755681633949 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:707.8125 - response_length/max:4096.0 - response_length/min:79.0 - response_length/clip_ratio:0.0146484375 - response_length_non_aborted/mean:707.8125 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:79.0 - response_length_non_aborted/clip_ratio:0.0146484375 - response/aborted_ratio:0.0 - prompt_length/mean:136.4453125 - prompt_length/max:409.0 - prompt_length/min:76.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.193505108356476e-05 - timing_s/generate_sequences:54.3193359375 - timing_s/generation_timing/max:60.38059997558594 - timing_s/generation_timing/min:48.23448944091797 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:65.11554256617092 - timing_s/reward:0.23877494712360203 - timing_s/old_log_prob:21.277377502061427 - timing_s/ref:26.56665759300813 - timing_s/adv:0.036730843828991055 - timing_s/update_actor:84.53933417890221 - timing_s/step:197.96355706010945 - timing_s/stop_profile:3.715301863849163e-05 - timing_per_token_ms/gen:0.08983932473257576 - timing_per_token_ms/ref:0.030729951410040406 - timing_per_token_ms/adv:4.248697986049028e-05 - timing_per_token_ms/update_actor:0.09778759794903785 - perf/total_num_tokens:864520 - perf/time_per_step:197.96355706010945 - perf/throughput:1091.7666019426722
[36m(TaskRunner pid=4953)[0m Training Progress:  29%|██▉       | 17/58 [1:26:32<2:41:56, 236.99s/it]
[36m(TaskRunner pid=4953)[0m step:17 - actor/entropy:0.3247200548648834 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0002456030888993155) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(6.492172278527164e-05) - actor/grad_norm:np.float64(0.10318958759307861) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(151.99806785583496) - actor/lr:np.float64(3e-06) - training/global_step:17 - training/epoch:0 - critic/score/mean:0.4638671875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4638671875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.07468833774328232 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.07468833774328232 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:793.583984375 - response_length/max:4096.0 - response_length/min:108.0 - response_length/clip_ratio:0.015625 - response_length_non_aborted/mean:793.583984375 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:108.0 - response_length_non_aborted/clip_ratio:0.015625 - response/aborted_ratio:0.0 - prompt_length/mean:137.3671875 - prompt_length/max:573.0 - prompt_length/min:75.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.573895759880543e-05 - timing_s/generate_sequences:58.39394760131836 - timing_s/generation_timing/max:62.41754150390625 - timing_s/generation_timing/min:54.3922004699707 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:67.10651923110709 - timing_s/reward:0.3357592928223312 - timing_s/old_log_prob:21.90658669313416 - timing_s/ref:26.91974556306377 - timing_s/adv:0.03811100102029741 - timing_s/update_actor:86.92940750694834 - timing_s/step:203.4641904758755 - timing_s/stop_profile:4.1915103793144226e-05 - timing_per_token_ms/gen:0.08257942634545498 - timing_per_token_ms/ref:0.02823866043745557 - timing_per_token_ms/adv:3.997822394801332e-05 - timing_per_token_ms/update_actor:0.09118845550999832 - perf/total_num_tokens:953294 - perf/time_per_step:203.4641904758755 - perf/throughput:1171.3289667464
[36m(TaskRunner pid=4953)[0m Training Progress:  31%|███       | 18/58 [1:29:49<2:29:56, 224.90s/it]
[36m(TaskRunner pid=4953)[0m step:18 - actor/entropy:0.36156824231147766 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0002802468271880798) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(5.503730459821554e-05) - actor/grad_norm:np.float64(0.10566606372594833) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(149.64144134521484) - actor/lr:np.float64(3e-06) - training/global_step:18 - training/epoch:0 - critic/score/mean:0.46484375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.46484375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0973583236336708 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.0973583236336708 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:723.9599609375 - response_length/max:4096.0 - response_length/min:35.0 - response_length/clip_ratio:0.0146484375 - response_length_non_aborted/mean:723.9599609375 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:35.0 - response_length_non_aborted/clip_ratio:0.0146484375 - response/aborted_ratio:0.0 - prompt_length/mean:147.3828125 - prompt_length/max:594.0 - prompt_length/min:74.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.99399970471859e-05 - timing_s/generate_sequences:56.09184646606445 - timing_s/generation_timing/max:57.72005844116211 - timing_s/generation_timing/min:54.43745803833008 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:62.70455013611354 - timing_s/reward:0.2387613041792065 - timing_s/old_log_prob:21.41610040096566 - timing_s/ref:26.633803418138996 - timing_s/adv:0.03196665085852146 - timing_s/update_actor:85.48322340613231 - timing_s/step:196.69014789396897 - timing_s/stop_profile:4.119821824133396e-05 - timing_per_token_ms/gen:0.08458328574276615 - timing_per_token_ms/ref:0.02984999066201814 - timing_per_token_ms/adv:3.582681056258745e-05 - timing_per_token_ms/update_actor:0.09580582166099637 - perf/total_num_tokens:892255 - perf/time_per_step:196.69014789396897 - perf/throughput:1134.0870520888948
[36m(TaskRunner pid=4953)[0m Training Progress:  33%|███▎      | 19/58 [1:33:09<2:21:18, 217.39s/it]
[36m(TaskRunner pid=4953)[0m step:19 - actor/entropy:0.280833899974823 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00029874232274096357) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(1.5212640562367596e-05) - actor/grad_norm:np.float64(0.11091528832912445) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(150.79117393493652) - actor/lr:np.float64(3e-06) - training/global_step:19 - training/epoch:0 - critic/score/mean:0.52734375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.52734375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.1278447061777115 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.1278447061777115 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:721.1533203125 - response_length/max:4096.0 - response_length/min:91.0 - response_length/clip_ratio:0.01171875 - response_length_non_aborted/mean:721.1533203125 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:91.0 - response_length_non_aborted/clip_ratio:0.01171875 - response/aborted_ratio:0.0 - prompt_length/mean:138.15625 - prompt_length/max:761.0 - prompt_length/min:77.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.782402776181698e-05 - timing_s/generate_sequences:54.64278793334961 - timing_s/generation_timing/max:61.08513259887695 - timing_s/generation_timing/min:48.22361373901367 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:66.05297145992517 - timing_s/reward:0.31329048704355955 - timing_s/old_log_prob:21.60902455286123 - timing_s/ref:26.657406606012955 - timing_s/adv:0.041571378940716386 - timing_s/update_actor:84.95690475893207 - timing_s/step:199.82963406899944 - timing_s/stop_profile:4.6836212277412415e-05 - timing_per_token_ms/gen:0.08944679740693845 - timing_per_token_ms/ref:0.03029481404381124 - timing_per_token_ms/adv:4.724380031288335e-05 - timing_per_token_ms/update_actor:0.09654928813776965 - perf/total_num_tokens:879933 - perf/time_per_step:199.82963406899944 - perf/throughput:1100.8539900745736
[36m(TaskRunner pid=4953)[0m test_gen_batch meta info: {'eos_token_id': 151643, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 20}
[36m(TaskRunner pid=4953)[0m validation generation end
[36m(TaskRunner pid=4953)[0m [prompt] system
[36m(TaskRunner pid=4953)[0m You are a helpful AI Assistant, designed to provide well-reasoned and detailed responses. You FIRST think about the reasoning process step by step and then provide the user with the answer. Please enclose your final answer in the box: \boxed{Your Answer}.
[36m(TaskRunner pid=4953)[0m user
[36m(TaskRunner pid=4953)[0m Bin $A$ has one white ball and four black balls.  Bin $B$ has three balls labeled $\$1$ and one ball labeled $\$7$.  Bin $W$ has five balls labeled $\$8$ and one ball labeled $\$500$.  A game is played as follows: a ball is randomly selected from bin $A$.  If it is black, then a ball is randomly selected from bin $B$; otherwise, if the original ball is white, then a ball is randomly selected from bin $W$.  You win the amount printed on the second ball selected.  What is your expected win?
[36m(TaskRunner pid=4953)[0m assistant
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m [response] To determine the expected win in this game, we need to consider the probabilities of each scenario and the corresponding winnings. Let's break it down step by step.
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m 1. **Probability of selecting a black ball from bin \( A \):**
[36m(TaskRunner pid=4953)[0m    Bin \( A \) has 1 white ball and 4 black balls. Therefore, the probability of selecting a black ball from bin \( A \) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    P(\text{Black from } A) = \frac{4}{5}
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m 2. **Probability of selecting a white ball from bin \( A \):**
[36m(TaskRunner pid=4953)[0m    The probability of selecting a white ball from bin \( A \) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    P(\text{White from } A) = \frac{1}{5}
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m 3. **Probability of selecting a ball from bin \( B \) given that a black ball is selected from bin \( A \):**
[36m(TaskRunner pid=4953)[0m    Bin \( B \) has 3 balls labeled \$1 and 1 ball labeled \$7. Therefore, the probability of selecting a ball from bin \( B \) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    P(\text{Ball from } B \mid \text{Black from } A) = \frac{3}{4}
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m 4. **Probability of selecting a ball from bin \( W \) given that a white ball is selected from bin \( A \):**
[36m(TaskRunner pid=4953)[0m    Bin \( W \) has 5 balls labeled \$8 and 1 ball labeled \$500. Therefore, the probability of selecting a ball from bin \( W \) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    P(\text{Ball from } W \mid \text{White from } A) = \frac{5}{6}
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m 5. **Expected win calculation:**
[36m(TaskRunner pid=4953)[0m    The expected win \( E \) is the sum of the products of the probabilities of each scenario and the corresponding winnings. We can express this as:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    E = P(\text{Black from } A) \cdot P(\text{Ball from } B \mid \text{Black from } A) \cdot \text{Winnings from } B + P(\text{White from } A) \cdot P(\text{Ball from } W \mid \text{White from } A) \cdot \text{Winnings from } W
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m    Substituting the values we have:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    E = \left( \frac{4}{5} \right) \left( \frac{3}{4} \right) \cdot 1 + \left( \frac{1}{5} \right) \left( \frac{5}{6} \right) \cdot 7
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m 6. **Simplify the expression:**
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    E = \frac{4}{5} \cdot \frac{3}{4} \cdot 1 + \frac{1}{5} \cdot \frac{5}{6} \cdot 7
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    E = \frac{3}{5} + \frac{7}{6}
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m 7. **Find a common denominator and add the fractions:**
[36m(TaskRunner pid=4953)[0m    The common denominator of 5 and 6 is 30. Converting each fraction:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    \frac{3}{5} = \frac{3 \cdot 6}{5 \cdot 6} = \frac{18}{30}
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    \frac{7}{6} = \frac{7 \cdot 5}{6 \cdot 5} = \frac{35}{30}
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m    Adding these fractions:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    E = \frac{18}{30} + \frac{35}{30} = \frac{53}{30}
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m 8. **Final answer:**
[36m(TaskRunner pid=4953)[0m    The expected win is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    \boxed{\frac{53}{30}}
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m [ground_truth] \$20
[36m(TaskRunner pid=4953)[0m [score] 0.0
[36m(TaskRunner pid=4953)[0m Training Progress:  34%|███▍      | 20/58 [1:41:34<3:12:19, 303.68s/it]
[36m(TaskRunner pid=4953)[0m step:20 - actor/entropy:0.24025209248065948 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0002853916805065637) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(8.71396091994825e-06) - actor/grad_norm:np.float64(0.1104477122426033) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(151.6100254058838) - actor/lr:np.float64(3e-06) - val-core/DigitalLearningGmbH/MATH-lighteval/reward/mean@1:np.float64(0.530812324929972) - training/global_step:20 - training/epoch:0 - critic/score/mean:0.5078125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5078125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.07433813065290451 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.07433813065290451 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:751.40234375 - response_length/max:4096.0 - response_length/min:124.0 - response_length/clip_ratio:0.01171875 - response_length_non_aborted/mean:751.40234375 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:124.0 - response_length_non_aborted/clip_ratio:0.01171875 - response/aborted_ratio:0.0 - prompt_length/mean:140.921875 - prompt_length/max:689.0 - prompt_length/min:74.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.347413338720798e-05 - timing_s/generate_sequences:55.587852478027344 - timing_s/generation_timing/max:60.95418930053711 - timing_s/generation_timing/min:50.20484161376953 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:65.6839194309432 - timing_s/reward:0.24758593109436333 - timing_s/old_log_prob:21.703604504000396 - timing_s/ref:26.669561537913978 - timing_s/adv:0.0413776021450758 - timing_s/update_actor:85.44976734300144 - timing_s/step:199.9795754069928 - timing_s/testing:304.7408462178428 - timing_s/stop_profile:3.741588443517685e-05 - timing_per_token_ms/gen:0.08536631952617658 - timing_per_token_ms/ref:0.029187254074369052 - timing_per_token_ms/adv:4.528378110302252e-05 - timing_per_token_ms/update_actor:0.09351650069275881 - perf/total_num_tokens:913740 - perf/time_per_step:199.9795754069928 - perf/throughput:1142.2916542106639
[36m(TaskRunner pid=4953)[0m Training Progress:  36%|███▌      | 21/58 [1:44:54<2:48:03, 272.54s/it]
[36m(TaskRunner pid=4953)[0m step:21 - actor/entropy:0.29644086956977844 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00031068441356296717) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(3.2906840999658016e-05) - actor/grad_norm:np.float64(0.09684157371520996) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(150.73751831054688) - actor/lr:np.float64(3e-06) - training/global_step:21 - training/epoch:0 - critic/score/mean:0.4912109375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4912109375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.06463153660297394 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.06463153660297394 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:744.34375 - response_length/max:4096.0 - response_length/min:138.0 - response_length/clip_ratio:0.01171875 - response_length_non_aborted/mean:744.34375 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:138.0 - response_length_non_aborted/clip_ratio:0.01171875 - response/aborted_ratio:0.0 - prompt_length/mean:142.296875 - prompt_length/max:905.0 - prompt_length/min:75.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.893409252166748e-05 - timing_s/generate_sequences:55.63673400878906 - timing_s/generation_timing/max:61.80295181274414 - timing_s/generation_timing/min:49.323097229003906 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:65.69614448701032 - timing_s/reward:0.2523910580202937 - timing_s/old_log_prob:21.64941110415384 - timing_s/ref:26.659903661115095 - timing_s/adv:0.041764558060094714 - timing_s/update_actor:85.37578636989929 - timing_s/step:199.86471512308344 - timing_s/stop_profile:5.301996134221554e-05 - timing_per_token_ms/gen:0.08619188526886402 - timing_per_token_ms/ref:0.029363714491491645 - timing_per_token_ms/adv:4.600026220382271e-05 - timing_per_token_ms/update_actor:0.09403448141895683 - perf/total_num_tokens:907920 - perf/time_per_step:199.86471512308344 - perf/throughput:1135.668193658986
[36m(TaskRunner pid=4953)[0m step:22 - actor/entropy:0.21536409854888916 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00029531056398468536) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(5.341077840625985e-05) - actor/grad_norm:np.float64(0.09589226543903351) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(151.62520599365234) - actor/lr:np.float64(3e-06) - training/global_step:22 - training/epoch:0 - critic/score/mean:0.4580078125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4580078125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.08489000797271729 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.08489000797271729 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:761.955078125 - response_length/max:4096.0 - response_length/min:124.0 - response_length/clip_ratio:0.013671875 - response_length_non_aborted/mean:761.955078125 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:124.0 - response_length_non_aborted/clip_ratio:0.013671875 - response/aborted_ratio:0.0 - prompt_length/mean:142.6171875 - prompt_length/max:928.0 - prompt_length/min:76.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.1564926505088806e-05 - timing_s/generate_sequences:57.40791320800781 - timing_s/generation_timing/max:59.71352767944336 - timing_s/generation_timing/min:55.12135314941406 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:64.59745820099488 - timing_s/reward:0.24651953903958201 - timing_s/old_log_prob:21.853259042836726 - timing_s/ref:26.896129795117304 - timing_s/adv:0.04087963094934821 - timing_s/update_actor:86.04372980399057 - timing_s/step:199.8501194040291 - timing_s/stop_profile:4.030694253742695e-05 - timing_per_token_ms/gen:0.08279156748931085 - timing_per_token_ms/ref:0.029036653843124777 - timing_per_token_ms/adv:4.4133029627422544e-05 - timing_per_token_ms/update_actor:0.09289150583082752 - perf/total_num_tokens:926282 - perf/time_per_step:199.8501194040291 - perf/throughput:1158.720848856953
[36m(TaskRunner pid=4953)[0m Training Progress:  38%|███▊      | 22/58 [1:48:14<2:30:26, 250.74s/it]
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m Training Progress:  40%|███▉      | 23/58 [1:51:32<2:17:07, 235.07s/it]
[36m(TaskRunner pid=4953)[0m step:23 - actor/entropy:0.22718647122383118 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00031676588655216165) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(3.166031294199456e-05) - actor/grad_norm:np.float64(0.10710638761520386) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(150.52864456176758) - actor/lr:np.float64(3e-06) - training/global_step:23 - training/epoch:0 - critic/score/mean:0.494140625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.494140625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.07469122856855392 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.07469122856855392 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:734.1533203125 - response_length/max:4096.0 - response_length/min:122.0 - response_length/clip_ratio:0.0087890625 - response_length_non_aborted/mean:734.1533203125 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:122.0 - response_length_non_aborted/clip_ratio:0.0087890625 - response/aborted_ratio:0.0 - prompt_length/mean:147.7578125 - prompt_length/max:509.0 - prompt_length/min:74.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.941007889807224e-05 - timing_s/generate_sequences:55.758792877197266 - timing_s/generation_timing/max:59.81362533569336 - timing_s/generation_timing/min:51.67575454711914 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:64.48621487803757 - timing_s/reward:0.2442292720079422 - timing_s/old_log_prob:21.51027516182512 - timing_s/ref:26.693308060988784 - timing_s/adv:0.034087601117789745 - timing_s/update_actor:85.32481838110834 - timing_s/step:198.46717030298896 - timing_s/stop_profile:4.788488149642944e-05 - timing_per_token_ms/gen:0.0857788386627846 - timing_per_token_ms/ref:0.029558175062579142 - timing_per_token_ms/adv:3.774606275853526e-05 - timing_per_token_ms/update_actor:0.09448232917138666 - perf/total_num_tokens:903077 - perf/time_per_step:198.46717030298896 - perf/throughput:1137.5647148862477
[36m(TaskRunner pid=4953)[0m Training Progress:  41%|████▏     | 24/58 [1:54:47<2:06:21, 222.98s/it]
[36m(TaskRunner pid=4953)[0m step:24 - actor/entropy:0.2234468013048172 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00033338856167119957) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(3.61435562599155e-05) - actor/grad_norm:np.float64(0.10206615924835205) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(151.58334732055664) - actor/lr:np.float64(3e-06) - training/global_step:24 - training/epoch:0 - critic/score/mean:0.4951171875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4951171875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0880008116364479 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.0880008116364479 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:710.759765625 - response_length/max:4096.0 - response_length/min:97.0 - response_length/clip_ratio:0.0068359375 - response_length_non_aborted/mean:710.759765625 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:97.0 - response_length_non_aborted/clip_ratio:0.0068359375 - response/aborted_ratio:0.0 - prompt_length/mean:134.6171875 - prompt_length/max:582.0 - prompt_length/min:77.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.691304638981819e-05 - timing_s/generate_sequences:52.93107604980469 - timing_s/generation_timing/max:57.195186614990234 - timing_s/generation_timing/min:48.67502212524414 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:61.94317238801159 - timing_s/reward:0.3150958991609514 - timing_s/old_log_prob:21.350876173004508 - timing_s/ref:26.50301634101197 - timing_s/adv:0.060106531949713826 - timing_s/update_actor:84.33004013705067 - timing_s/step:194.7193654398434 - timing_s/stop_profile:3.1638890504837036e-05 - timing_per_token_ms/gen:0.08510805227132551 - timing_per_token_ms/ref:0.030615752889696455 - timing_per_token_ms/adv:6.943386011430947e-05 - timing_per_token_ms/update_actor:0.09741637090638962 - perf/total_num_tokens:865666 - perf/time_per_step:194.7193654398434 - perf/throughput:1111.4277180964814
[36m(TaskRunner pid=4953)[0m Training Progress:  43%|████▎     | 25/58 [1:58:02<1:57:58, 214.49s/it]
[36m(TaskRunner pid=4953)[0m step:25 - actor/entropy:0.21503256261348724 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00035224669630906646) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(-7.177492626908588e-07) - actor/grad_norm:np.float64(0.1054292768239975) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(149.5836944580078) - actor/lr:np.float64(3e-06) - training/global_step:25 - training/epoch:0 - critic/score/mean:0.5546875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5546875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0925857350230217 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.0925857350230217 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:661.3671875 - response_length/max:4096.0 - response_length/min:125.0 - response_length/clip_ratio:0.0126953125 - response_length_non_aborted/mean:661.3671875 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:125.0 - response_length_non_aborted/clip_ratio:0.0126953125 - response/aborted_ratio:0.0 - prompt_length/mean:143.953125 - prompt_length/max:862.0 - prompt_length/min:75.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00016119610518217087 - timing_s/generate_sequences:51.21863555908203 - timing_s/generation_timing/max:57.59834289550781 - timing_s/generation_timing/min:44.774051666259766 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:63.07450747000985 - timing_s/reward:0.29865873814560473 - timing_s/old_log_prob:21.161604414926842 - timing_s/ref:26.47776276897639 - timing_s/adv:0.031927220057696104 - timing_s/update_actor:83.35791945108213 - timing_s/step:194.61907212994993 - timing_s/stop_profile:3.7449877709150314e-05 - timing_per_token_ms/gen:0.09313464572383476 - timing_per_token_ms/ref:0.03210795729690291 - timing_per_token_ms/adv:3.871617957928244e-05 - timing_per_token_ms/update_actor:0.10108303112489465 - perf/total_num_tokens:824648 - perf/time_per_step:194.61907212994993 - perf/throughput:1059.3103632841426
[36m(TaskRunner pid=4953)[0m Training Progress:  45%|████▍     | 26/58 [2:01:19<1:51:40, 209.40s/it]
[36m(TaskRunner pid=4953)[0m step:26 - actor/entropy:0.15545161068439484 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00033515265801042915) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(7.073011222935577e-05) - actor/grad_norm:np.float64(0.10824645310640335) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(152.07933807373047) - actor/lr:np.float64(3e-06) - training/global_step:26 - training/epoch:0 - critic/score/mean:0.5146484375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5146484375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.07253609597682953 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.07253609597682953 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:724.5009765625 - response_length/max:4096.0 - response_length/min:100.0 - response_length/clip_ratio:0.0078125 - response_length_non_aborted/mean:724.5009765625 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:100.0 - response_length_non_aborted/clip_ratio:0.0078125 - response/aborted_ratio:0.0 - prompt_length/mean:139.4765625 - prompt_length/max:766.0 - prompt_length/min:76.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.1564151868224144e-05 - timing_s/generate_sequences:55.741153717041016 - timing_s/generation_timing/max:59.444644927978516 - timing_s/generation_timing/min:52.03162384033203 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:64.20802248595282 - timing_s/reward:0.2448874639812857 - timing_s/old_log_prob:21.421412901952863 - timing_s/ref:26.633574281819165 - timing_s/adv:0.03891304787248373 - timing_s/update_actor:84.72044612001628 - timing_s/step:197.46298309299164 - timing_s/stop_profile:3.737304359674454e-05 - timing_per_token_ms/gen:0.08654667003548082 - timing_per_token_ms/ref:0.03010419682068554 - timing_per_token_ms/adv:4.3983809294634226e-05 - timing_per_token_ms/update_actor:0.09576037214330102 - perf/total_num_tokens:884713 - perf/time_per_step:197.46298309299164 - perf/throughput:1120.0998107875241
[36m(TaskRunner pid=4953)[0m Training Progress:  47%|████▋     | 27/58 [2:04:38<1:46:31, 206.18s/it]
[36m(TaskRunner pid=4953)[0m step:27 - actor/entropy:0.1864556223154068 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0003013301533201229) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(2.236531844701517e-05) - actor/grad_norm:np.float64(0.11273403465747833) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(153.40102767944336) - actor/lr:np.float64(3e-06) - training/global_step:27 - training/epoch:0 - critic/score/mean:0.4462890625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4462890625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.09367412328720093 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.09367412328720093 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:790.1357421875 - response_length/max:4096.0 - response_length/min:157.0 - response_length/clip_ratio:0.0126953125 - response_length_non_aborted/mean:790.1357421875 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:157.0 - response_length_non_aborted/clip_ratio:0.0126953125 - response/aborted_ratio:0.0 - prompt_length/mean:136.015625 - prompt_length/max:904.0 - prompt_length/min:76.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.455307058990002e-05 - timing_s/generate_sequences:57.39406967163086 - timing_s/generation_timing/max:58.16088104248047 - timing_s/generation_timing/min:56.63960647583008 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:62.94066744996235 - timing_s/reward:0.25215117493644357 - timing_s/old_log_prob:21.9786780399736 - timing_s/ref:26.842376850079745 - timing_s/adv:0.045703415060415864 - timing_s/update_actor:86.352160804905 - timing_s/step:198.5960042779334 - timing_s/stop_profile:4.899292252957821e-05 - timing_per_token_ms/gen:0.07779105826352813 - timing_per_token_ms/ref:0.028303428112684638 - timing_per_token_ms/adv:4.819108717128476e-05 - timing_per_token_ms/update_actor:0.09105237547953403 - perf/total_num_tokens:948379 - perf/time_per_step:198.5960042779334 - perf/throughput:1193.854583641008
[36m(TaskRunner pid=4953)[0m Training Progress:  48%|████▊     | 28/58 [2:08:02<1:42:45, 205.50s/it]
[36m(TaskRunner pid=4953)[0m step:28 - actor/entropy:0.1661536991596222 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00033393875382614624) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(5.11351093486212e-05) - actor/grad_norm:np.float64(0.10930062085390091) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(154.59481048583984) - actor/lr:np.float64(3e-06) - training/global_step:28 - training/epoch:0 - critic/score/mean:0.447265625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.447265625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.09421800822019577 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.09421800822019577 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:767.5673828125 - response_length/max:4096.0 - response_length/min:141.0 - response_length/clip_ratio:0.0078125 - response_length_non_aborted/mean:767.5673828125 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:141.0 - response_length_non_aborted/clip_ratio:0.0078125 - response/aborted_ratio:0.0 - prompt_length/mean:145.0390625 - prompt_length/max:764.0 - prompt_length/min:77.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.158812902867794e-05 - timing_s/generate_sequences:57.766178131103516 - timing_s/generation_timing/max:64.10413360595703 - timing_s/generation_timing/min:51.40943908691406 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:68.81633364013396 - timing_s/reward:0.24610404996201396 - timing_s/old_log_prob:21.768328958190978 - timing_s/ref:26.707510499982163 - timing_s/adv:0.04013026785105467 - timing_s/update_actor:86.08538400591351 - timing_s/step:203.84980612504296 - timing_s/stop_profile:4.1100895032286644e-05 - timing_per_token_ms/gen:0.08755381263622514 - timing_per_token_ms/ref:0.02857919024854995 - timing_per_token_ms/adv:4.294262318613803e-05 - timing_per_token_ms/update_actor:0.09211830384288809 - perf/total_num_tokens:934509 - perf/time_per_step:203.84980612504296 - perf/throughput:1146.07540934668
[36m(TaskRunner pid=4953)[0m Training Progress:  50%|█████     | 29/58 [2:11:15<1:37:35, 201.92s/it]
[36m(TaskRunner pid=4953)[0m step:29 - actor/entropy:0.16667062044143677 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0003507123331587536) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(-1.5733111837334945e-05) - actor/grad_norm:np.float64(0.10357747972011566) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(154.49523162841797) - actor/lr:np.float64(3e-06) - training/global_step:29 - training/epoch:0 - critic/score/mean:0.5439453125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5439453125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.09734327346086502 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.09734327346086502 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:679.044921875 - response_length/max:4096.0 - response_length/min:83.0 - response_length/clip_ratio:0.0087890625 - response_length_non_aborted/mean:679.044921875 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:83.0 - response_length_non_aborted/clip_ratio:0.0087890625 - response/aborted_ratio:0.0 - prompt_length/mean:123.9296875 - prompt_length/max:454.0 - prompt_length/min:77.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.9998827055096626e-05 - timing_s/generate_sequences:51.97191619873047 - timing_s/generation_timing/max:57.257747650146484 - timing_s/generation_timing/min:46.73371887207031 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:62.35492267599329 - timing_s/reward:0.23276019212789834 - timing_s/old_log_prob:21.128980254987255 - timing_s/ref:26.34541916102171 - timing_s/adv:0.046451386995613575 - timing_s/update_actor:83.19288505008444 - timing_s/step:193.49985117698088 - timing_s/stop_profile:4.870002157986164e-05 - timing_per_token_ms/gen:0.0896751852699726 - timing_per_token_ms/ref:0.032040799421367464 - timing_per_token_ms/adv:5.64932964047421e-05 - timing_per_token_ms/update_actor:0.1011776099246265 - perf/total_num_tokens:822246 - perf/time_per_step:193.49985117698088 - perf/throughput:1062.3341503864372
[36m(TaskRunner pid=4953)[0m test_gen_batch meta info: {'eos_token_id': 151643, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 30}
[36m(TaskRunner pid=4953)[0m validation generation end
[36m(TaskRunner pid=4953)[0m [prompt] system
[36m(TaskRunner pid=4953)[0m You are a helpful AI Assistant, designed to provide well-reasoned and detailed responses. You FIRST think about the reasoning process step by step and then provide the user with the answer. Please enclose your final answer in the box: \boxed{Your Answer}.
[36m(TaskRunner pid=4953)[0m user
[36m(TaskRunner pid=4953)[0m Bin $A$ has one white ball and four black balls.  Bin $B$ has three balls labeled $\$1$ and one ball labeled $\$7$.  Bin $W$ has five balls labeled $\$8$ and one ball labeled $\$500$.  A game is played as follows: a ball is randomly selected from bin $A$.  If it is black, then a ball is randomly selected from bin $B$; otherwise, if the original ball is white, then a ball is randomly selected from bin $W$.  You win the amount printed on the second ball selected.  What is your expected win?
[36m(TaskRunner pid=4953)[0m assistant
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m [response] To determine the expected win in this game, we need to consider the probabilities and the corresponding winnings for each possible outcome. Let's break it down step by step.
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m 1. **Probability of selecting a black ball from bin \(A\):**
[36m(TaskRunner pid=4953)[0m    Bin \(A\) has 1 white ball and 4 black balls. Therefore, the probability of selecting a black ball from bin \(A\) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    P(\text{Black from } A) = \frac{4}{5}
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m    If a black ball is selected from bin \(A\), then a ball is randomly selected from bin \(B\). Bin \(B\) has 3 balls labeled \$1 and 1 ball labeled \$7. The probability of selecting a ball labeled \$1 from bin \(B\) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    P(\$1 \text{ from } B \mid \text{Black from } A) = \frac{3}{4}
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m    The probability of selecting a ball labeled \$7 from bin \(B\) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    P(\$7 \text{ from } B \mid \text{Black from } A) = \frac{1}{4}
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m    The expected value of the winnings if a black ball is selected from bin \(A\) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    E(\$1 \text{ from } B \mid \text{Black from } A) \cdot \frac{3}{4} + E(\$7 \text{ from } B \mid \text{Black from } A) \cdot \frac{1}{4} = \frac{3}{4} \cdot 1 + \frac{1}{4} \cdot 7 = \frac{3}{4} + \frac{7}{4} = 3
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m 2. **Probability of selecting a white ball from bin \(A\):**
[36m(TaskRunner pid=4953)[0m    The probability of selecting a white ball from bin \(A\) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    P(\text{White from } A) = \frac{1}{5}
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m    If a white ball is selected from bin \(A\), then a ball is randomly selected from bin \(W\). Bin \(W\) has 5 balls labeled \$8 and 1 ball labeled \$500. The probability of selecting a ball labeled \$8 from bin \(W\) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    P(\$8 \text{ from } W \mid \text{White from } A) = \frac{5}{6}
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m    The probability of selecting a ball labeled \$500 from bin \(W\) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    P(\$500 \text{ from } W \mid \text{White from } A) = \frac{1}{6}
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m    The expected value of the winnings if a white ball is selected from bin \(A\) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    E(\$8 \text{ from } W \mid \text{White from } A) \cdot \frac{5}{6} + E(\$500 \text{ from } W \mid \text{White from } A) \cdot \frac{1}{6} = \frac{5}{6} \cdot 8 + \frac{1}{6} \cdot 500 = \frac{40}{6} + \frac{500}{6} = \frac{540}{6} = 90
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m 3. **Total expected win:**
[36m(TaskRunner pid=4953)[0m    The total expected win is the weighted average of the expected winnings from both scenarios, weighted by their respective probabilities:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    E(\text{Total Win}) = P(\text{Black from } A) \cdot E(\$1 \text{ from } B \mid \text{Black from } A) + P(\text{White from } A) \cdot E(\$8 \text{ from } W \mid \text{White from } A)
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m    Substituting the values we calculated:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    E(\text{Total Win}) = \frac{4}{5} \cdot 3 + \frac{1}{5} \cdot 90 = \frac{12}{5} + \frac{90}{5} = \frac{102}{5} = 20.4
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m Therefore, the expected win is \(\boxed{20.4}\).
[36m(TaskRunner pid=4953)[0m [ground_truth] \$20
[36m(TaskRunner pid=4953)[0m [score] 0.0
[36m(TaskRunner pid=4953)[0m local_global_step_folder: /workspace/verl_exp/ckpts/GRPO/GRPO-Qwen2.5-1.5B/global_step_30
[36m(WorkerDict pid=5528)[0m INFO:2025-12-25 00:31:45,106:[Rank 3] Saved model to /workspace/verl_exp/ckpts/GRPO/GRPO-Qwen2.5-1.5B/global_step_30/actor/model_world_size_4_rank_3.pt
[36m(WorkerDict pid=5528)[0m INFO:2025-12-25 00:32:35,538:[Rank 3] Saved optim to /workspace/verl_exp/ckpts/GRPO/GRPO-Qwen2.5-1.5B/global_step_30/actor/optim_world_size_4_rank_3.pt
[36m(WorkerDict pid=5528)[0m INFO:2025-12-25 00:32:35,540:[Rank 3] Saved extra_state to /workspace/verl_exp/ckpts/GRPO/GRPO-Qwen2.5-1.5B/global_step_30/actor/extra_state_world_size_4_rank_3.pt
[36m(WorkerDict pid=5526)[0m INFO:2025-12-25 00:31:45,642:[Rank 1] Saved model to /workspace/verl_exp/ckpts/GRPO/GRPO-Qwen2.5-1.5B/global_step_30/actor/model_world_size_4_rank_1.pt[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=5525)[0m INFO:2025-12-25 00:32:39,774:[Rank 0] Saved model config and tokenizer class to /workspace/verl_exp/ckpts/GRPO/GRPO-Qwen2.5-1.5B/global_step_30/actor/huggingface
[36m(WorkerDict pid=5526)[0m INFO:2025-12-25 00:32:40,548:[Rank 1] Saved optim to /workspace/verl_exp/ckpts/GRPO/GRPO-Qwen2.5-1.5B/global_step_30/actor/optim_world_size_4_rank_1.pt[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=5526)[0m INFO:2025-12-25 00:32:40,550:[Rank 1] Saved extra_state to /workspace/verl_exp/ckpts/GRPO/GRPO-Qwen2.5-1.5B/global_step_30/actor/extra_state_world_size_4_rank_1.pt[32m [repeated 3x across cluster][0m
[36m(TaskRunner pid=4953)[0m Training Progress:  52%|█████▏    | 30/58 [2:20:35<2:24:22, 309.36s/it]
[36m(TaskRunner pid=4953)[0m step:30 - actor/entropy:0.16602949798107147 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00030929122235079376) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(-2.7661006782864206e-06) - actor/grad_norm:np.float64(0.09453654289245605) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(155.0606985092163) - actor/lr:np.float64(3e-06) - val-core/DigitalLearningGmbH/MATH-lighteval/reward/mean@1:np.float64(0.5372148859543817) - training/global_step:30 - training/epoch:0 - critic/score/mean:0.4375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.10155755281448364 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.10155755281448364 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:782.96484375 - response_length/max:4096.0 - response_length/min:162.0 - response_length/clip_ratio:0.015625 - response_length_non_aborted/mean:782.96484375 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:162.0 - response_length_non_aborted/clip_ratio:0.015625 - response/aborted_ratio:0.0 - prompt_length/mean:146.109375 - prompt_length/max:957.0 - prompt_length/min:74.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.232100374996662e-05 - timing_s/generate_sequences:58.35323715209961 - timing_s/generation_timing/max:58.455665588378906 - timing_s/generation_timing/min:58.310855865478516 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:63.20384332397953 - timing_s/reward:0.25583851896226406 - timing_s/old_log_prob:21.883711968082935 - timing_s/ref:26.843929576920345 - timing_s/adv:0.03858410590328276 - timing_s/update_actor:86.42129744286649 - timing_s/step:198.81151940184645 - timing_s/testing:302.407198344823 - timing_s/save_checkpoint:58.775971435941756 - timing_s/stop_profile:9.402795694768429e-05 - timing_per_token_ms/gen:0.07883176842328529 - timing_per_token_ms/ref:0.028216018105347167 - timing_per_token_ms/adv:4.055627651778985e-05 - timing_per_token_ms/update_actor:0.09083859672437962 - perf/total_num_tokens:951372 - perf/time_per_step:198.81151940184645 - perf/throughput:1196.3240395505525
[36m(TaskRunner pid=4953)[0m Training Progress:  53%|█████▎    | 31/58 [2:23:44<2:02:53, 273.08s/it]
[36m(TaskRunner pid=4953)[0m step:31 - actor/entropy:0.1766820102930069 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0003657385651081313) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(6.906748606638757e-05) - actor/grad_norm:np.float64(0.11027725785970688) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(155.6178436279297) - actor/lr:np.float64(3e-06) - training/global_step:31 - training/epoch:0 - critic/score/mean:0.5302734375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5302734375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.07651924341917038 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.07651924341917038 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:657.6728515625 - response_length/max:4096.0 - response_length/min:106.0 - response_length/clip_ratio:0.0087890625 - response_length_non_aborted/mean:657.6728515625 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:106.0 - response_length_non_aborted/clip_ratio:0.0087890625 - response/aborted_ratio:0.0 - prompt_length/mean:136.140625 - prompt_length/max:541.0 - prompt_length/min:77.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.5211054384708405e-05 - timing_s/generate_sequences:50.40559768676758 - timing_s/generation_timing/max:53.07602310180664 - timing_s/generation_timing/min:47.7066535949707 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:57.61123927496374 - timing_s/reward:0.23497680900618434 - timing_s/old_log_prob:21.10984338913113 - timing_s/ref:26.37683267495595 - timing_s/adv:0.05628801207058132 - timing_s/update_actor:82.80904320604168 - timing_s/step:188.36849350109696 - timing_s/stop_profile:5.290587432682514e-05 - timing_per_token_ms/gen:0.0855455348670572 - timing_per_token_ms/ref:0.03244921687482663 - timing_per_token_ms/adv:6.924644568357762e-05 - timing_per_token_ms/update_actor:0.10187305789527373 - perf/total_num_tokens:812865 - perf/time_per_step:188.36849350109696 - perf/throughput:1078.8229295830545
[36m(TaskRunner pid=4953)[0m Training Progress:  55%|█████▌    | 32/58 [2:26:57<1:47:55, 249.05s/it]
[36m(TaskRunner pid=4953)[0m step:32 - actor/entropy:0.17230115830898285 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00034216846160006753) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(6.698650458147881e-05) - actor/grad_norm:np.float64(0.09644034504890442) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(154.57587432861328) - actor/lr:np.float64(3e-06) - training/global_step:32 - training/epoch:0 - critic/score/mean:0.50390625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.50390625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0812295600771904 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.0812295600771904 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:700.95703125 - response_length/max:4096.0 - response_length/min:97.0 - response_length/clip_ratio:0.0087890625 - response_length_non_aborted/mean:700.95703125 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:97.0 - response_length_non_aborted/clip_ratio:0.0087890625 - response/aborted_ratio:0.0 - prompt_length/mean:141.0078125 - prompt_length/max:866.0 - prompt_length/min:75.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.5669032260775566e-05 - timing_s/generate_sequences:52.87062072753906 - timing_s/generation_timing/max:55.443603515625 - timing_s/generation_timing/min:50.25043869018555 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:60.42875369498506 - timing_s/reward:0.2307626239489764 - timing_s/old_log_prob:21.28542314306833 - timing_s/ref:26.501529661938548 - timing_s/adv:0.03506693593226373 - timing_s/update_actor:84.27123385597952 - timing_s/step:192.91762268682942 - timing_s/stop_profile:4.138704389333725e-05 - timing_per_token_ms/gen:0.08418840549330583 - timing_per_token_ms/ref:0.03073810059006619 - timing_per_token_ms/adv:4.067278447022605e-05 - timing_per_token_ms/update_actor:0.09774294903566749 - perf/total_num_tokens:862172 - perf/time_per_step:192.91762268682942 - perf/throughput:1117.2799923514465
[36m(TaskRunner pid=4953)[0m Training Progress:  57%|█████▋    | 33/58 [2:30:23<1:38:22, 236.11s/it]
[36m(TaskRunner pid=4953)[0m step:33 - actor/entropy:0.18233300745487213 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00034425849710828516) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(1.5559510330831472e-05) - actor/grad_norm:np.float64(0.10513213276863098) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(154.9531831741333) - actor/lr:np.float64(3e-06) - training/global_step:33 - training/epoch:0 - critic/score/mean:0.49609375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.49609375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.08380347490310669 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.08380347490310669 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:739.416015625 - response_length/max:4096.0 - response_length/min:154.0 - response_length/clip_ratio:0.017578125 - response_length_non_aborted/mean:739.416015625 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:154.0 - response_length_non_aborted/clip_ratio:0.017578125 - response/aborted_ratio:0.0 - prompt_length/mean:141.59375 - prompt_length/max:888.0 - prompt_length/min:78.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.563495844602585e-05 - timing_s/generate_sequences:56.29607391357422 - timing_s/generation_timing/max:65.96277618408203 - timing_s/generation_timing/min:46.637393951416016 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:71.43670546007343 - timing_s/reward:0.34596427786163986 - timing_s/old_log_prob:21.64245633012615 - timing_s/ref:26.74646783899516 - timing_s/adv:0.040085108019411564 - timing_s/update_actor:85.44257511780597 - timing_s/step:205.8694173390977 - timing_s/stop_profile:4.839897155761719e-05 - timing_per_token_ms/gen:0.0943479803002177 - timing_per_token_ms/ref:0.029647341627920685 - timing_per_token_ms/adv:4.443266672808807e-05 - timing_per_token_ms/update_actor:0.09470952311668071 - perf/total_num_tokens:902154 - perf/time_per_step:205.8694173390977 - perf/throughput:1095.5415472347909
[36m(TaskRunner pid=4953)[0m Training Progress:  59%|█████▊    | 34/58 [2:33:37<1:29:25, 223.56s/it]
[36m(TaskRunner pid=4953)[0m step:34 - actor/entropy:0.16370438039302826 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0003726734535405285) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(-3.825860498096745e-05) - actor/grad_norm:np.float64(0.11438187211751938) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(155.31882762908936) - actor/lr:np.float64(3e-06) - training/global_step:34 - training/epoch:0 - critic/score/mean:0.4521484375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4521484375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.04714002460241318 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.04714002460241318 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:716.5107421875 - response_length/max:4096.0 - response_length/min:125.0 - response_length/clip_ratio:0.01171875 - response_length_non_aborted/mean:716.5107421875 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:125.0 - response_length_non_aborted/clip_ratio:0.01171875 - response/aborted_ratio:0.0 - prompt_length/mean:140.703125 - prompt_length/max:507.0 - prompt_length/min:78.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.046107642352581e-05 - timing_s/generate_sequences:53.447940826416016 - timing_s/generation_timing/max:56.712711334228516 - timing_s/generation_timing/min:50.18342590332031 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:61.43657123204321 - timing_s/reward:0.2358219139277935 - timing_s/old_log_prob:21.39541413495317 - timing_s/ref:26.535660499939695 - timing_s/adv:0.03920359699986875 - timing_s/update_actor:84.42181311314926 - timing_s/step:194.22996051004156 - timing_s/stop_profile:0.00010944600217044353 - timing_per_token_ms/gen:0.0837344760674809 - timing_per_token_ms/ref:0.0302301816954907 - timing_per_token_ms/adv:4.4661856463890156e-05 - timing_per_token_ms/update_actor:0.09617573866228282 - perf/total_num_tokens:877787 - perf/time_per_step:194.22996051004156 - perf/throughput:1129.829555768533
[36m(TaskRunner pid=4953)[0m Training Progress:  60%|██████    | 35/58 [2:36:47<1:21:52, 213.57s/it]
[36m(TaskRunner pid=4953)[0m step:35 - actor/entropy:0.17286263406276703 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00037374866718664634) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(7.606220043498979e-05) - actor/grad_norm:np.float64(0.08826672285795212) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(155.1350612640381) - actor/lr:np.float64(3e-06) - training/global_step:35 - training/epoch:0 - critic/score/mean:0.5234375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5234375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.05761824920773506 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.05761824920773506 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:668.859375 - response_length/max:4096.0 - response_length/min:140.0 - response_length/clip_ratio:0.0078125 - response_length_non_aborted/mean:668.859375 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:140.0 - response_length_non_aborted/clip_ratio:0.0078125 - response/aborted_ratio:0.0 - prompt_length/mean:147.4296875 - prompt_length/max:612.0 - prompt_length/min:78.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.999486893415451e-05 - timing_s/generate_sequences:50.105690002441406 - timing_s/generation_timing/max:54.17938232421875 - timing_s/generation_timing/min:45.993316650390625 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:58.765723305987194 - timing_s/reward:0.22523041511885822 - timing_s/old_log_prob:21.14887844515033 - timing_s/ref:26.353094248101115 - timing_s/adv:0.03571794414892793 - timing_s/update_actor:83.52627977402881 - timing_s/step:190.22105641686358 - timing_s/stop_profile:3.124098293483257e-05 - timing_per_token_ms/gen:0.08580039962212255 - timing_per_token_ms/ref:0.03152736546884854 - timing_per_token_ms/adv:4.273094720405791e-05 - timing_per_token_ms/update_actor:0.09992616137965833 - perf/total_num_tokens:835880 - perf/time_per_step:190.22105641686358 - perf/throughput:1098.5639757043969
[36m(TaskRunner pid=4953)[0m Training Progress:  62%|██████▏   | 36/58 [2:39:58<1:15:45, 206.62s/it]
[36m(TaskRunner pid=4953)[0m step:36 - actor/entropy:0.14525587856769562 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00037702679318840637) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(5.3351979460103394e-05) - actor/grad_norm:np.float64(0.11825766414403915) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(154.56393432617188) - actor/lr:np.float64(3e-06) - training/global_step:36 - training/epoch:0 - critic/score/mean:0.5380859375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5380859375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.08883114904165268 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.08883114904165268 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:683.5986328125 - response_length/max:4096.0 - response_length/min:142.0 - response_length/clip_ratio:0.0107421875 - response_length_non_aborted/mean:683.5986328125 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:142.0 - response_length_non_aborted/clip_ratio:0.0107421875 - response/aborted_ratio:0.0 - prompt_length/mean:138.96875 - prompt_length/max:744.0 - prompt_length/min:74.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.14470336586237e-05 - timing_s/generate_sequences:51.7426643371582 - timing_s/generation_timing/max:53.63392639160156 - timing_s/generation_timing/min:49.69931411743164 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:58.6839539820794 - timing_s/reward:0.22854335000738502 - timing_s/old_log_prob:21.128920299001038 - timing_s/ref:26.400463858852163 - timing_s/adv:0.044219546020030975 - timing_s/update_actor:83.63069261796772 - timing_s/step:190.3129886360839 - timing_s/stop_profile:4.391488619148731e-05 - timing_per_token_ms/gen:0.08383362116281941 - timing_per_token_ms/ref:0.031342967793116495 - timing_per_token_ms/adv:5.2498009661574286e-05 - timing_per_token_ms/update_actor:0.09928742613217682 - perf/total_num_tokens:842309 - perf/time_per_step:190.3129886360839 - perf/throughput:1106.4786040571587
[36m(TaskRunner pid=4953)[0m Training Progress:  64%|██████▍   | 37/58 [2:43:12<1:11:04, 203.08s/it]
[36m(TaskRunner pid=4953)[0m step:37 - actor/entropy:0.1637447327375412 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0003638004421304686) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(4.731226411536227e-05) - actor/grad_norm:np.float64(0.10180008411407471) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(154.65795993804932) - actor/lr:np.float64(3e-06) - training/global_step:37 - training/epoch:0 - critic/score/mean:0.5322265625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5322265625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.08756089955568314 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.08756089955568314 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:689.7236328125 - response_length/max:4096.0 - response_length/min:134.0 - response_length/clip_ratio:0.009765625 - response_length_non_aborted/mean:689.7236328125 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:134.0 - response_length_non_aborted/clip_ratio:0.009765625 - response/aborted_ratio:0.0 - prompt_length/mean:138.84375 - prompt_length/max:659.0 - prompt_length/min:79.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.048000745475292e-05 - timing_s/generate_sequences:52.86480712890625 - timing_s/generation_timing/max:57.87852096557617 - timing_s/generation_timing/min:47.843467712402344 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:62.77460876409896 - timing_s/reward:0.30973488721065223 - timing_s/old_log_prob:21.251859333133325 - timing_s/ref:26.39220625697635 - timing_s/adv:0.04374835197813809 - timing_s/update_actor:83.68879574607126 - timing_s/step:194.73197685508057 - timing_s/stop_profile:3.788899630308151e-05 - timing_per_token_ms/gen:0.08888100386123143 - timing_per_token_ms/ref:0.03110626782741808 - timing_per_token_ms/adv:5.156249312352963e-05 - timing_per_token_ms/update_actor:0.09863692596534077 - perf/total_num_tokens:848453 - perf/time_per_step:194.73197685508057 - perf/throughput:1089.2574164019018
[36m(TaskRunner pid=4953)[0m Training Progress:  66%|██████▌   | 38/58 [2:46:21<1:06:16, 198.85s/it]
[36m(TaskRunner pid=4953)[0m step:38 - actor/entropy:0.18047456443309784 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00039329732786086424) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(6.171423878242877e-05) - actor/grad_norm:np.float64(0.11012522131204605) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(155.42567443847656) - actor/lr:np.float64(3e-06) - training/global_step:38 - training/epoch:0 - critic/score/mean:0.5302734375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5302734375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0745527371764183 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.0745527371764183 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:662.8095703125 - response_length/max:4096.0 - response_length/min:86.0 - response_length/clip_ratio:0.009765625 - response_length_non_aborted/mean:662.8095703125 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:86.0 - response_length_non_aborted/clip_ratio:0.009765625 - response/aborted_ratio:0.0 - prompt_length/mean:144.4453125 - prompt_length/max:908.0 - prompt_length/min:76.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.7600984796881676e-05 - timing_s/generate_sequences:49.91126251220703 - timing_s/generation_timing/max:52.34977340698242 - timing_s/generation_timing/min:47.49431228637695 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:57.3748486249242 - timing_s/reward:0.29116849415004253 - timing_s/old_log_prob:21.015107239829376 - timing_s/ref:26.308479354018345 - timing_s/adv:0.040011556120589375 - timing_s/update_actor:83.5920419250615 - timing_s/step:188.89834137796424 - timing_s/stop_profile:3.130198456346989e-05 - timing_per_token_ms/gen:0.08453427367359916 - timing_per_token_ms/ref:0.03182622355859563 - timing_per_token_ms/adv:4.840328142442302e-05 - timing_per_token_ms/update_actor:0.10112401322124133 - perf/total_num_tokens:826629 - perf/time_per_step:188.89834137796424 - perf/throughput:1094.0130468721384
[36m(TaskRunner pid=4953)[0m Training Progress:  67%|██████▋   | 39/58 [2:49:31<1:02:07, 196.20s/it]
[36m(TaskRunner pid=4953)[0m step:39 - actor/entropy:0.15674090385437012 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00037869991675165693) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(2.7521567375288214e-05) - actor/grad_norm:np.float64(0.11828000843524933) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(155.8727035522461) - actor/lr:np.float64(3e-06) - training/global_step:39 - training/epoch:0 - critic/score/mean:0.541015625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.541015625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.11898555606603622 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.11898555606603622 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:660.51171875 - response_length/max:4096.0 - response_length/min:146.0 - response_length/clip_ratio:0.01171875 - response_length_non_aborted/mean:660.51171875 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:146.0 - response_length_non_aborted/clip_ratio:0.01171875 - response/aborted_ratio:0.0 - prompt_length/mean:130.703125 - prompt_length/max:705.0 - prompt_length/min:77.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.353684097528458e-05 - timing_s/generate_sequences:49.53264617919922 - timing_s/generation_timing/max:54.678897857666016 - timing_s/generation_timing/min:44.41115188598633 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:59.348149518016726 - timing_s/reward:0.2189701870083809 - timing_s/old_log_prob:21.006012938916683 - timing_s/ref:26.33964076009579 - timing_s/adv:0.03632624400779605 - timing_s/update_actor:82.77161073498428 - timing_s/step:189.96037494996563 - timing_s/stop_profile:7.750699296593666e-05 - timing_per_token_ms/gen:0.08774587281111461 - timing_per_token_ms/ref:0.032509887337134585 - timing_per_token_ms/adv:4.483592281424931e-05 - timing_per_token_ms/update_actor:0.10216144419798505 - perf/total_num_tokens:810204 - perf/time_per_step:189.96037494996563 - perf/throughput:1066.280270574064
[36m(TaskRunner pid=4953)[0m test_gen_batch meta info: {'eos_token_id': 151643, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 40}
[36m(TaskRunner pid=4953)[0m validation generation end
[36m(TaskRunner pid=4953)[0m [prompt] system
[36m(TaskRunner pid=4953)[0m You are a helpful AI Assistant, designed to provide well-reasoned and detailed responses. You FIRST think about the reasoning process step by step and then provide the user with the answer. Please enclose your final answer in the box: \boxed{Your Answer}.
[36m(TaskRunner pid=4953)[0m user
[36m(TaskRunner pid=4953)[0m Bin $A$ has one white ball and four black balls.  Bin $B$ has three balls labeled $\$1$ and one ball labeled $\$7$.  Bin $W$ has five balls labeled $\$8$ and one ball labeled $\$500$.  A game is played as follows: a ball is randomly selected from bin $A$.  If it is black, then a ball is randomly selected from bin $B$; otherwise, if the original ball is white, then a ball is randomly selected from bin $W$.  You win the amount printed on the second ball selected.  What is your expected win?
[36m(TaskRunner pid=4953)[0m assistant
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m [response] To determine the expected win in this game, we need to consider the probabilities and the corresponding winnings for each possible outcome. Let's break down the problem step by step.
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m 1. **Calculate the probability of selecting a black ball from bin \(A\):**
[36m(TaskRunner pid=4953)[0m    Bin \(A\) has 1 white ball and 4 black balls, so the total number of balls in bin \(A\) is 5. The probability of selecting a black ball from bin \(A\) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    P(\text{Black from } A) = \frac{4}{5}
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m    If a black ball is selected from bin \(A\), then a ball is randomly selected from bin \(B\). Bin \(B\) has 3 balls labeled \$1 and 1 ball labeled \$7, so the total number of balls in bin \(B\) is 4. The probability of selecting a ball labeled \$1 from bin \(B\) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    P(\$1 \text{ from } B \mid \text{Black from } A) = \frac{3}{4}
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m    The probability of selecting a ball labeled \$7 from bin \(B\) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    P(\$7 \text{ from } B \mid \text{Black from } A) = \frac{1}{4}
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m    The expected value of the winnings if a black ball is selected from bin \(A\) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    E(\$1 \text{ from } B \mid \text{Black from } A) \cdot \frac{3}{4} + E(\$7 \text{ from } B \mid \text{Black from } A) \cdot \frac{1}{4} = \frac{3}{4} \cdot 1 + \frac{1}{4} \cdot 7 = \frac{3}{4} + \frac{7}{4} = 3
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m 2. **Calculate the probability of selecting a white ball from bin \(A\):**
[36m(TaskRunner pid=4953)[0m    The probability of selecting a white ball from bin \(A\) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    P(\text{White from } A) = \frac{1}{5}
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m    If a white ball is selected from bin \(A\), then a ball is randomly selected from bin \(W\). Bin \(W\) has 5 balls labeled \$8 and 1 ball labeled \$500, so the total number of balls in bin \(W\) is 6. The probability of selecting a ball labeled \$8 from bin \(W\) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    P(\$8 \text{ from } W \mid \text{White from } A) = \frac{5}{6}
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m    The probability of selecting a ball labeled \$500 from bin \(W\) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    P(\$500 \text{ from } W \mid \text{White from } A) = \frac{1}{6}
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m    The expected value of the winnings if a white ball is selected from bin \(A\) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    E(\$8 \text{ from } W \mid \text{White from } A) \cdot \frac{5}{6} + E(\$500 \text{ from } W \mid \text{White from } A) \cdot \frac{1}{6} = \frac{5}{6} \cdot 8 + \frac{1}{6} \cdot 500 = \frac{40}{6} + \frac{500}{6} = \frac{540}{6} = 90
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m 3. **Calculate the overall expected win:**
[36m(TaskRunner pid=4953)[0m    The overall expected win is the weighted average of the expected winnings from the two scenarios, weighted by their respective probabilities:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    E(\text{Win}) = P(\text{Black from } A) \cdot E(\$1 \text{ from } B \mid \text{Black from } A) + P(\text{White from } A) \cdot E(\$8 \text{ from } W \mid \text{White from } A) = \frac{4}{5} \cdot 3 + \frac{1}{5} \cdot 90 = \frac{12}{5} + \frac{90}{5} = \frac{102}{5} = 20.4
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m Therefore, the expected win is \(\boxed{20.4}\).
[36m(TaskRunner pid=4953)[0m [ground_truth] \$20
[36m(TaskRunner pid=4953)[0m [score] 0.0
[36m(TaskRunner pid=4953)[0m Training Progress:  69%|██████▉   | 40/58 [2:57:43<1:25:24, 284.69s/it]
[36m(TaskRunner pid=4953)[0m step:40 - actor/entropy:0.15806542336940765 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00038487094946049183) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(4.871437445785887e-05) - actor/grad_norm:np.float64(0.10040100663900375) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(155.31842041015625) - actor/lr:np.float64(3e-06) - val-core/DigitalLearningGmbH/MATH-lighteval/reward/mean@1:np.float64(0.5434173669467787) - training/global_step:40 - training/epoch:0 - critic/score/mean:0.4814453125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4814453125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.06356406211853027 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.06356406211853027 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:666.0185546875 - response_length/max:4096.0 - response_length/min:143.0 - response_length/clip_ratio:0.001953125 - response_length_non_aborted/mean:666.0185546875 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:143.0 - response_length_non_aborted/clip_ratio:0.001953125 - response/aborted_ratio:0.0 - prompt_length/mean:138.5703125 - prompt_length/max:656.0 - prompt_length/min:73.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.1532952561974525e-05 - timing_s/generate_sequences:49.8995361328125 - timing_s/generation_timing/max:55.87522888183594 - timing_s/generation_timing/min:43.932167053222656 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:61.16220973804593 - timing_s/reward:0.29492928902618587 - timing_s/old_log_prob:20.990421558963135 - timing_s/ref:26.260457642143592 - timing_s/adv:0.040374357951804996 - timing_s/update_actor:82.86603845981881 - timing_s/step:191.88471787283197 - timing_s/testing:299.1949130750727 - timing_s/stop_profile:3.980705514550209e-05 - timing_per_token_ms/gen:0.08968026495198105 - timing_per_token_ms/ref:0.031873394241458713 - timing_per_token_ms/adv:4.900401378300616e-05 - timing_per_token_ms/update_actor:0.10057790877257869 - perf/total_num_tokens:823899 - perf/time_per_step:191.88471787283197 - perf/throughput:1073.4296732088167
[36m(TaskRunner pid=4953)[0m Training Progress:  71%|███████   | 41/58 [3:00:47<1:12:08, 254.61s/it]
[36m(TaskRunner pid=4953)[0m step:41 - actor/entropy:0.14579565823078156 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00042677686428760353) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(2.6827415226193807e-05) - actor/grad_norm:np.float64(0.11128545552492142) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(156.8253631591797) - actor/lr:np.float64(3e-06) - training/global_step:41 - training/epoch:0 - critic/score/mean:0.5078125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5078125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.05359295383095741 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.05359295383095741 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:601.9541015625 - response_length/max:4096.0 - response_length/min:131.0 - response_length/clip_ratio:0.00390625 - response_length_non_aborted/mean:601.9541015625 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:131.0 - response_length_non_aborted/clip_ratio:0.00390625 - response/aborted_ratio:0.0 - prompt_length/mean:147.015625 - prompt_length/max:775.0 - prompt_length/min:76.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.5235112085938454e-05 - timing_s/generate_sequences:49.11471176147461 - timing_s/generation_timing/max:51.8283805847168 - timing_s/generation_timing/min:46.539791107177734 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:55.55711696809158 - timing_s/reward:0.21424580295570195 - timing_s/old_log_prob:20.692444232990965 - timing_s/ref:26.102509011048824 - timing_s/adv:0.04814979201182723 - timing_s/update_actor:81.52154065412469 - timing_s/step:184.33178989496082 - timing_s/stop_profile:4.2288098484277725e-05 - timing_per_token_ms/gen:0.09013145171421133 - timing_per_token_ms/ref:0.034034394918864876 - timing_per_token_ms/adv:6.27812842013798e-05 - timing_per_token_ms/update_actor:0.10629385504061528 - perf/total_num_tokens:766945 - perf/time_per_step:184.33178989496082 - perf/throughput:1040.1691976693685
[36m(TaskRunner pid=4953)[0m Training Progress:  72%|███████▏  | 42/58 [3:03:55<1:02:33, 234.57s/it]
[36m(TaskRunner pid=4953)[0m step:42 - actor/entropy:0.14000268280506134 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00041104958680193704) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(4.3745021173435816e-05) - actor/grad_norm:np.float64(0.11023794114589691) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(155.65431594848633) - actor/lr:np.float64(3e-06) - training/global_step:42 - training/epoch:0 - critic/score/mean:0.5185546875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5185546875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.056534405797719955 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.056534405797719955 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:646.6787109375 - response_length/max:4096.0 - response_length/min:113.0 - response_length/clip_ratio:0.005859375 - response_length_non_aborted/mean:646.6787109375 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:113.0 - response_length_non_aborted/clip_ratio:0.005859375 - response/aborted_ratio:0.0 - prompt_length/mean:148.609375 - prompt_length/max:885.0 - prompt_length/min:76.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.455384522676468e-05 - timing_s/generate_sequences:49.614585876464844 - timing_s/generation_timing/max:52.60560607910156 - timing_s/generation_timing/min:46.62361526489258 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:57.19067024299875 - timing_s/reward:0.22401371411979198 - timing_s/old_log_prob:21.023005448980257 - timing_s/ref:26.33308697398752 - timing_s/adv:0.03480112110264599 - timing_s/update_actor:82.70512972702272 - timing_s/step:187.72677977615967 - timing_s/stop_profile:5.299411714076996e-05 - timing_per_token_ms/gen:0.08636477893050087 - timing_per_token_ms/ref:0.032335333199063725 - timing_per_token_ms/adv:4.2733533203556095e-05 - timing_per_token_ms/update_actor:0.10155656758498569 - perf/total_num_tokens:814375 - perf/time_per_step:187.72677977615967 - perf/throughput:1084.5216129673117
[36m(TaskRunner pid=4953)[0m Training Progress:  74%|███████▍  | 43/58 [3:07:03<55:08, 220.56s/it]  
[36m(TaskRunner pid=4953)[0m step:43 - actor/entropy:0.18626749515533447 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00041779994452895153) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(2.794150478280244e-05) - actor/grad_norm:np.float64(0.12005729228258133) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(154.1490020751953) - actor/lr:np.float64(3e-06) - training/global_step:43 - training/epoch:0 - critic/score/mean:0.5068359375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5068359375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.044301457703113556 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.044301457703113556 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:630.3427734375 - response_length/max:4096.0 - response_length/min:148.0 - response_length/clip_ratio:0.005859375 - response_length_non_aborted/mean:630.3427734375 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:148.0 - response_length_non_aborted/clip_ratio:0.005859375 - response/aborted_ratio:0.0 - prompt_length/mean:152.71875 - prompt_length/max:883.0 - prompt_length/min:74.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.08880028873682e-05 - timing_s/generate_sequences:48.52071762084961 - timing_s/generation_timing/max:52.67964172363281 - timing_s/generation_timing/min:44.3115234375 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:57.57507949392311 - timing_s/reward:0.2208983839955181 - timing_s/old_log_prob:20.878912740154192 - timing_s/ref:26.264772367896512 - timing_s/adv:0.03683986305259168 - timing_s/update_actor:82.67068003793247 - timing_s/step:187.82937649195082 - timing_s/stop_profile:3.183586522936821e-05 - timing_per_token_ms/gen:0.08919855344999715 - timing_per_token_ms/ref:0.032755014769374154 - timing_per_token_ms/adv:4.5943297793979814e-05 - timing_per_token_ms/update_actor:0.10309928857203918 - perf/total_num_tokens:801855 - perf/time_per_step:187.82937649195082 - perf/throughput:1067.265162372461
[36m(TaskRunner pid=4953)[0m Training Progress:  76%|███████▌  | 44/58 [3:10:14<49:26, 211.91s/it]
[36m(TaskRunner pid=4953)[0m step:44 - actor/entropy:0.19441130757331848 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0004251021000811761) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(3.415338255763345e-06) - actor/grad_norm:np.float64(0.1047997772693634) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(154.72993850708008) - actor/lr:np.float64(3e-06) - training/global_step:44 - training/epoch:0 - critic/score/mean:0.529296875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.529296875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.057880036532878876 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.057880036532878876 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:671.5439453125 - response_length/max:4096.0 - response_length/min:140.0 - response_length/clip_ratio:0.0068359375 - response_length_non_aborted/mean:671.5439453125 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:140.0 - response_length_non_aborted/clip_ratio:0.0068359375 - response/aborted_ratio:0.0 - prompt_length/mean:134.2421875 - prompt_length/max:539.0 - prompt_length/min:78.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.017787382006645e-05 - timing_s/generate_sequences:51.25185775756836 - timing_s/generation_timing/max:55.65605163574219 - timing_s/generation_timing/min:46.80394744873047 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:60.46964782406576 - timing_s/reward:0.22393867000937462 - timing_s/old_log_prob:21.001618723850697 - timing_s/ref:26.496752646984532 - timing_s/adv:0.03538342984393239 - timing_s/update_actor:83.19177238293923 - timing_s/step:191.68316038302146 - timing_s/stop_profile:3.083096817135811e-05 - timing_per_token_ms/gen:0.08793525854173169 - timing_per_token_ms/ref:0.032112410419008676 - timing_per_token_ms/adv:4.288250852165719e-05 - timing_per_token_ms/update_actor:0.10082323573148218 - perf/total_num_tokens:825125 - perf/time_per_step:191.68316038302146 - perf/throughput:1076.1573921663678
[36m(TaskRunner pid=4953)[0m Training Progress:  78%|███████▊  | 45/58 [3:13:16<43:55, 202.76s/it]
[36m(TaskRunner pid=4953)[0m step:45 - actor/entropy:0.13932466506958008 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00043367915873204765) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(3.177437388757198e-05) - actor/grad_norm:np.float64(0.11581668257713318) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(155.0205421447754) - actor/lr:np.float64(3e-06) - training/global_step:45 - training/epoch:0 - critic/score/mean:0.583984375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.583984375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.07095681130886078 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.07095681130886078 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:601.0322265625 - response_length/max:4096.0 - response_length/min:108.0 - response_length/clip_ratio:0.0048828125 - response_length_non_aborted/mean:601.0322265625 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:108.0 - response_length_non_aborted/clip_ratio:0.0048828125 - response/aborted_ratio:0.0 - prompt_length/mean:127.8671875 - prompt_length/max:373.0 - prompt_length/min:75.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.786004476249218e-05 - timing_s/generate_sequences:46.94606018066406 - timing_s/generation_timing/max:48.128326416015625 - timing_s/generation_timing/min:45.773521423339844 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:52.96678834198974 - timing_s/reward:0.2824640430044383 - timing_s/old_log_prob:20.512914885999635 - timing_s/ref:26.08973083109595 - timing_s/adv:0.03790954011492431 - timing_s/update_actor:81.1942191880662 - timing_s/step:181.33990114880726 - timing_s/stop_profile:3.245193511247635e-05 - timing_per_token_ms/gen:0.08606090814141319 - timing_per_token_ms/ref:0.03495441520900645 - timing_per_token_ms/adv:5.079032107070178e-05 - timing_per_token_ms/update_actor:0.10878212843376907 - perf/total_num_tokens:746393 - perf/time_per_step:181.33990114880726 - perf/throughput:1028.997197075109
[36m(TaskRunner pid=4953)[0m Training Progress:  79%|███████▉  | 46/58 [3:16:19<39:24, 197.02s/it]
[36m(TaskRunner pid=4953)[0m step:46 - actor/entropy:0.1607206016778946 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00044420663212463296) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(4.955054561861516e-05) - actor/grad_norm:np.float64(0.1012917011976242) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(154.13065338134766) - actor/lr:np.float64(3e-06) - training/global_step:46 - training/epoch:0 - critic/score/mean:0.55859375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.55859375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.04599790275096893 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.04599790275096893 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:602.3466796875 - response_length/max:4096.0 - response_length/min:95.0 - response_length/clip_ratio:0.0029296875 - response_length_non_aborted/mean:602.3466796875 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:95.0 - response_length_non_aborted/clip_ratio:0.0029296875 - response/aborted_ratio:0.0 - prompt_length/mean:145.1953125 - prompt_length/max:812.0 - prompt_length/min:74.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.6311958208680153e-05 - timing_s/generate_sequences:47.42253494262695 - timing_s/generation_timing/max:49.70229721069336 - timing_s/generation_timing/min:45.112056732177734 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:54.4696723499801 - timing_s/reward:0.21677172905765474 - timing_s/old_log_prob:20.66451341402717 - timing_s/ref:26.17266218410805 - timing_s/adv:0.040226293029263616 - timing_s/update_actor:81.73964667902328 - timing_s/step:183.5106969519984 - timing_s/stop_profile:4.187691956758499e-05 - timing_per_token_ms/gen:0.08830967480699689 - timing_per_token_ms/ref:0.03419104302003839 - timing_per_token_ms/adv:5.25502108201797e-05 - timing_per_token_ms/update_actor:0.10678179225276496 - perf/total_num_tokens:765483 - perf/time_per_step:183.5106969519984 - perf/throughput:1042.8315797310584
[36m(TaskRunner pid=4953)[0m Training Progress:  81%|████████  | 47/58 [3:19:29<35:43, 194.84s/it]
[36m(TaskRunner pid=4953)[0m step:47 - actor/entropy:0.12877394258975983 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00043350389623242336) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(4.88024542733001e-06) - actor/grad_norm:np.float64(0.10418744385242462) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(155.1815185546875) - actor/lr:np.float64(3e-06) - training/global_step:47 - training/epoch:0 - critic/score/mean:0.6181640625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6181640625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.08700624108314514 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.08700624108314514 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:646.6875 - response_length/max:4096.0 - response_length/min:132.0 - response_length/clip_ratio:0.0107421875 - response_length_non_aborted/mean:646.6875 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:132.0 - response_length_non_aborted/clip_ratio:0.0107421875 - response/aborted_ratio:0.0 - prompt_length/mean:129.828125 - prompt_length/max:340.0 - prompt_length/min:74.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.8977013900876045e-05 - timing_s/generate_sequences:49.56855773925781 - timing_s/generation_timing/max:54.1048469543457 - timing_s/generation_timing/min:44.98078155517578 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:58.97043855022639 - timing_s/reward:0.29013617103919387 - timing_s/old_log_prob:20.915727687068284 - timing_s/ref:26.502065336098894 - timing_s/adv:0.045006546191871166 - timing_s/update_actor:82.71157439798117 - timing_s/step:189.6946424699854 - timing_s/stop_profile:3.779190592467785e-05 - timing_per_token_ms/gen:0.08905123246808615 - timing_per_token_ms/ref:0.03332955879642999 - timing_per_token_ms/adv:5.660118592655387e-05 - timing_per_token_ms/update_actor:0.10401982815610245 - perf/total_num_tokens:795152 - perf/time_per_step:189.6946424699854 - perf/throughput:1047.9368178859
[36m(TaskRunner pid=4953)[0m Training Progress:  83%|████████▎ | 48/58 [3:22:28<31:39, 189.90s/it]
[36m(TaskRunner pid=4953)[0m step:48 - actor/entropy:0.14351050555706024 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00044506162660695736) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(7.32106543921418e-05) - actor/grad_norm:np.float64(0.12288936972618103) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(155.3009033203125) - actor/lr:np.float64(3e-06) - training/global_step:48 - training/epoch:0 - critic/score/mean:0.5283203125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5283203125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.03508613631129265 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.03508613631129265 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:599.0830078125 - response_length/max:4096.0 - response_length/min:115.0 - response_length/clip_ratio:0.0029296875 - response_length_non_aborted/mean:599.0830078125 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:115.0 - response_length_non_aborted/clip_ratio:0.0029296875 - response/aborted_ratio:0.0 - prompt_length/mean:135.3125 - prompt_length/max:448.0 - prompt_length/min:78.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.276905044913292e-05 - timing_s/generate_sequences:45.237239837646484 - timing_s/generation_timing/max:45.34687423706055 - timing_s/generation_timing/min:45.13727951049805 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:50.25841842405498 - timing_s/reward:0.21151935984380543 - timing_s/old_log_prob:20.51914359908551 - timing_s/ref:26.004935014992952 - timing_s/adv:0.04087568703107536 - timing_s/update_actor:81.08904760004953 - timing_s/step:178.33251466206275 - timing_s/stop_profile:3.893813118338585e-05 - timing_per_token_ms/gen:0.08192602043822668 - timing_per_token_ms/ref:0.03458006493833676 - timing_per_token_ms/adv:5.4354448919744736e-05 - timing_per_token_ms/update_actor:0.10782816916023559 - perf/total_num_tokens:752021 - perf/time_per_step:178.33251466206275 - perf/throughput:1054.2398864069569
[36m(TaskRunner pid=4953)[0m Training Progress:  84%|████████▍ | 49/58 [3:25:36<28:26, 189.62s/it]
[36m(TaskRunner pid=4953)[0m step:49 - actor/entropy:0.14809158444404602 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00041324476998738646) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(-1.6053644671387701e-06) - actor/grad_norm:np.float64(0.1034747064113617) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(156.02122116088867) - actor/lr:np.float64(3e-06) - training/global_step:49 - training/epoch:0 - critic/score/mean:0.5263671875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5263671875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.04148665815591812 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.04148665815591812 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:661.275390625 - response_length/max:4096.0 - response_length/min:157.0 - response_length/clip_ratio:0.005859375 - response_length_non_aborted/mean:661.275390625 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:157.0 - response_length_non_aborted/clip_ratio:0.005859375 - response/aborted_ratio:0.0 - prompt_length/mean:139.5078125 - prompt_length/max:410.0 - prompt_length/min:75.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.429804489016533e-05 - timing_s/generate_sequences:49.35722351074219 - timing_s/generation_timing/max:53.49332809448242 - timing_s/generation_timing/min:45.1965446472168 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:58.1187833850272 - timing_s/reward:0.23354281904175878 - timing_s/old_log_prob:21.11046607978642 - timing_s/ref:26.333722369046882 - timing_s/adv:0.04304988891817629 - timing_s/update_actor:82.83327439799905 - timing_s/step:188.91655974299647 - timing_s/stop_profile:3.872415982186794e-05 - timing_per_token_ms/gen:0.0858290285773337 - timing_per_token_ms/ref:0.03211421724464926 - timing_per_token_ms/adv:5.249973648622356e-05 - timing_per_token_ms/update_actor:0.10101594190989661 - perf/total_num_tokens:820002 - perf/time_per_step:188.91655974299647 - perf/throughput:1085.1377998778098
[36m(TaskRunner pid=4953)[0m test_gen_batch meta info: {'eos_token_id': 151643, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 50}
[36m(TaskRunner pid=4953)[0m validation generation end
[36m(TaskRunner pid=4953)[0m [prompt] system
[36m(TaskRunner pid=4953)[0m You are a helpful AI Assistant, designed to provide well-reasoned and detailed responses. You FIRST think about the reasoning process step by step and then provide the user with the answer. Please enclose your final answer in the box: \boxed{Your Answer}.
[36m(TaskRunner pid=4953)[0m user
[36m(TaskRunner pid=4953)[0m Bin $A$ has one white ball and four black balls.  Bin $B$ has three balls labeled $\$1$ and one ball labeled $\$7$.  Bin $W$ has five balls labeled $\$8$ and one ball labeled $\$500$.  A game is played as follows: a ball is randomly selected from bin $A$.  If it is black, then a ball is randomly selected from bin $B$; otherwise, if the original ball is white, then a ball is randomly selected from bin $W$.  You win the amount printed on the second ball selected.  What is your expected win?
[36m(TaskRunner pid=4953)[0m assistant
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m [response] To determine the expected win in this game, we need to consider the probabilities and the corresponding winnings for each possible outcome. Let's break down the problem step by step.
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m 1. **Calculate the probability of selecting a black ball from bin \(A\):**
[36m(TaskRunner pid=4953)[0m    Bin \(A\) has 4 black balls and 1 white ball, so the total number of balls in bin \(A\) is 5. The probability of selecting a black ball from bin \(A\) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    P(\text{Black from } A) = \frac{4}{5}
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m    If a black ball is selected from bin \(A\), then a ball is randomly selected from bin \(B\). Bin \(B\) has 3 balls labeled \$1 and 1 ball labeled \$7, so the probability of selecting a ball from bin \(B\) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    P(\text{Ball from } B \mid \text{Black from } A) = \frac{3}{4}
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m    The expected value of the winnings if a ball from bin \(B\) is selected is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    E(\text{Winnings} \mid \text{Black from } A) = 1 \cdot \frac{3}{4} + 7 \cdot \frac{1}{4} = \frac{3}{4} + \frac{7}{4} = \frac{10}{4} = 2.5
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m 2. **Calculate the probability of selecting a white ball from bin \(A\):**
[36m(TaskRunner pid=4953)[0m    The probability of selecting a white ball from bin \(A\) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    P(\text{White from } A) = \frac{1}{5}
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m    If a white ball is selected from bin \(A\), then a ball is randomly selected from bin \(W\). Bin \(W\) has 5 balls labeled \$8 and 1 ball labeled \$500, so the probability of selecting a ball from bin \(W\) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    P(\text{Ball from } W \mid \text{White from } A) = \frac{5}{6}
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m    The expected value of the winnings if a ball from bin \(W\) is selected is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    E(\text{Winnings} \mid \text{White from } A) = 8 \cdot \frac{5}{6} + 500 \cdot \frac{1}{6} = \frac{40}{6} + \frac{500}{6} = \frac{540}{6} = 90
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m 3. **Calculate the overall expected win:**
[36m(TaskRunner pid=4953)[0m    The overall expected win is the weighted average of the expected winnings from each outcome, using the probabilities of each outcome:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    E(\text{Winnings}) = P(\text{Black from } A) \cdot E(\text{Winnings} \mid \text{Black from } A) + P(\text{White from } A) \cdot E(\text{Winnings} \mid \text{White from } A)
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m    Substituting the values we calculated:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    E(\text{Winnings}) = \frac{4}{5} \cdot 2.5 + \frac{1}{5} \cdot 90 = \frac{10}{5} + \frac{90}{5} = \frac{100}{5} = 20
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m Therefore, the expected win is \(\boxed{20}\).
[36m(TaskRunner pid=4953)[0m [ground_truth] \$20
[36m(TaskRunner pid=4953)[0m [score] 1.0
[36m(TaskRunner pid=4953)[0m Training Progress:  86%|████████▌ | 50/58 [3:33:26<36:28, 273.61s/it]
[36m(TaskRunner pid=4953)[0m step:50 - actor/entropy:0.1366841346025467 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00042179258397823105) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(-1.1733397288438141e-05) - actor/grad_norm:np.float64(0.10411416739225388) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(154.18309020996094) - actor/lr:np.float64(3e-06) - val-core/DigitalLearningGmbH/MATH-lighteval/reward/mean@1:np.float64(0.5448179271708683) - training/global_step:50 - training/epoch:0 - critic/score/mean:0.5185546875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5185546875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.026064731180667877 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.026064731180667877 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:648.876953125 - response_length/max:4096.0 - response_length/min:122.0 - response_length/clip_ratio:0.0068359375 - response_length_non_aborted/mean:648.876953125 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:122.0 - response_length_non_aborted/clip_ratio:0.0068359375 - response/aborted_ratio:0.0 - prompt_length/mean:135.015625 - prompt_length/max:726.0 - prompt_length/min:78.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.459816798567772e-05 - timing_s/generate_sequences:49.2497673034668 - timing_s/generation_timing/max:55.0285530090332 - timing_s/generation_timing/min:43.41492462158203 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:59.79629517905414 - timing_s/reward:0.22186435107141733 - timing_s/old_log_prob:20.84874948882498 - timing_s/ref:26.33529696892947 - timing_s/adv:0.039852743037045 - timing_s/update_actor:82.45865914202295 - timing_s/step:189.89180805487558 - timing_s/testing:279.59616413200274 - timing_s/stop_profile:3.5773031413555145e-05 - timing_per_token_ms/gen:0.08999367172707373 - timing_per_token_ms/ref:0.03280814765172986 - timing_per_token_ms/adv:4.9647994455062007e-05 - timing_per_token_ms/update_actor:0.10272585372729612 - perf/total_num_tokens:802706 - perf/time_per_step:189.89180805487558 - perf/throughput:1056.7938767638034
[36m(TaskRunner pid=4953)[0m Training Progress:  88%|████████▊ | 51/58 [3:36:32<28:50, 247.20s/it]
[36m(TaskRunner pid=4953)[0m step:51 - actor/entropy:0.14522133767604828 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00047599548540233627) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(5.490231769300635e-05) - actor/grad_norm:np.float64(0.12574942409992218) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(155.35931777954102) - actor/lr:np.float64(3e-06) - training/global_step:51 - training/epoch:0 - critic/score/mean:0.544921875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.544921875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.06827665865421295 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.06827665865421295 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:632.3740234375 - response_length/max:4096.0 - response_length/min:140.0 - response_length/clip_ratio:0.0078125 - response_length_non_aborted/mean:632.3740234375 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:140.0 - response_length_non_aborted/clip_ratio:0.0078125 - response/aborted_ratio:0.0 - prompt_length/mean:138.9296875 - prompt_length/max:761.0 - prompt_length/min:76.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00015918794088065624 - timing_s/generate_sequences:49.47867965698242 - timing_s/generation_timing/max:51.050968170166016 - timing_s/generation_timing/min:47.83790969848633 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:55.21815118496306 - timing_s/reward:0.2228660900145769 - timing_s/old_log_prob:20.91843316005543 - timing_s/ref:26.400540388887748 - timing_s/adv:0.08887459780089557 - timing_s/update_actor:82.36944216210395 - timing_s/step:185.4592842599377 - timing_s/stop_profile:4.2111845687031746e-05 - timing_per_token_ms/gen:0.08527228154224618 - timing_per_token_ms/ref:0.033426233217763335 - timing_per_token_ms/adv:0.00011252584187549688 - timing_per_token_ms/update_actor:0.10428953889468287 - perf/total_num_tokens:789815 - perf/time_per_step:185.4592842599377 - perf/throughput:1064.6743881705647
[36m(TaskRunner pid=4953)[0m Training Progress:  90%|████████▉ | 52/58 [3:39:38<22:53, 229.00s/it]
[36m(TaskRunner pid=4953)[0m step:52 - actor/entropy:0.1539982557296753 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00045154041310979665) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(3.5776493234607187e-06) - actor/grad_norm:np.float64(0.10926061868667603) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(155.15975952148438) - actor/lr:np.float64(3e-06) - training/global_step:52 - training/epoch:0 - critic/score/mean:0.498046875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.498046875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.04082706198096275 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.04082706198096275 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:631.8505859375 - response_length/max:4096.0 - response_length/min:134.0 - response_length/clip_ratio:0.0078125 - response_length_non_aborted/mean:631.8505859375 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:134.0 - response_length_non_aborted/clip_ratio:0.0078125 - response/aborted_ratio:0.0 - prompt_length/mean:160.8203125 - prompt_length/max:787.0 - prompt_length/min:79.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.412706665694714e-05 - timing_s/generate_sequences:49.281822204589844 - timing_s/generation_timing/max:50.204437255859375 - timing_s/generation_timing/min:48.25019454956055 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:55.38707060087472 - timing_s/reward:0.3131239388603717 - timing_s/old_log_prob:21.03525217808783 - timing_s/ref:26.34016881720163 - timing_s/adv:0.04006566503085196 - timing_s/update_actor:83.00855756714009 - timing_s/step:186.4265471859835 - timing_s/stop_profile:7.915287278592587e-05 - timing_per_token_ms/gen:0.08560399774483547 - timing_per_token_ms/ref:0.03245082058803076 - timing_per_token_ms/adv:4.936049258755069e-05 - timing_per_token_ms/update_actor:0.1022657002533465 - perf/total_num_tokens:811695 - perf/time_per_step:186.4265471859835 - perf/throughput:1088.4917039071613
[36m(TaskRunner pid=4953)[0m Training Progress:  91%|█████████▏| 53/58 [3:42:40<17:54, 214.90s/it]
[36m(TaskRunner pid=4953)[0m step:53 - actor/entropy:0.14396928250789642 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00044296591758552495) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(5.09379579014535e-05) - actor/grad_norm:np.float64(0.11513496190309525) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(154.35295486450195) - actor/lr:np.float64(3e-06) - training/global_step:53 - training/epoch:0 - critic/score/mean:0.5791015625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5791015625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0482754185795784 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.0482754185795784 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:614.4873046875 - response_length/max:4096.0 - response_length/min:119.0 - response_length/clip_ratio:0.00390625 - response_length_non_aborted/mean:614.4873046875 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:119.0 - response_length_non_aborted/clip_ratio:0.00390625 - response/aborted_ratio:0.0 - prompt_length/mean:139.4609375 - prompt_length/max:485.0 - prompt_length/min:76.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.285588748753071e-05 - timing_s/generate_sequences:46.967674255371094 - timing_s/generation_timing/max:47.99638366699219 - timing_s/generation_timing/min:45.928253173828125 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:52.76541127683595 - timing_s/reward:0.2870798569638282 - timing_s/old_log_prob:20.661507867043838 - timing_s/ref:26.22342412103899 - timing_s/adv:0.0443512499332428 - timing_s/update_actor:81.6634275270626 - timing_s/step:181.92009113589302 - timing_s/stop_profile:4.134420305490494e-05 - timing_per_token_ms/gen:0.08385644675969384 - timing_per_token_ms/ref:0.03396627405602925 - timing_per_token_ms/adv:5.7446605866827105e-05 - timing_per_token_ms/update_actor:0.10577575021995225 - perf/total_num_tokens:772043 - perf/time_per_step:181.92009113589302 - perf/throughput:1060.9644531005777
[36m(TaskRunner pid=4953)[0m Training Progress:  93%|█████████▎| 54/58 [3:45:50<13:49, 207.31s/it]
[36m(TaskRunner pid=4953)[0m step:54 - actor/entropy:0.1571836918592453 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0004380270622448279) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(0.00010468629250226513) - actor/grad_norm:np.float64(0.11371029913425446) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(155.02063179016113) - actor/lr:np.float64(3e-06) - training/global_step:54 - training/epoch:0 - critic/score/mean:0.56640625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.56640625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0815088301897049 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.0815088301897049 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:624.4970703125 - response_length/max:4096.0 - response_length/min:156.0 - response_length/clip_ratio:0.005859375 - response_length_non_aborted/mean:624.4970703125 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:156.0 - response_length_non_aborted/clip_ratio:0.005859375 - response/aborted_ratio:0.0 - prompt_length/mean:142.53125 - prompt_length/max:969.0 - prompt_length/min:77.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.746780566871166e-05 - timing_s/generate_sequences:49.0393180847168 - timing_s/generation_timing/max:55.055049896240234 - timing_s/generation_timing/min:43.0463981628418 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:59.66707115015015 - timing_s/reward:0.28554574702866375 - timing_s/old_log_prob:20.817208704072982 - timing_s/ref:26.3267715270631 - timing_s/adv:0.050056062173098326 - timing_s/update_actor:82.14556148205884 - timing_s/step:189.51337464991957 - timing_s/stop_profile:6.498303264379501e-05 - timing_per_token_ms/gen:0.09330487994268849 - timing_per_token_ms/ref:0.0335186291542964 - timing_per_token_ms/adv:6.373020646226028e-05 - timing_per_token_ms/update_actor:0.10458580571332754 - perf/total_num_tokens:785437 - perf/time_per_step:189.51337464991957 - perf/throughput:1036.1234417503595
[36m(TaskRunner pid=4953)[0m Training Progress:  95%|█████████▍| 55/58 [3:48:53<09:59, 199.94s/it]
[36m(TaskRunner pid=4953)[0m step:55 - actor/entropy:0.1354510337114334 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.00046789514883016636) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(-8.116538801061779e-06) - actor/grad_norm:np.float64(0.10824130475521088) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(155.35049057006836) - actor/lr:np.float64(3e-06) - training/global_step:55 - training/epoch:0 - critic/score/mean:0.5625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.025575922802090645 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.025575922802090645 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:604.6953125 - response_length/max:4096.0 - response_length/min:136.0 - response_length/clip_ratio:0.00390625 - response_length_non_aborted/mean:604.6953125 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:136.0 - response_length_non_aborted/clip_ratio:0.00390625 - response/aborted_ratio:0.0 - prompt_length/mean:131.3203125 - prompt_length/max:602.0 - prompt_length/min:76.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.440709017217159e-05 - timing_s/generate_sequences:47.91535186767578 - timing_s/generation_timing/max:48.85563278198242 - timing_s/generation_timing/min:47.032958984375 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:53.95021841186099 - timing_s/reward:0.22189041320234537 - timing_s/old_log_prob:20.662134263198823 - timing_s/ref:26.16356580494903 - timing_s/adv:0.03907454898580909 - timing_s/update_actor:81.37453031004407 - timing_s/step:182.6642765100114 - timing_s/stop_profile:0.00010706786997616291 - timing_per_token_ms/gen:0.08712778002199743 - timing_per_token_ms/ref:0.03471442230780839 - timing_per_token_ms/adv:5.1845012453307885e-05 - timing_per_token_ms/update_actor:0.10796960289518637 - perf/total_num_tokens:753680 - perf/time_per_step:182.6642765100114 - perf/throughput:1031.5098474641982
[36m(TaskRunner pid=4953)[0m Training Progress:  97%|█████████▋| 56/58 [3:52:00<06:32, 196.29s/it]
[36m(TaskRunner pid=4953)[0m step:56 - actor/entropy:0.13183623552322388 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0004418512410495623) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(5.839014450126356e-05) - actor/grad_norm:np.float64(0.1101103350520134) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(156.42933654785156) - actor/lr:np.float64(3e-06) - training/global_step:56 - training/epoch:0 - critic/score/mean:0.58203125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.58203125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.05838765203952789 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.05838765203952789 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:604.2841796875 - response_length/max:4096.0 - response_length/min:146.0 - response_length/clip_ratio:0.0029296875 - response_length_non_aborted/mean:604.2841796875 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:146.0 - response_length_non_aborted/clip_ratio:0.0029296875 - response/aborted_ratio:0.0 - prompt_length/mean:137.8359375 - prompt_length/max:577.0 - prompt_length/min:77.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.7322985008358955e-05 - timing_s/generate_sequences:46.98955535888672 - timing_s/generation_timing/max:53.97036361694336 - timing_s/generation_timing/min:40.030147552490234 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:58.932962842984125 - timing_s/reward:0.2897908322047442 - timing_s/old_log_prob:20.693147964775562 - timing_s/ref:26.160363568924367 - timing_s/adv:0.06311590503901243 - timing_s/update_actor:81.2680831218604 - timing_s/step:187.68082856410183 - timing_s/stop_profile:4.323595203459263e-05 - timing_per_token_ms/gen:0.09523949734397155 - timing_per_token_ms/ref:0.03442465640817965 - timing_per_token_ms/adv:8.30547839725086e-05 - timing_per_token_ms/update_actor:0.10694139747142885 - perf/total_num_tokens:759931 - perf/time_per_step:187.68082856410183 - perf/throughput:1012.2650856430547
[36m(TaskRunner pid=4953)[0m Training Progress:  98%|█████████▊| 57/58 [3:55:03<03:12, 192.11s/it]
[36m(TaskRunner pid=4953)[0m step:57 - actor/entropy:0.14597631990909576 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0004552795020629219) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(4.951938208819229e-06) - actor/grad_norm:np.float64(0.1033845990896225) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(155.1479663848877) - actor/lr:np.float64(3e-06) - training/global_step:57 - training/epoch:0 - critic/score/mean:0.6220703125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6220703125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.02497120015323162 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.02497120015323162 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:581.650390625 - response_length/max:4096.0 - response_length/min:147.0 - response_length/clip_ratio:0.0078125 - response_length_non_aborted/mean:581.650390625 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:147.0 - response_length_non_aborted/clip_ratio:0.0078125 - response/aborted_ratio:0.0 - prompt_length/mean:134.8515625 - prompt_length/max:481.0 - prompt_length/min:77.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.093806147575378e-05 - timing_s/generate_sequences:46.55465316772461 - timing_s/generation_timing/max:49.47240447998047 - timing_s/generation_timing/min:43.601932525634766 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:53.97049215994775 - timing_s/reward:0.21857842500321567 - timing_s/old_log_prob:20.550600012997165 - timing_s/ref:26.156212464906275 - timing_s/adv:0.046329697128385305 - timing_s/update_actor:81.12264512502588 - timing_s/step:182.29124525887892 - timing_s/stop_profile:4.2218947783112526e-05 - timing_per_token_ms/gen:0.09061381131939987 - timing_per_token_ms/ref:0.0356498347615862 - timing_per_token_ms/adv:6.314545920581125e-05 - timing_per_token_ms/update_actor:0.110566806949216 - perf/total_num_tokens:733698 - perf/time_per_step:182.29124525887892 - perf/throughput:1006.2167260940683
[36m(TaskRunner pid=4953)[0m test_gen_batch meta info: {'eos_token_id': 151643, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 58}
[36m(TaskRunner pid=4953)[0m validation generation end
[36m(TaskRunner pid=4953)[0m [prompt] system
[36m(TaskRunner pid=4953)[0m You are a helpful AI Assistant, designed to provide well-reasoned and detailed responses. You FIRST think about the reasoning process step by step and then provide the user with the answer. Please enclose your final answer in the box: \boxed{Your Answer}.
[36m(TaskRunner pid=4953)[0m user
[36m(TaskRunner pid=4953)[0m Bin $A$ has one white ball and four black balls.  Bin $B$ has three balls labeled $\$1$ and one ball labeled $\$7$.  Bin $W$ has five balls labeled $\$8$ and one ball labeled $\$500$.  A game is played as follows: a ball is randomly selected from bin $A$.  If it is black, then a ball is randomly selected from bin $B$; otherwise, if the original ball is white, then a ball is randomly selected from bin $W$.  You win the amount printed on the second ball selected.  What is your expected win?
[36m(TaskRunner pid=4953)[0m assistant
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m [response] To determine the expected win in this game, we need to consider the probabilities and the corresponding winnings for each possible outcome. Let's break down the problem step by step.
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m 1. **Calculate the probability of selecting a black ball from bin \(A\):**
[36m(TaskRunner pid=4953)[0m    Bin \(A\) has 4 black balls and 1 white ball, so the total number of balls in bin \(A\) is 5. The probability of selecting a black ball from bin \(A\) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    P(\text{Black from } A) = \frac{4}{5}
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m    If a black ball is selected from bin \(A\), then a ball is randomly selected from bin \(B\). Bin \(B\) has 3 balls labeled \$1 and 1 ball labeled \$7, so the probability of selecting a ball labeled \$1 from bin \(B\) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    P(\$1 | \text{Black from } A) = \frac{3}{4}
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m    The probability of selecting a ball labeled \$7 from bin \(B\) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    P(\$7 | \text{Black from } A) = \frac{1}{4}
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m    The expected value of the winnings if a black ball is selected from bin \(A\) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    E(\$1 | \text{Black from } A) \cdot \frac{3}{4} + E(\$7 | \text{Black from } A) \cdot \frac{1}{4} = \frac{3}{4} \cdot 1 + \frac{1}{4} \cdot 7 = \frac{3}{4} + \frac{7}{4} = \frac{10}{4} = 2.5
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m 2. **Calculate the probability of selecting a white ball from bin \(A\):**
[36m(TaskRunner pid=4953)[0m    The probability of selecting a white ball from bin \(A\) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    P(\text{White from } A) = \frac{1}{5}
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m    If a white ball is selected from bin \(A\), then a ball is randomly selected from bin \(W\). Bin \(W\) has 5 balls labeled \$8 and 1 ball labeled \$500, so the probability of selecting a ball labeled \$8 from bin \(W\) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    P(\$8 | \text{White from } A) = \frac{5}{6}
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m    The probability of selecting a ball labeled \$500 from bin \(W\) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    P(\$500 | \text{White from } A) = \frac{1}{6}
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m    The expected value of the winnings if a white ball is selected from bin \(A\) is:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    E(\$8 | \text{White from } A) \cdot \frac{5}{6} + E(\$500 | \text{White from } A) \cdot \frac{1}{6} = \frac{5}{6} \cdot 8 + \frac{1}{6} \cdot 500 = \frac{40}{6} + \frac{500}{6} = \frac{540}{6} = 90
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m 3. **Calculate the overall expected win:**
[36m(TaskRunner pid=4953)[0m    The overall expected win is the weighted average of the expected wins from the two scenarios, weighted by their respective probabilities:
[36m(TaskRunner pid=4953)[0m    \[
[36m(TaskRunner pid=4953)[0m    E(\text{Win}) = P(\text{Black from } A) \cdot E(\$1 | \text{Black from } A) + P(\text{White from } A) \cdot E(\$8 | \text{White from } A) = \frac{4}{5} \cdot 2.5 + \frac{1}{5} \cdot 90 = \frac{10}{5} + \frac{90}{5} = \frac{100}{5} = 20
[36m(TaskRunner pid=4953)[0m    \]
[36m(TaskRunner pid=4953)[0m 
[36m(TaskRunner pid=4953)[0m Therefore, the expected win is \(\boxed{20}\).
[36m(TaskRunner pid=4953)[0m [ground_truth] \$20
[36m(TaskRunner pid=4953)[0m [score] 1.0
[36m(TaskRunner pid=4953)[0m local_global_step_folder: /workspace/verl_exp/ckpts/GRPO/GRPO-Qwen2.5-1.5B/global_step_58
[36m(WorkerDict pid=5528)[0m INFO:2025-12-25 02:15:10,080:[Rank 3] Saved model to /workspace/verl_exp/ckpts/GRPO/GRPO-Qwen2.5-1.5B/global_step_58/actor/model_world_size_4_rank_3.pt
[36m(WorkerDict pid=5528)[0m INFO:2025-12-25 02:15:57,441:[Rank 3] Saved optim to /workspace/verl_exp/ckpts/GRPO/GRPO-Qwen2.5-1.5B/global_step_58/actor/optim_world_size_4_rank_3.pt
[36m(WorkerDict pid=5528)[0m INFO:2025-12-25 02:15:57,806:[Rank 3] Saved extra_state to /workspace/verl_exp/ckpts/GRPO/GRPO-Qwen2.5-1.5B/global_step_58/actor/extra_state_world_size_4_rank_3.pt
[36m(WorkerDict pid=5527)[0m INFO:2025-12-25 02:15:10,685:[Rank 2] Saved model to /workspace/verl_exp/ckpts/GRPO/GRPO-Qwen2.5-1.5B/global_step_58/actor/model_world_size_4_rank_2.pt[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=5525)[0m INFO:2025-12-25 02:16:02,942:[Rank 0] Saved optim to /workspace/verl_exp/ckpts/GRPO/GRPO-Qwen2.5-1.5B/global_step_58/actor/optim_world_size_4_rank_0.pt[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=5525)[0m INFO:2025-12-25 02:16:02,944:[Rank 0] Saved extra_state to /workspace/verl_exp/ckpts/GRPO/GRPO-Qwen2.5-1.5B/global_step_58/actor/extra_state_world_size_4_rank_0.pt[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=5525)[0m INFO:2025-12-25 02:16:03,514:[Rank 0] Saved model config and tokenizer class to /workspace/verl_exp/ckpts/GRPO/GRPO-Qwen2.5-1.5B/global_step_58/actor/huggingface
[36m(TaskRunner pid=4953)[0m step:58 - actor/entropy:0.14475588500499725 - actor/pg_clipfrac:np.float64(0.0) - actor/ppo_kl:np.float64(0.0) - actor/pg_clipfrac_lower:np.float64(0.0) - actor/kl_loss:np.float64(0.0004478150866020769) - actor/kl_coef:np.float64(0.005) - actor/pg_loss:np.float64(4.532798268819249e-05) - actor/grad_norm:np.float64(0.10390390455722809) - perf/mfu/actor:np.float64(0.0) - perf/max_memory_allocated_gb:np.float64(64.07355833053589) - perf/max_memory_reserved_gb:np.float64(67.84375) - perf/cpu_memory_used_gb:np.float64(155.83002185821533) - actor/lr:np.float64(3e-06) - val-core/DigitalLearningGmbH/MATH-lighteval/reward/mean@1:np.float64(0.5510204081632653) - training/global_step:58 - training/epoch:0 - critic/score/mean:0.5751953125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5751953125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.03908715769648552 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.03908715769648552 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:628.1044921875 - response_length/max:4096.0 - response_length/min:107.0 - response_length/clip_ratio:0.001953125 - response_length_non_aborted/mean:628.1044921875 - response_length_non_aborted/max:4096.0 - response_length_non_aborted/min:107.0 - response_length_non_aborted/clip_ratio:0.001953125 - response/aborted_ratio:0.0 - prompt_length/mean:135.5859375 - prompt_length/max:447.0 - prompt_length/min:75.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.627501428127289e-05 - timing_s/generate_sequences:48.4688835144043 - timing_s/generation_timing/max:55.01642608642578 - timing_s/generation_timing/min:41.8948860168457 - timing_s/generation_timing/topk_ratio:0.25 - timing_s/gen:59.55042587406933 - timing_s/reward:0.2872591589111835 - timing_s/old_log_prob:20.74088474200107 - timing_s/ref:26.175120069878176 - timing_s/adv:0.03485953505150974 - timing_s/update_actor:81.94207699294202 - timing_s/step:188.98818537779152 - timing_s/testing:289.73316816985607 - timing_s/save_checkpoint:57.32844510511495 - timing_s/stop_profile:0.0001377570442855358 - timing_per_token_ms/gen:0.0925876402588849 - timing_per_token_ms/ref:0.03347120731066403 - timing_per_token_ms/adv:4.457632749525234e-05 - timing_per_token_ms/update_actor:0.10478271882517179 - perf/total_num_tokens:782019 - perf/time_per_step:188.98818537779152 - perf/throughput:1034.481333365796
[36m(TaskRunner pid=4953)[0m Training Progress: 100%|██████████| 58/58 [4:03:59<00:00, 295.33s/it]Training Progress: 100%|██████████| 58/58 [4:03:59<00:00, 252.41s/it]
[36m(TaskRunner pid=4953)[0m ('Final validation metrics: '
[36m(TaskRunner pid=4953)[0m  "{'val-core/DigitalLearningGmbH/MATH-lighteval/reward/mean@1': "
[36m(TaskRunner pid=4953)[0m  'np.float64(0.5510204081632653)}')
[36m(TaskRunner pid=4953)[0m wandb: updating run metadata
[36m(TaskRunner pid=4953)[0m wandb: updating run metadata; uploading history steps 56-57, summary, console lines 396-399
[36m(TaskRunner pid=4953)[0m wandb: uploading output.log; uploading wandb-summary.json
[36m(TaskRunner pid=4953)[0m wandb: uploading output.log; uploading config.yaml
[36m(TaskRunner pid=4953)[0m wandb: uploading data
[36m(TaskRunner pid=4953)[0m wandb: 
[36m(TaskRunner pid=4953)[0m wandb: Run history:
[36m(TaskRunner pid=4953)[0m wandb:           actor/entropy █▇█▇▇▆▆▅▄▄▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=4953)[0m wandb:         actor/grad_norm █▆▃▅▆▆▅▆▆▄▃▂▂▂▂▂▂▂▂▂▁▁▂▂▁▂▂▂▂▂▂▂▂▃▂▂▂▂▂▂
[36m(TaskRunner pid=4953)[0m wandb:           actor/kl_coef ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=4953)[0m wandb:           actor/kl_loss ▁▁▁▁▁▂▃▃▄▄▅▅▅▅▆▆▆▆▆▆▆▆▆▇▇▇▇▇▇▇█▇█▇▇█████
[36m(TaskRunner pid=4953)[0m wandb:                actor/lr ▁▂▄▅▇███████████████████████████████████
[36m(TaskRunner pid=4953)[0m wandb:       actor/pg_clipfrac ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=4953)[0m wandb: actor/pg_clipfrac_lower ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=4953)[0m wandb:           actor/pg_loss ▁▄▁▄▃▂▂▄▁▃▄▂▅▆▄▅▆▅▅▄▆▃▃▇▆▇▆▆▅▆▅▅▅▆▄▆▄█▃▄
[36m(TaskRunner pid=4953)[0m wandb:            actor/ppo_kl ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=4953)[0m wandb:   critic/advantages/max ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=4953)[0m wandb:                     +59 ...
[36m(TaskRunner pid=4953)[0m wandb: 
[36m(TaskRunner pid=4953)[0m wandb: Run summary:
[36m(TaskRunner pid=4953)[0m wandb:           actor/entropy 0.14476
[36m(TaskRunner pid=4953)[0m wandb:         actor/grad_norm 0.1039
[36m(TaskRunner pid=4953)[0m wandb:           actor/kl_coef 0.005
[36m(TaskRunner pid=4953)[0m wandb:           actor/kl_loss 0.00045
[36m(TaskRunner pid=4953)[0m wandb:                actor/lr 0.0
[36m(TaskRunner pid=4953)[0m wandb:       actor/pg_clipfrac 0
[36m(TaskRunner pid=4953)[0m wandb: actor/pg_clipfrac_lower 0
[36m(TaskRunner pid=4953)[0m wandb:           actor/pg_loss 5e-05
[36m(TaskRunner pid=4953)[0m wandb:            actor/ppo_kl 0
[36m(TaskRunner pid=4953)[0m wandb:   critic/advantages/max 2.47487
[36m(TaskRunner pid=4953)[0m wandb:                     +59 ...
[36m(TaskRunner pid=4953)[0m wandb: 
[36m(TaskRunner pid=4953)[0m wandb: 🚀 View run GRPO-Qwen2.5-1.5B at: https://wandb.ai/xieyuhui/GRPO/runs/0au3107d
[36m(TaskRunner pid=4953)[0m wandb: ⭐️ View project at: https://wandb.ai/xieyuhui/GRPO
[36m(TaskRunner pid=4953)[0m wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(TaskRunner pid=4953)[0m wandb: Find logs at: ._exp/wandb/run-20251224_221202-0au3107d/logs
[36m(TaskRunner pid=4953)[0m Exception ignored in atexit callback: <function _start_and_connect_service.<locals>.teardown_atexit at 0x760765748860>
[36m(TaskRunner pid=4953)[0m Traceback (most recent call last):
[36m(TaskRunner pid=4953)[0m   File "/workspace/anaconda3/envs/verl_rl/lib/python3.12/site-packages/wandb/sdk/lib/service/service_connection.py", line 65, in teardown_atexit
[36m(TaskRunner pid=4953)[0m     conn.teardown(hooks.exit_code)
[36m(TaskRunner pid=4953)[0m   File "/workspace/anaconda3/envs/verl_rl/lib/python3.12/site-packages/wandb/sdk/lib/service/service_connection.py", line 299, in teardown
[36m(TaskRunner pid=4953)[0m     self._asyncer.run(publish_teardown_and_close)
[36m(TaskRunner pid=4953)[0m   File "/workspace/anaconda3/envs/verl_rl/lib/python3.12/site-packages/wandb/sdk/lib/asyncio_manager.py", line 136, in run
[36m(TaskRunner pid=4953)[0m     return future.result()
[36m(TaskRunner pid=4953)[0m            ^^^^^^^^^^^^^^^
[36m(TaskRunner pid=4953)[0m   File "/workspace/anaconda3/envs/verl_rl/lib/python3.12/concurrent/futures/_base.py", line 456, in result
[36m(TaskRunner pid=4953)[0m     return self.__get_result()
[36m(TaskRunner pid=4953)[0m            ^^^^^^^^^^^^^^^^^^^
[36m(TaskRunner pid=4953)[0m   File "/workspace/anaconda3/envs/verl_rl/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
[36m(TaskRunner pid=4953)[0m     raise self._exception
[36m(TaskRunner pid=4953)[0m   File "/workspace/anaconda3/envs/verl_rl/lib/python3.12/site-packages/wandb/sdk/lib/asyncio_manager.py", line 219, in _wrap
[36m(TaskRunner pid=4953)[0m     return await fn()
[36m(TaskRunner pid=4953)[0m            ^^^^^^^^^^
[36m(TaskRunner pid=4953)[0m   File "/workspace/anaconda3/envs/verl_rl/lib/python3.12/site-packages/wandb/sdk/lib/service/service_connection.py", line 297, in publish_teardown_and_close
[36m(TaskRunner pid=4953)[0m     await self._client.close()
[36m(TaskRunner pid=4953)[0m   File "/workspace/anaconda3/envs/verl_rl/lib/python3.12/site-packages/wandb/sdk/lib/service/service_client.py", line 69, in close
[36m(TaskRunner pid=4953)[0m     await self._writer.wait_closed()
[36m(TaskRunner pid=4953)[0m   File "/workspace/anaconda3/envs/verl_rl/lib/python3.12/asyncio/streams.py", line 349, in wait_closed
[36m(TaskRunner pid=4953)[0m     await self._protocol._get_close_waiter(self)
[36m(TaskRunner pid=4953)[0m BrokenPipeError: [Errno 32] Broken pipe
Exception ignored in: <function ResourceTracker.__del__ at 0x72f0369b16c0>
Traceback (most recent call last):
  File "/workspace/anaconda3/envs/verl_rl/lib/python3.12/site-packages/multiprocess/resource_tracker.py", line 80, in __del__
  File "/workspace/anaconda3/envs/verl_rl/lib/python3.12/site-packages/multiprocess/resource_tracker.py", line 89, in _stop
  File "/workspace/anaconda3/envs/verl_rl/lib/python3.12/site-packages/multiprocess/resource_tracker.py", line 102, in _stop_locked
AttributeError: '_thread.RLock' object has no attribute '_recursion_count'
